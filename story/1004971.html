<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>重新发明车轮：用PyTorch发现最佳滚动形状(2019)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">重新发明车轮：用PyTorch发现最佳滚动形状(2019)</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-06-03 16:54:57</div><div class="page_narrow text-break page_content"><p>人们认为轮子是在五千多年前发明的，而现代机器学习工具是在过去几十年才开发出来的。我们都曾在某种程度上对这一悖论感到疑惑。如果没有现代的计算机和软件，古代苏美尔人的车轮建造者怎么能计算出理想的形状呢？我们可能永远不会知道。幸运的是，有了今天的技术，重新发现轮子的最佳形状是相对容易的。我会告诉你我是怎么做的。</p><p>这个愚蠢的项目的目标是找到轮子的最佳形状，它可能是一个圆圈。我将轮子参数化为一个二十边多边形，每个顶点的半径都是可变的，\(r_i\)。车轮的性能是基于假想汽车加速所达到的最终速度\(v_f\)。轮子是以恒定扭矩驱动的，没有打滑。我使用PyTorch来模拟轮子的效果，并计算最终速度相对于半径\(\frac{dv_f}{dr_i}\)的梯度。我使用这些渐变来更新半径，使用渐变下降。上图中，您可以看到最初随机生成的轮子的形状，轮子随着对象函数的变化而不断演变。</p><p>我用一个相对简单的模型来表示轮子。在每个时间步中，我根据车轮的力更新汽车的速度，然后根据速度旋转车轮。最低的顶点与地面接触，并固定在空间中。车轮在汽车上产生一个力\(τ/r_i\)，其中\(r_i\)是顶点的半径。这个力的一个分量，如下图所示，加速了汽车并提高了它的速度。</p><p>接下来，我想尝试一下不平坦的表面会很有趣。如果我使用那个滚动的正方形表面，最佳形状会是正方形吗？</p><p>将手电筒导入numpy作为nP导入matplotlib.pylot为plt n=20#轮点数n_step=1000#测试轮子性能的步骤数#Radii=torch.tensor([2.]+[1.]*(n-1)，Requires_grad=True)#使用一个凹凸半径=TORCH初始化轮子半径。张量(np.。随机的。正常(1.，.4，大小=n)。ASTYPE(NP.。Float32)，Requires_grad=True)#init随机轮点半径dtheta=2.*np。Pi/n#轮点之间的角度θ=火炬。排列(0，2*np.。pi，dtheta)#轮点角度列表dt=0.1#动力学扭矩=1的时间步长=1。#车轮质量上的扭矩=10。#汽车重力的质量=.1#重力引起的加速度#根据半径def test_车轮(半径)查找车轮的最终速度：#规格化半径，以便更改大小不会影响NORM_RADIi=半径/火炬。Mean(Radii)#查找轮点的坐标vertex_Position=车轮坐标(Norm_Radii)速度=手电筒。零(N_Step)+1.#每个台阶角度后的手推车速度=0#模拟范围(1，n_step)内i的车轮性能：#查找轴心点属性PIVOT_INDEX=TORCH。argmin(VERTEX_POSITIONS[：，1])PIVOT_RADIUS=NORM_RADI[PIVOT_INDEX]PIVOT_VECTOR=VERTEX_POSITIONS[PIVOT_INDEX]PIVOT_ANGLE=火炬。atan2(Pivot_Vector[1]，Pivot_Vector[0])#不要使用枢轴角度，只需取枢轴的高度#计算枢轴点的力force=扭矩/Pivot_Radius#force_graight=重力*quality*torch.sin(Pivot_angle+np.pi/2)force_graight=0#计算推动汽车前进的枢轴力分量force_component=torch。COS(PIVOT_ANGLE+NP。Pi/2)#计算汽车的新速度和车轮的转速[i]=速度[i-1]+((force*force_component+force_graight)*dt/quality)ROTIONAL_SPEED=速度[i]*force_component/轴心半径悬挂=ROTIONAL_SPEED*DT角度+=悬挂#旋转车轮VERTEX_POSITIONS=ROTATE(VERTEX_POSITIONS，DRANLE)#print(角度)返回速度def DRAFT_WELES(VERTEX_POSITIONS)。Ys=顶点位置。转置(0，1)。分离()。Numpy()PLT。Scatter(xs，ys)#返回旋转矩阵def rotation_Matrix(Theta)：返回手电筒。张量([[手电筒。因为(θ)，火炬。Sin(Theta)]，[-Torch.。罪恶(θ)，火炬。cos(Theta)]])#返回基于半径定义的车轮坐标(Radii)：VERTEX_POSITIONS=(Radii.。松开(1)*手电筒。猫((手电筒。Cos(Thetas.。重塑((-1，1))，火炬。Sin(Thetas.)。rehape((-1，1)，1))return vertex_position#返回旋转后的顶点位置集合def Rotate(vertex_position，θ)：ROT_Matrix=Rotation_Matrix(Theta)vertex_Position=torch。matmul(旋转矩阵，顶点位置。转置(0，1))。TRASPOSE(0，1)返回VERTEX_POSITIONS#LIST以跟踪目标进度最终速度=[]#目标图fig_obj=plt。</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.benwiener.com/programming/2019/04/29/reinventing-the-wheel.html">https://blog.benwiener.com/programming/2019/04/29/reinventing-the-wheel.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/车轮/">#车轮</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/wheel/">#wheel</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/轮子/">#轮子</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>