<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>从头开始深度学习第3部分：推广梯度下降</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">从头开始深度学习第3部分：推广梯度下降</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-06-23 01:53:08</div><div class="story_img_container"><img src="http://img.diglog.com/img/2020/6/2e55d3600542abf851a7e4b2ea1f9716.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></div><div class="page_narrow text-break page_content"><p>注：作为亚马逊会员，我从合格购买中赚取收入。我通过这个帖子中的链接获得购买佣金。请单击此处查看更完整的免责声明。</p><p>另一个注意事项：本系列假设您了解一些初中/高中数学(实际上仅仅是代数)，以便最大限度地利用这些部分。</p><p>虽然下面的注释是我对渐变下降的普遍看法，但我正在关注一本更详细的书，因为我试图展示我所学到的更高水平的内容。你可以在曼宁出版公司买到这本书《摸索深度学习》，电子书的价格更便宜，或者亚马逊的纸质书可以在这里买到，网址是https://amzn.to/2YVTrmz。</p><p>如果第4章希望向您介绍梯度下降(GD)，第5章将以几种不同的方式概括该概念：*具有一个输出节点的多个输入结点*冻结一个权重*具有多个输出结点的一个输入结点*多个输入和输出结点*多个输入和输出结点。</p><p>由于您有多个共享一个输出节点的输入节点，因此需要将计算出的增量均匀分布回每个输入节点。这样做将为每个节点提供适当的WEIGHT_DELTA。</p><p>请记住：Weight_delta值告诉您相对于各自的输入值，您的预测(正或负)与实际值相差有多远。如果使用数学计算，该等式将如下所示：“Weight_Delta=该特定输入值*计算出的增量”)。</p><p>在找到这个weight_delta值之后，您将使用weight-=alpha*该特定的输入节点的weight_delta值来计算新的权重值。有了这个新的权重，您对每个输入节点的预测将是pred=输入节点值*新权重值。您在x次迭代中重复此过程。</p><p>冻结一个权重基本上允许您查看哪些输入节点对预测值影响最大。换句话说，Trask就是这么说的，a(或者仅仅是你的神经网络中的一个输入节点)可能是一个强大的输入，具有很强的预测能力，但如果网络意外地想出了如何在没有它的情况下对训练数据进行准确预测，那么它永远也学不会把a纳入它的预测[1]。</p><p>如果您想知道如何冻结一个权重，那么只需在每次迭代中将该权重的值设为0即可。如果你把任何东西乘以0，你总是会得到值0。从本质上讲，权重值将始终与您在特定状态下“冻结”权重相同。</p><p>这一次的梯度下降与第一个小主题相反。您有一个输入节点对三个不同的输出节点产生影响。由于三个输出节点共享一个输入节点，因此每个增量值将告诉您与预测中的原始输入节点的距离有多远。</p><p>要记住的公式：*pred=一个输入节点值*初始权重*增量=pred-true。</p><p>由于有三个输出节点，Weight_Delta将是一个列表，其中包括Weight_Delta=一个输入节点值*来自每个输出节点的Weight_Delta列表。</p><p>最后，您将重复第一个项目符号主题的方法来计算新的权重值，以测试新的预测。</p><p>第一个小主题和这个小主题之间的区别只是神经网络的哪一侧(输入和输出)有一个或多个节点。然后进行必要的乘法。</p><p>最后一个副主题是当您有多个输入和输出节点时。如果你理解第一个和第三个小主题(在这些笔记和书中)，那么这应该不难理解。</p><p>对于每一行的权重值和输入值，您将找到增量值。</p><p>在找到增量值之后，您必须为每个输出计算每行的增量_权重值。</p><p>最后，计算该行中每列的新权重值，并将其指定为要在预测中使用的新权重值。请参阅下面的代码片段。</p><p>#此代码片段假定您已经计算了weight_deltas#此嵌套的for循环基本上是为一行中的每一列(矩阵中的每行，j-&gt;行中的每一列)分配新的权重。#您遍历第(I)行中的所有列(J)，然后移动到下一行，并从第0列开始计算Range(len(Weight))中的i：for j in range(len(Weight[0]))：Weights[i][j]-。</p><p>因此，在这篇文章的笔记本和上一篇文章的笔记本之间，有很多关于深度学习中梯度下降的讨论。不过，我想展示数学实际运行情况的直观表示。我不太适合matplotlib(到目前为止)，所以我相信下面的gif在显示/绘制数学上是很好的。</p><p>在下面的两张GIF图中，你可以看到(无论是点还是黑线)，它们都在试图达到抛物线的最低点。特拉斯克说，你真正想要用神经网络做的是找出这个大误差平面(下面的抛物线)上的最低点，其中最低点是指最小的误差[2]。这意味着您的pred=input*权重实际上非常接近您想要查看的值，或者在本例中为true[2]，这意味着您已经达到迭代中的最低错误值[2]，这意味着您已经到达了迭代的某个点，其中pred=input*权重实际上非常接近您希望看到的值，或者在本例中为true。</p><p>与往常一样，jupyter笔记本也提供了第5章_GeneralizingGradientDescent|Kaggle供您参考。</p><p>[1]“一次学习多个权重：推广梯度下降”，安德鲁·W·特拉斯克著，曼宁出版社，2019年，第263页。</p><p>[2]“一次学习多个权重：推广梯度下降”，安德鲁·W·特拉斯克著，曼宁出版社，2019年，第267页。</p><p>[3]我是Ng，Andrew。一元线性回归|梯度下降-[Andrew Ng]&#34；YouTube，2020年6月22日。https://www.youtube.com/watch?v=F6GSRDoB-Cg&amp；list=PLLssT5z_DsK-h9vYZkQkYNWcItqhlRJLN&amp；index=8</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://jdridgeway.com/deep-learning-from-scratch-generalizing-gradient-descent/">https://jdridgeway.com/deep-learning-from-scratch-generalizing-gradient-descent/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/深度学习/">#深度学习</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/深度/">#深度</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/learning/">#learning</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/节点/">#节点</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1007552.html"><img src="http://img.diglog.com/img/2020/6/thumb_620dae4229626ee37a27475f04dbbf53.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1007552.html">腐败、稀疏、不规则、丑陋：对时间序列的深度学习</a></div><span class="my_story_list_date">2020-6-22 2:49</span></div><div class="col-sm"><div><a target="_blank" href="/story/1007463.html"><img src="http://img.diglog.com/img/2020/6/thumb_c08ffcb6f72459c9e395acdc8c2c0dbe.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1007463.html">“生物学上可信”的深度学习神经元预测巴赫的和弦</a></div><span class="my_story_list_date">2020-6-21 3:55</span></div><div class="col-sm"><div><a target="_blank" href="/story/1007139.html"><img src="http://img.diglog.com/img/2020/6/thumb_886cb670d5966f6db9e1f2300d3e3dfa.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1007139.html">神经魔术：启动使深度学习成为可能，而不需要专门的硬件</a></div><span class="my_story_list_date">2020-6-19 2:39</span></div><div class="col-sm"><div><a target="_blank" href="/story/1002254.html"><img src="http://img.diglog.com/img/2020/5/thumb_106c065e1e5e8355f3ffe493f4161598.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002254.html">CMU的OpenTPOD：创建无需编码的深度学习对象检测器</a></div><span class="my_story_list_date">2020-5-16 0:50</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>