<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plywood：一种新的跨平台开源C++框架</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Plywood：一种新的跨平台开源C++框架</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-26 13:22:57</div><div class="story_img_container"><img src="http://img.diglog.com/img/2020/5/5c90dbc8eaee9e115a72c261fa65530a.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></div><div class="page_narrow text-break page_content"><p>在过去的一小段时间里-好吧，很长一段时间-我一直在用C++开发一个自定义游戏引擎。今天，我将该游戏引擎的一部分作为开放源码框架发布。它被称为胶合板框架。</p><p>请注意，胶合板本身并不是游戏引擎！它是一个使用C++构建各种软件的框架。</p><p>例如，Plywood的文档是在C++解析器的帮助下生成的，由Markdown解析器格式化，并在全部使用Plywood编写的自定义Web服务器上运行。</p><p>集成第三方库在C++中可能是一件痛苦的事情，但Plywood的目标是简化它。下面是一个简短的胶合板程序，它使用cairo和Libavcodec将矢量动画渲染为视频文件：</p><p>这些示例的源代码包含在Plywood存储库中，所有内容都在Windows、Linux和MacOS上构建和运行。</p><p>当然，胶合板也是我的(专有)游戏引擎的基础，我称之为Arc80引擎。这就是胶合板首先出现的原因。我还没有发布一个使用Arc80引擎的完整游戏，但我已经用它制作了一些原型。稍后会详细介绍这一点！</p><p>大多数开源C++项目都是打算集成到其他应用程序中的库。胶合板正好相反：它为您提供了一个可以集成源代码和库的工作区。单个胶合板工作空间可以包含多个应用程序-网络服务器、游戏引擎、命令行工具。胶合板简化了它们之间构建和共享代码的任务。</p><p>胶合板在幕后使用CMake，但您不必编写任何CMake脚本。与任何基于CMake的项目一样，胶合板工作区具有与源代码分开的目标和构建文件夹的概念，但它在此基础上添加了其他几个概念，如模块、根目标和外部提供程序。(注意：不要将胶合板模块与C++20模块混淆；它们是不同的东西。)</p><p>一个胶合板工作区外部包构建文件夹根目标repos源代码模块外部提供者解释胶合板工作区，以及它是如何与CMake交互的，这确实值得一提，但它帮助实现的是模块性。</p><p>Arc80是一个模块化游戏引擎，多亏了胶合板工作区，可以使用Arc80引擎模块快速构建小型应用程序。例如，当我为喷气式发动机开发火焰效果时，我创建了一个只包含火焰效果的小型测试应用程序。这个测试应用程序允许我专注于功能本身，并使效果与游戏的其余部分解耦。</p><p>还需要做更多的工作，以使这一过程更加方便用户。例如，要定义新模块，您当前必须使用我尚未记录的API编写C++函数。简单的配置文件会更好。这是我计划做的下一件事，因为胶合板已经发布了。</p><p>我想了很久Arc80引擎的开源部分，这就是导致上面提到的repos想法的原因。单个胶合板工作区可以组合来自不同Git存储库的模块。当谈到开源胶合板时，问题是将一堆模块从专有的arc80repo迁移到公共的胶合板repo。</p><p>截至今天，胶合板回收器配备了39个内置模块。这些模块提供平台抽象、矢量数学、JSON解析、音频和图像处理等功能。当然，所有模块都是可选的，因此如果您认为某个特定模块不适合您的需要，则不必使用它。这是一个简图，显示了胶合板repo中包含的一些模块(在底部)和我目前保密的模块(在顶部)。箭头表示依赖关系：</p><p>平台运行时反映塔架烹饪数学图像web CPP编解码器构建音频libavcodec cairo libsass plytool WebCooker WebServer UI会话图形物理视图图像GPU音频资产Bank FreeType SDL游戏RemoteCooker arc80胶合板(不包含)(包含)最重要的模块是标有星号的模块：运行时。我最初将Turf用于跨平台线程和内存管理，然后逐渐添加了容器、I/O、文件系统API和合理的Unicode支持。运行时模块就是结果。它还公开了标准C或C++运行时库中不可用的内容，如将I/O重定向到子进程和监视目录的更改。API可以在这里和那里进行一些改进，但是我已经更喜欢它而不是标准库了。</p><p>我本想开放更多的Arc80引擎源代码，特别是与图形和音频处理相关的模块，但这些模块还没有准备好进入黄金时间。我将来可能会把它们开源，但这首先取决于胶合板是否成功。</p><p>在我看来，运行时反射是标准C++中缺少的最大特性。此功能启用了整个类别的泛型编程，否则这是不可能的。我在本博客的前两篇文章中写过运行时反射。Plywood附带了一个内置的反射系统，该系统基于那些帖子中描述的方法，但在上面增加了一个代码生成步骤。</p><p>简而言之，Plywood的反射系统在运行时公开有关程序数据结构的元数据。例如，在Plywood的Web文档模块中定义了名为Contents的数据结构：</p><p>[{&#34；Title&#34；：&#34；Home&#34；，&#34；link目标&#34；：&#34；/&#34；，&#34；子项&#34；：[]}，{&#34；Title&#34；：&#34；快速入门&#34；，&#34；link目标&#34；：&#34；/docs/QuickStart&#34；，&#34；子项&#34。：[{&#34；Title&#34；：&#34；Building the Documentation&#34；，&#34；link Destination&#34；：&#34；/docs/QuickStart/BuildDocs&#34；，&#34；Children&#34；：[]}]}，.。</p><p>通过将Array&lt；content&gt；的元数据传递给通用JSON加载函数来加载数据。不需要编写特定于类型的加载代码。</p><p>目前，要实现这一点，您需要在编译项目之前在命令提示符下运行plytool codegen。(我计划最终将此命令合并到构建过程中，但前提是对其进行优化，使其以增量方式运行。)。该命令扫描所有可用的源代码模块，使用自定义C++解析器提取所有类型声明，并生成元数据所需的一些附加源代码。</p><p>胶合板是我个人很长时间以来一直想要的框架，老实说，它让C++更像我想使用的编程语言。我希望它对其他人也能起到同样的作用。但仍有文档要写，特性要润色，错误要压扁。</p><p>如果您认为胶合板在正确的轨道上，并希望看到它不断改进，请支持它在Patreon上的正在进行的开发：</p><p>如果Plywood吸引了足够多的Patreon支持者，我将很乐意写一系列博客文章，解释它是如何工作的，以及它是如何利用特定的C++特性的。</p><p>如果您是一个从事相对较新的、跨平台的C++项目的团队，我认为将该项目建立在胶合板上已经是可行的。您必须密切关注Plywood开发，并且必须直接从文档尚未完成的源代码中寻找一些答案(任何项目都是如此)。但是考虑到我已经在这个框架上投入了大约4000小时的工作，与您自己构建类似的框架相比，您将会有一个显著的领先优势。</p><p>胶合板有很多未来可以扩展的功能：</p><p>可以对Plywood的内置C++解析器进行扩展，使其适用于其他应用程序。它目前可以识别声明，但不能识别表达式；目前跳过了函数体。这一功能将是一项艰巨的任务。</p><p>网络服务器可以改进。它甚至还没有使用线程池。对Web服务器的任何改进都可能使Plywood更适合其他后端服务。</p><p>可以消除胶合板对标准C++运行时的依赖，在某些平台上，对标准C运行时也是如此。这样做可以减少构建时间，并产生更小的可执行文件。</p><p>可以让PlyTool直接调用C++编译器，而不需要CMake首先生成中间生成系统。</p><p>这取决于其他人认为有用的东西，所以我很想听听你的想法。这些改进中有哪些是值得追求的？你认为有什么方法可以简化胶合板的东西吗？有什么问题吗，或者更多的是评论而不是问题？我将在闪亮的新胶合板不和谐服务器上闲逛，所以请随时加入我们的讨论！否则，你可以直接联系我。</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://preshing.com/20200526/a-new-cross-platform-open-source-cpp-framework/">https://preshing.com/20200526/a-new-cross-platform-open-source-cpp-framework/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/开源/">#开源</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/c++/">#c++</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/cross/">#cross</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/胶合板/">#胶合板</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1003490.html"><img src="http://img.diglog.com/img/2020/5/thumb_390eabb8be9c52ede60496f5097d56d3.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003490.html">开源安全报告发现70%的应用程序存在库引发的缺陷</a></div><span class="my_story_list_date">2020-5-24 15:45</span></div><div class="col-sm"><div><a target="_blank" href="/story/1003462.html"><img src="http://img.diglog.com/img/2020/5/thumb_9e1710291bad83801119db4f4dba5483.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003462.html">“FOSS响应者”希望帮助开源组织生存下来</a></div><span class="my_story_list_date">2020-5-24 7:51</span></div><div class="col-sm"><div><a target="_blank" href="/story/1003397.html"><img src="http://img.diglog.com/img/2020/5/thumb_2ffe27bde1ff6d15b2f16dffffc4facb.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003397.html">欧洲议会强烈推荐开源软件</a></div><span class="my_story_list_date">2020-5-23 20:46</span></div><div class="col-sm"><div><a target="_blank" href="/story/1003209.html"><img src="http://img.diglog.com/img/2020/5/thumb_5429f3ca7682617909b86ac53c493e79.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003209.html">Microsoft开源GW-Basic</a></div><span class="my_story_list_date">2020-5-22 8:1</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>