<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>红宝石与水晶性能对比</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">红宝石与水晶性能对比</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-06-06 03:06:12</div><div class="page_narrow text-break page_content"><p>在过去的几年里，我到处听到关于Crystal编程语言的消息，但直到昨天才有机会去看一看。</p><p>什么是水晶？它是一种静态类型的、编译的、面向对象的语言，其语法深受Ruby的启发。</p><p>其网站上的承诺是，该语言像C一样快，像Ruby一样流畅。这句话听起来令人兴奋，让您想看看Crystal与Ruby相比有多快。当然，这不是一个公平的比较，因为一个是编译语言，另一个是解释语言(下面使用的Ruby MRI实现)。</p><p>从Crystal的网站上摘取的一个基本HTTP服务器的实现按预期工作，代码看起来确实像Ruby的：</p><p>要求&#34；http/server&#34；server=HTTP：：server。新建DO|Context|Context。回应。content_type=&#34；文本/纯文本&#34；上下文。回应。打印&#34；Hello world，获得#{上下文。请求。PATH}！&#34；END PUT&#34；侦听http://127.0.0.1:8080&#34；服务器。聆听(8080)。</p><p>让我们用Ruby和Crystal编写一些代码，为给定的数字生成斐波纳契数列。然后，我们可以查看查找序列中第46个数字(即1，836，311，903)所需的时间。稍后你就会明白我为什么选这个号码了。</p><p>如果我们试图找到斐波纳契序列中的下一个，第47个数字，Crystal实际上会给我们一个错误：</p><p>未经处理的异常：Fibonacci中的Fibonacci中的算术溢出(OverflowError)。cr：6：6 in&#39；__Crystal_Main&#39；中的/usr/local/Cellar/crystal/0.34.0/src/crystal/main.cr:105:5 in&#39；Main&#39；</p><p>如果您还记得Crystal是一种静态类型的语言，但是您可以省略显式类型限制，编译器会尝试推断变量的类型。在我们的代码中，Crystal对n变量使用Int32类型，它的最大值为2，147，483，647，但是第47个数字更高。在本例中，我们需要指定n的类型。我们可以使用无符号整数64。</p><p>我们可以优化代码并引入记忆化，以返回先前计算的数字的缓存结果。</p><p>def Fibonacci(n，cache=[0，1])如果cache[n]cache[n]=Fibonacci(n-1，cache)+Fibonacci(n-2，cache)end放入斐波纳契数(100)，则返回cache[n]。</p><p>def fibonacci(n，cache=[0，1]of UInt128)如果cache[n]？(cache&lt；&lt；&lt；fibonacci(n-1，cache)+Fibonacci(n-2，cache))[-1]end放置斐波纳奇数(100)，则返回cache[n]。</p><p>当我们尝试寻找斐波纳契序列中相当大的第100个数字时：354,224,848,179,261,915,075，结果如下：</p><p>这表明，必须首先优化的是算法，而不是选择一种速度更快的语言或机器。</p><p>水晶碎片数据库-就像水晶的Ruby工具箱</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://ptimofeev.com/ruby-vs-crystal-performance/">https://ptimofeev.com/ruby-vs-crystal-performance/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/ruby/">#ruby</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/性能/">#性能</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/水晶/">#水晶</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/crystal/">#crystal</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>