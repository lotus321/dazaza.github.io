<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>多语言生成文件</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">多语言生成文件</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-16 01:11:57</div><div class="page_narrow text-break page_content"><p>您知道您可以在Makefile中更改shell吗？这是真的。我在尝试通过设置shell来使用bash而不是默认的/bin/sh时发现了这一点。</p><p>.ONESHELL：bash：shell：=bash bash：#注意：需要双美元符号，因为make替换$Variables export greeting=&#34；‘hola&#34；echo&#34；$${greeting}，bash！&#34；</p><p>还有什么是可能的呢？我可以使用其他编程语言作为shell吗？可以在Makefile中编写内联Python吗？</p><p>请注意，正在设置变量.ONESHELL。通常，让willevaluate在单独的shell中计算每个命令的值，这意味着在本例中，问候语将在第二行中未定义。按照姓氏以Davis-*开头的其他人的建议，将.ONESHELL添加到Makefile的顶部，并撰写有关make的博客，会导致make指令中的多行代码在对Python的单个调用中求值。</p><p>将R内联写入Makefile怎么样？请注意添加的.SHELLFLAGS。默认情况下，make运行shell-c&#34；您的\n脚本，\n此处&#34；与R不兼容。要从R中的命令内联运行脚本，可以使用-e：</p><p>现在，您可以编写将R和Python语言组合到单个文件🎉中的管道。</p><p>数据分析管道通常具有冒险的用户依赖性。Docker让这一切变得容易得多，但是编写docker run…可能会很麻烦。如果我们可以让Docker也作为解释器和写命令在容器内以内联方式执行，会怎么样？</p><p>docker：.SHELLFLAGS=run--volume$(Shell Pwd)：/workdir--rm--workdir/workdir--entry point/bin/bash ubuntu-c docker：shell：=docker docker：echo&#34；hello，$$(uname-a)！&#34；</p><p>再说一次，这是可能的。运行make docker将运行ECHO.。在运行Ubuntu的Dockertainer中。请注意--volume标志，它将挂载当前工作目录作为容器的工作目录，这意味着可以在您的本地文件系统和容器的本地文件系统之间读取/创建文件。所以构建构件可以在make指令之间共享。</p><p>您好，Linux 453c728113d6 4.19.76-linuxkit#1 SMP Fri Apr 3 15：53：26 UTC 2020 x86_64 GNU/Linux！</p><p>这是一次实验，目的是看看Make能做些什么。但它的动机是一个现实世界的问题：我经常需要组合跨编程语言和环境的工具来运行数据分析管道。我喜欢把事情自动化，Make是这样做的一个很好的工具。将所有内容内联起来更具可读性，并且将所有内容都放在一个文件中意味着我必须在更少的选项卡之间跳转才能理解管道本身。</p><p>编写在Docker中执行的命令的能力意味着我不必花费更少的时间来弄清楚如何将一堆依赖项安装到单个容器中，这会随着依赖项数量的增加而变得越来越困难(特别是如果你在生物信息学工作的话)。</p><p>注意：其中一些功能只适用于Make 4.+，这是我使用Homebrew安装的。这些示例在使用MacOS Catalina附带的make 3.x时不起作用。</p><p>.ONESHELL：.SILENT：main：\Python\ruby\R\bash\docker docker：.SHELLFLAGS=run--rm--entrypoint/bin/bash ubuntu-c docker：shell：=docker docker：echo&#34；hello，$$(uname-a)！&#34；python：shell：=python3 python：greeting=&#34；hello&#34；print(f&#。)ruby：.SHELLFLAGS：=-e ruby：shell：=ruby ruby：greeting=&#34；laba&#34；put&#34；#{greeting}，ruby！&#34；R：.SHELLFLAGS：=-e R：shell：=Rscript R：greeting=&#34；bonjour&#34；message(paste0(greeting，&#34；，R！&#34；))bash：.。*您好&#34；echo&#34；$${greeting}，bash！&#34；</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="http://agdr.org/2020/05/14/Polyglot-Makefiles.html">http://agdr.org/2020/05/14/Polyglot-Makefiles.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/生成/">#生成</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/polyglot/">#polyglot</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/shell/">#shell</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>