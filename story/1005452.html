<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用AppsScript实现Gmail自动化</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用AppsScript实现Gmail自动化</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-06-06 23:04:30</div><div class="page_narrow text-break page_content"><p>我们都被电子邮件淹没了。问题不在于明目张胆的垃圾邮件--订阅大部分垃圾邮件并屏蔽其余内容很容易。真正的杀手是一封有点有趣的电子邮件：关于你外围参与的项目的讨论，每周的时事通讯，几个月前你提交的关于GitHub问题的闲聊，以及所有其他你有时间就略过的邮件，如果你忙的话就跳过。手动分类这些电子邮件可能是一场令人精疲力竭的打地鼠游戏。但如果你是Gmail用户，还是有希望的--你可以使用AppsScript将大部分工作自动化。最棒的是，它是免费的！在这篇文章中，我将带领您创建您的第一个AppsScript项目，并让您体验一下您可以实现什么。(向Prashant Varanasi致敬，他首先向我介绍了AppsScript。)。创建一个新的AppsScript项目，然后添加一个小函数并保存该项目。这段代码还没有做任何事情，但是我们稍后会添加它。AppsScript包含类似cron的触发器服务，但您必须小心：Google限制了脚本运行的时间，也限制了您可以执行的Gmail操作的数量。对我来说，每15分钟运行一次我的电子邮件管理脚本，可以让我的收件箱保持整洁，而不会耗尽我的配额。直接从编辑器中为processMail函数设置基于时间的触发器，方法是转到“编辑”，然后转到“当前项目的触发器”，最后转到右下角的“添加触发器”。我的电子邮件自动化的最简单部分一次只在一个线程上工作，不需要进一步的上下文：例如，我使用一个小函数来确保我所有存档的电子邮件都标记为已读。(令我困惑的是，这并不是默认设置，因为这是让徽章在Gmail的移动应用中发挥作用的唯一方法。)。函数processMail(){Const Rules=[markArchivedRead]；for(Let Rule Of Rules){Rule()；}}函数markArchivedRead(){return eachThread(&#34；Gmail：标记已读取的存档线程&#34；，&#34；-in：收件箱为：未读&#34；，函数(线程){thread.markRead()；})；}函数eachThread(operation，query，f){const thread=GInbox is：unread&#34；，function(Thread){thread.markRead()；}。=0){Logger.log(&#34；%s：没有与查询%s&#34；，operation，query)匹配的线程；return；}const n=threads.length；Logger.log(&#34；%s：找到与查询%s&#34；，operation，n，query)匹配的%s个线程；对于(让线程线程){f(线程)；}Logger.log(&#34；%s：已处理%s个线程，完成！&#34；，n，operation)；}。</p><p>我大部分时间都有5-10个这样的小任务处于活动状态，每个线程帮助器都会让它们保持简洁。请注意，每个Thread将自己限制为每次调用最多处理100个线程，以保持较短的执行时间，并限制消耗的Gmail操作的数量。我使用类似的每线程函数来完成各种简单的任务，其中大多数任务都是在我开始落后时整理我的存档邮件或清理我的收件箱，例如：取消存档中的所有内容。我使用星号来保护收件箱线程，使其不会进一步自动化；对于参考材料，我使用标签。追溯性地将标签应用到我的存档中，因为Gmail UI在修改超过几千个线程时挂起。将促销活动存档(使用谷歌的自动分类)超过三天，除非它们是明星。在归档一年后删除大量通知。来自Sentry等异常跟踪系统的电子邮件是基于时间删除的一个很好的候选者：当它是最新的时候，它是有价值的信息，但不值得永远保留几十亿字节。有一段时间，我自动归档了有很多参与者的长时间运行的线程，没有来自我的电子邮件，也没有提到我负责的团队或项目。这需要大量的维护工作，而且有相当多的正面影响，但当我在一些极端官僚的工程委员会任职时，我的头脑仍然保持清醒。</p><p>尽管我的初衷是好的，但时事通讯和其他不必要的帖子经常堆积在我的收件箱里。手工清理这些积压的东西是很痛苦的，因为我实际上想读其中的大部分：我最终会苦恼于是否还有时间再读一篇有趣的文章或帖子，打开一百万个浏览器标签，燃烧几个小时的时间，最好在其他地方度过。相反，我使用过滤器在邮件到达时标记有趣但可选的邮件。(我有很多过滤器，我最近开始使用gmailctl管理这些过滤器。)。如果我的收件箱里堆积了超过100封这样的电子邮件，我会将较旧的邮件存档，直到只剩下50封。我还给自动存档的邮件加了标签，所以如果它们稍后出现在搜索中，我知道我还没有读过它们。函数limitInbox(){const max=100；const op=&#34；gmail：Limit收件箱&#34；；const清除=GmailApp.getUserLabelByName(&#34；optional/purged&#34；)；常量线程=GmailApp.search(&#34；in：收件箱标签：可选&#34；)；Logger.log(&#34；%s：%s可选线程&#34；，op，threads.length)；IF(threads.length&lt；=max){Logger.log(&#34；%s。返回；}让n=0；for(让</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://akshayshah.org/automating-gmail-with-appsscript/">https://akshayshah.org/automating-gmail-with-appsscript/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/gmail/">#gmail</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/线程/">#线程</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1005449.html"><img src="http://img.diglog.com/img/2020/6/thumb_d0f176eaa45d38dee7dfa5858bfb97d6.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1005449.html">新医生对NHS联系人追踪应用程序能否按时准备的说法表示怀疑</a></div><span class="my_story_list_date">2020-6-6 23:2</span></div><div class="col-sm"><div><a target="_blank" href="/story/1005359.html"><img src="http://img.diglog.com/img/2020/6/thumb_f08a0f14d0862ab76a01d3cd61df3ab9.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1005359.html">Apple Watch坠落检测拯救了反应迟钝的亚利桑那州男子</a></div><span class="my_story_list_date">2020-6-6 5:42</span></div><div class="col-sm"><div><a target="_blank" href="/story/1005328.html"><img src="http://img.diglog.com/img/2020/6/thumb_1c005e8b346452ea5ad252bb5674a0a6.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1005328.html">苹果启动开源项目让密码管理应用创建强密码</a></div><span class="my_story_list_date">2020-6-6 2:45</span></div><div class="col-sm"><div><a target="_blank" href="/story/1005323.html"><img src="http://img.diglog.com/img/2020/6/thumb_6077afe1c0732c0ffa2f73b417a69d00.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1005323.html">苹果为开发者发布开源的“Password Manager Resources”项目</a></div><span class="my_story_list_date">2020-6-6 2:42</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>