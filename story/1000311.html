<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>AWK在20分钟内(2015)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1>AWK在20分钟内(2015)</h1><div class="row"><div class="col-lg-8 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time">2020-05-02 18:05:56</div><p>AWK是一种小型编程语言和命令行工具。它特别适合于服务器上的日志解析，主要是因为Awk将对文件进行操作，这些文件通常是以人类可读的文本行为结构的。</p><p>我说它在服务器上很有用，因为日志文件、转储文件或服务器最终转储到磁盘的任何文本格式的文件都会变得很大，而且每个服务器上都会有很多这样的文件。如果你曾经遇到过这样的情况，你不得不在没有像Splunk或其等价物这样的工具的情况下分析来自50个不同服务器的千兆字节的文件，如果在本地拥有并下载所有这些文件，然后对它们进行一些取证，那会让人感觉相当糟糕。</p><p>当一些Erlang节点趋于死亡并留下700MB到4 GB的崩溃转储时，或者在需要快速查看日志以寻找通用模式的较小的单个服务器(比如VPS)上，我个人就会发生这种情况。</p><p>在任何情况下，Awk不仅仅是查找数据(否则，grepor ack就足够了)-它还允许您处理数据并对其进行转换。</p><p>#Comment Pattern1{Actions；}#Comment Pattern2{Actions；}#Comment Pattern3{Actions；}#Comment Pattern4{Actions；}。</p><p>要扫描的文档的每一行都必须通过每种模式，一次扫描一个。因此，如果我传入一个包含以下内容的文件：</p><p>那么这是第1行的内容将与Pattern1匹配。如果匹配，将执行操作。然后，该行1将与Pattern2匹配。如果不匹配，则跳到Pattern3，依此类推。</p><p>一旦清除了所有模式，这是第2行将经历相同的过程，对于其他行依此类推，直到完全读取输入。</p><p>AWK只有两种主要的数据类型：字符串和数字。即使那样，Awk也喜欢把它们相互转换。字符串可以解释为数字，以便将它们的值转换为数字。如果字符串看起来不像数字，则为0。</p><p>两者都可以使用=运算符分配给代码的操作部分中的变量。变量可以随时随地声明并使用，即使它们没有初始化：它们的默认值是空字符串。</p><p>最后，AWK有数组。它们是可以动态启动的一维关联阵列。它们的语法只是var[key]=value。AWK可以模拟多维数组，但无论如何它都是一个大麻烦。</p><p>可以使用的模式分为三大类：正则表达式、布尔表达式和特殊模式。</p><p>Awk正则表达式是您常用的正则表达式。它们不是awk下的PCRE(但gawk将支持更奇特的东西-这取决于实现！)。参见with awk--version)，不过对于大多数用法，他们会做很多事情：</p><p>/admin/{.}#包含&#39；admin&#39；/^admin/{.}#行的任何行，以&#39；admin&#39；/admin$/{.}#行开头，以&#39；admin&#39；/^[0-9.]+/{.}#行开头/(POST|PUT|DELETE)/#包含特定HTTP谓词的行。</p><p>诸若此类。请注意，模式不能捕获特定组以使其在代码的操作部分可用，它们专门用于匹配内容。</p><p>布尔表达式与您在PHP或Javascript中发现的类似。具体地说，可以使用运算符&amp；&amp；(&#34；和&#34；)、||(&#34；或&#34；)和！(&#34；不是&#34；)。这也是您在几乎所有类C语言中都会发现的。它们将操作任何常规数据类型。</p><p>更像PHP和Javascript的是比较运算符==，它将执行模糊匹配，以便字符串与数字23进行比较，从而使&#34；23&#34；=23为真。运算符！=也可用，但不要忘记其他常见运算符：&gt；、&lt；、&gt；=和&lt；=。您还可以混合使用这些模式：布尔表达式可以与正则表达式一起使用。模式/admin/||debug==true有效，并且在.。</p><p>请注意，如果您有一个要与正则表达式匹配的特定字符串或变量，运算符~和！~就是您想要的，将用作字符串~/regex/.。</p><p>第一个是BEGIN，它只在将任何行输入到文件之前进行匹配。这基本上就是你可以启动变量和所有其他类型状态的地方。</p><p>还有end，正如您可能已经猜到的，它将在处理完整个输入之后匹配。这使您可以在退出之前清理或执行一些最终输出。..。</p><p>最后，最后一种模式有点难以分类。它介于变量和特定值之间，它们被称为字段，这是值得的。</p><div class="sotry_link"><a target="_blank" href="https://ferd.ca/awk-in-20-minutes.html">https://ferd.ca/awk-in-20-minutes.html</a></div><div class="story_tags"><button type="button" class="btn btn-light my_tag"><a href="/tag/文件/">#文件</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/awk/">#awk</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/字符串/">#字符串</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/actions/">#actions</a></button></div></div></div><div class="col-lg-4 col-0"><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/百度/">#百度</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/搜索/">#搜索</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/科学/">#科学</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/flash/">#flash</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/人像/">#人像</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/动物/">#动物</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/互联网/">#互联网</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/logo/">#logo</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/在线/">#在线</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/twitter/">#twitter</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/浏览器/">#浏览器</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/电影/">#电影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/搜索引擎/">#搜索引擎</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/雷人/">#雷人</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/腾讯/">#腾讯</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/搞笑/">#搞笑</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/日本/">#日本</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/css/">#css</a></button></div></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script></body></html>