<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>我讨厌生锈的地方</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">我讨厌生锈的地方</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-20 22:16:48</div><div class="page_narrow text-break page_content"><p>五年前，我写了一篇文章，讲述了我当时(现在仍然)最喜欢的脚本语言Ruby中我最讨厌的东西。</p><p>今天，我将对我目前最喜欢的编译语言Ruust做同样的事情。</p><p>就像最初的Ruby帖子一样，这些抱怨都是个人的，反映了我目前对该语言的最好理解。就像Ruby一样，它们都是出于对铁锈的热爱而写的。</p><p>在我的脑海中，我可以想到5种不同的方式1来表示字符串、字符串视图或接受字符串y的签名：</p><p>(我知道最后一个不是真正的字符串类型，但它经常出现在惯用的字符串处理代码中。)。</p><p>作为一名Rust新手，这些类型之间的区别令人非常困惑，并且使得理解引用变得更加困难(&amp；字符串为什么不同于&amp；str？为什么不能直接创建字符串呢？(见鬼的&amp；&amp；str从哪里来？)。</p><p>&amp；str to string：string：：from()、to_string()、to_owner()、into()，不计数格式化路由或使用VEC或[U8]往返。</p><p>这些路线中的大多数在性能上都是相等的，而Rust社区似乎对哪些路线是“正确的”意见不一。</p><p>我最终养成了根据上下文使用不同的字符串的习惯(例如，into()表示我要将&amp；str转换为字符串，这样我就可以将其返回给_Owner()，表示我要取得所有权以便稍后使用该字符串)。</p><p>当前没有获取用户主目录的方法。std：：env：：home_dir()被明确标记为已弃用，文档鼓励用户依赖目录机箱(当前存档在GitHub上)2。</p><p>没有标准的扩展方式~。std：：fs：：canonicalize支持。而且..，但不是~。是的，我知道这是上面的复制品。</p><p>无法通过系统外壳调用命令。是的，我知道系统(3)是坏的。是的，我同意它不应该是执行其他进程的默认接口，甚至应该隔离以防止无意使用。所有这些都不能改变这样一个事实，即它偶尔是有用的3，并且在标准库中可以比最终开发人员随意使用sh-c更可靠地实现。</p><p>没有标准的打球方式。看起来球状板条箱是做这件事的半官方方式。</p><p>无可否认，这些都是很小的差距，而且都是由高质量的板条箱填补的。但它们增加了开发过程中的摩擦力，考虑到铁锈本来是如何无摩擦的，这种摩擦力尤其明显。</p><p>被告知我缺少Use std：：IO：：Read或Use Std：：IO：：Write，因为我正在调用他们的方法之一，该方法已被作用域中已有的内容实现。我理解Rust为什么这样做，但感觉很奇怪，特别是在未使用的导入的上下文中，否则就是编译器警告。</p><p>实现特征的特征的语法。为T：OtherTrai的特征实施T&lt；T&&gt;不太糟糕，但它读起来几乎不像其他T：OtherTrait的Imp特征那么自然。</p><p>有时rustc需要我添加where self：size到我的静态(即非我)traitfunction。我仍然不明白为什么这有时是必需的，有时不是；我确信有一个像样的理由。</p><p>给定固定数组x=[T；N]和类型为U的索引变量i，使得U：：MAX&lt；N，通过x[i]进行索引将始终是安全的。尽管如此，Rustc希望程序员明确地将I拓宽到USIZE：</p><p>fn main(){let lookup_table：[U8；256]=[0_u8；256]；let index=5_u8；println！(&#34；{}&#34；，lookup_table[index])；}。</p><p>错误[E0277]：类型`[U8]`不能由`u8`索引--&gt；src/main.rs：4：20|4|println！(&#34；{}&#34；，lookup_table[index])；</p><p>这是可以理解的，但要求程序员要么在他们计划索引的任何地方使用as usize(冗长，并屏蔽索引背后的意图是U8)，要么将索引本身设为usize(也屏蔽了意图，并使其更容易进行最终超出界限的算术)。</p><p>我不知道这是不是真正的虫子，但它咬了我几次，所以我要把它扔掉。</p><p>Cargo Install显然不知道如何发现带后缀的软件包版本。例如，如果将myfakepackage发布为版本0.0.1-alpha.0，则Cargo Install将报告：</p><p>我还有其他一些想要抱怨的事情(核心类型的别名不支持特征，包生态系统在风格上有点太js/npm-y)，但我认为这样做可能会对一种我非常满意的语言过于负面。</p><p>五年后我仍然喜欢Ruby，我对Rust感到乐观。</p><p>不包括字符串和&amp；cstr，因为它们主要在外国投资环境中使用，可以理解它们是不同的。“↩。</p><p>我知道在POSIX平台上可靠地获取用户的主目录实际上非常困难。这并不能改变标准库应该尝试这样做的事实。“↩。</p><p>一个恰当的例子是：CLI经常公开钩点和回调，因为能够用外壳语法编写代码非常有用。。↩</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.yossarian.net/2020/05/20/Things-I-hate-about-rust">https://blog.yossarian.net/2020/05/20/Things-I-hate-about-rust</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/rust/">#rust</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/生锈/">#生锈</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/hate/">#hate</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/字符串/">#字符串</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1002706.html"><img src="http://img.diglog.com/img/2020/5/thumb_92ffcc35d5ca44c6ecefe7c8c3fc3dc7.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002706.html">Facebook收购Giphy在国会敲响了反垄断警报</a></div><span class="my_story_list_date">2020-5-19 6:52</span></div><div class="col-sm"><div><a target="_blank" href="/story/1002565.html"><img src="http://img.diglog.com/img/2020/5/thumb_1d220eb57b5e6521df6829fadc8b94d5.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002565.html">Rust/WinRT使微软更接近在内部采用Rust</a></div><span class="my_story_list_date">2020-5-18 4:48</span></div><div class="col-sm"><div><a target="_blank" href="/story/1002362.html"><img src="http://img.diglog.com/img/2020/5/thumb_467d0d52a10a5d84b2cd114f7198ad59.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002362.html">POI：Rust中的实用无点定理证明器助手</a></div><span class="my_story_list_date">2020-5-16 14:3</span></div><div class="col-sm"><div><a target="_blank" href="/story/1002334.html"><img src="http://img.diglog.com/img/2020/5/thumb_d9b7158395b8d4eff5ae4e52f47cbf1f.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002334.html">司法部，州总检察长可能对谷歌提起反垄断诉讼</a></div><span class="my_story_list_date">2020-5-16 7:40</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>