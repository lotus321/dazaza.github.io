<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用WebSocket从开发人员那里窃取机密</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用WebSocket从开发人员那里窃取机密</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-21 18:18:26</div><div class="story_img_container"><img src="http://img.diglog.com/img/2020/5/6f27184a1f3800946822e5d353923f1a.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></div><div class="page_narrow text-break page_content"><p>这是一个关于从从事绝密项目的不知情的JavaScript开发人员那里提取Codez的复杂但不太有用的方法的故事。</p><p>最近有几篇关于网站滥用WebSocket功能对用户的计算机进行端口扫描的文章出现在这些网站上。例如：https://nullsweep.com/why-is-this-website-port-scanning-me/.。</p><p>这些技术之所以有效，是因为浏览器允许来自公共来源的WebSocket打开到本地主机的WebSockets连接，而不需要太多保护。</p><p>这让我开始思考。我知道流行的JavaScript框架在开发中使用WebSockets在内容更改时自动重新加载页面。恶意网站会窃听该流量，并找出开发人员何时保存他们的代码吗？</p><p>要么设置，要么向前端开发人员经常使用的热门站点注入广告恶意软件。让我们说http://frontend-overflowstack.com/。</p><p>在此页面上，添加尝试打开公共端口的WebSockets连接的代码(扫描10k端口大约需要一秒钟，因此您可以在此相当慷慨)。</p><p>如果页面设法打开了一个连接，请使其保持打开状态，并将收到的所有消息转发到您的恶意秘密数据库。</p><p>我在http://frontend-overflowstack.com/.上托管了一个非常简单的页面。加载后，它会尝试将网络插座连接到访问者计算机上2000到10000之间的每个端口(除了Firefox不允许的几个端口)。如果端口连接，则它会侦听该端口并输出收到的任何消息。此页面不保存或以其他方式传输任何捕获的数据，它仅临时显示在屏幕上。</p><p>如果此页上出现任何输出，则实际恶意的站点可以很容易地将该输出发送到它想要的任何服务器。</p><p>要测试这个概念，我们需要一个使用热重新加载的简单Web服务器。这是我能想到的最简单的方法：</p><p>它在运行时会在端口3000上启动服务器，在端口9856上启动WebSocket服务器，并每隔5秒向任何连接的WebSocket客户端发送消息：RELOAD。</p><p>因此，front end-overflowstack.com直接窃听本地开发服务器向我的本地浏览器发送的重新加载消息。</p><p>在这个阶段，可以坐下来兴高采烈地计算每个访问我们站点的访问者对他们的本地JavaScript代码进行了多少次更改，但是我们能用这个来获取更多信息吗？</p><p>现在的大多数前端开发似乎都涉及到使用REACTION，通常这涉及到运行webpack开发的服务器，该服务器包括它自己的、更花哨的Web套接字接口。</p><p>此服务器通过其Web套接字共享更多数据，但只有一点点有趣。演示这一点非常简单，只需调用Create-Reaction-app：</p><p>一旦有更多的数据被显示，我们就会得到哈希和状态消息，所有无用的信息。</p><p>但是，当开发人员输入错误时会发生什么呢？webpack开发服务器通过其WebSocket连接，很有帮助地尝试将大量调试和堆栈信息发送到开发人员的屏幕上。</p><p>现在事情变得更有趣了。我们有代码片段，文件路径，位置，各种有用的信息。</p><p>如果最终开发人员意外地在包含有用数据的行上输入错误，情况会更好：</p><p>现在，我们已经获得了此开发人员的AWS开发人员凭据的副本。快点，启动比特币矿工！</p><p>没有某种形式的图表，任何技术设计都是不完整的。下面是它的工作原理，用图表表示：</p><p>(为了简化图表，我省略了正在运行的本地Web服务器，并假装WebSocket服务器直接从编辑器内部发起)。</p><p>某些浏览器选项卡上的恶意网页会以静默方式连接到用户计算机上打开的WebSocket。当敏感数据通过该套接字发送时(来自期望通过仅本地通道进行通信的进程)，网站可以接收该消息数据，并将其转发到任何外部数据库。</p><p>说真的，这个攻击媒介是相当微不足道的。您必须引诱不知情的用户访问您的站点，并在他们开发JS代码时停留在该站点上。</p><p>然后，你必须等待幸运地从他们的编码错误中收集到一些数据，也许才能找到一个可以让你从这些数据中获利的机会。</p><p>然而，我们已经看到各个站点已经在使用WebSocket端口扫描技术，而没有引起一般开发人员的注意。由于JS工具往往使用少量的知名端口，因此编写脚本来巧妙地渗透Reaction Dev流量并不是特别困难。</p><p>想象一下，一个为Twitbook工作的内部开发人员只是在他们的编辑器中按了SAVE，导致访问令牌或内部服务器地址泄露给了错误的用户。</p><p>这有点吓人的方面是，一个合理的开发人员应该有一个普遍的期望，即在他们选择的代码编辑器中按下保存应该没有有效地导致数据泄漏到第三方Web服务的可能性。这次袭击增加了这种可能性，足以让人有点担心。</p><p>我试图拦截JavaScript热重载机制，因为这确实是我熟悉的WebSockets的唯一通用用法。不和谐也使用WebSockets，但匆匆一瞥并没有产生任何明显的结果，因为该频道的设计考虑到了公共互联网。</p><p>令人担忧的是，仅仅这一个用于重新加载的单向通信通道的简单用例就将如此多的潜在信息暴露给了不好的网站。</p><p>考虑到这一点，WebSockets的其他用途(对于不是为公共互联网设计的数据)可能会受到类似的危害。</p><p>可以说，webpack开发的服务器应该进行一些身份验证，或者使用替代的浏览器通信通道进行热重新加载(我相信出于其他原因，这已经在计划中了)。</p><p>浏览器/Web标准为WebSocket实现源码策略的方式确实令人惊讶，并导致专为本地开发而设计的软件以一种不理想的方式暴露在公共互联网上。</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://medium.com/@stestagg/stealing-secrets-from-developers-using-websockets-254f98d577a0">https://medium.com/@stestagg/stealing-secrets-from-developers-using-websockets-254f98d577a0</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/开发/">#开发</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/websocket/">#websocket</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/secrets/">#secrets</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/开发人员/">#开发人员</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1003021.html"><img src="http://img.diglog.com/img/2020/5/thumb_2df22c30a019166b03ed5df2cfbc6bbe.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003021.html">为什么开发人员讨厌PHP</a></div><span class="my_story_list_date">2020-5-21 4:16</span></div><div class="col-sm"><div><a target="_blank" href="/story/1002934.html"><img src="http://img.diglog.com/img/2020/5/thumb_e21e09533e1794f43f6532c9f8b20d49.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002934.html">哪个是最好的Web开发Python框架？</a></div><span class="my_story_list_date">2020-5-20 14:44</span></div><div class="col-sm"><div><a target="_blank" href="/story/1002906.html"><img src="http://img.diglog.com/img/2020/5/thumb_b75b93ce34f7fdb21ba02f06cb5b9c17.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002906.html">Microsoft为您的开发环境首次推出Windows软件包管理器</a></div><span class="my_story_list_date">2020-5-20 8:49</span></div><div class="col-sm"><div><a target="_blank" href="/story/1002771.html"><img src="http://img.diglog.com/img/2020/5/thumb_5ee940fee3bbb459294046c9c1b0fcc8.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002771.html">如果您想成为高级开发人员，请停止关注语法</a></div><span class="my_story_list_date">2020-5-19 21:0</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>