<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>超越仿真：对N64源代码进行逆向工程的巨大努力</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">超越仿真：对N64源代码进行逆向工程的巨大努力</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-07 20:03:25</div><div class="story_img_container"><img src="http://img.diglog.com/img/2020/5/ab59032af71d6d9f114b4f79a2908923.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></div><div class="page_narrow text-break page_content"><p>本周早些时候，在没有任何警告的情况下，互联网上出现了一个Windows可执行文件，其中包含一个完全可以玩的超级马里奥64(Super Mario 64)PC端口。这个独立的程序远不只是一个普通的模拟ROM，它支持自动缩放到任何屏幕分辨率等功能，玩家已经在试验添加简单的显卡级别的重着色器，包括光线跟踪。</p><p>PC端口--发布时几乎没有升级--并不像其他一些现已停产的Super Mario 64移植项目那样，是在现代游戏引擎中从头开始构建的。它的发布与最近任天堂内部文件的泄露无关，这些文件可以追溯到Gamecube时代。</p><p>相反，这个移植似乎是一年来努力将Super Mario64ROM反编译成可解析的C代码的直接结果。这种从原始二进制代码到易读代码的逆向工程并不是一个简单的过程，但越来越多的业余反编译器社区正在努力解开他们最喜欢的一些游戏背后的秘密。</p><p>两年的反编译超级马里奥64的努力并不是从一开始就考虑到Windows可执行文件的。肯尼克斯目前正在帮助领导从这项努力中剥离出来的塞尔达逆向工程团队(Zelda Reverse Engineering Team，简称ZRET)，他说，相反，它的主要动机是那些想要更好地理解游戏代码的速跑者，以便帮助发现那些[速跑]漏洞。(Kenix目前正在帮助领导从这项努力中剥离出来的塞尔达逆向工程团队(Zelda Reverse Engineering Team，简称ZRET)。</p><p>对N64ROM进行反向工程的第一步是最基本的，就像首先找出使用了哪个特定版本的Silicon Graphics IDO编译器来创建ROM一样。这需要进行大量的试验和错误测试，在某些情况下，可以通过仔细解析泄漏的调试版本和隐藏在ROM文件中的源代码片段来帮助测试。Kenix告诉ARS，即使运行这样一个过时的编译器进行测试，也意味着模仿最初的N64开发人员使用的SGI工作站系统调用。</p><p>下一步只是简单地找出ROM是如何组织的。&#34；您如何知道函数在哪里？“你怎么知道多边形或纹理数据在哪里？”肯尼克斯说。您必须分析ROM的内部结构，然后生成一种将其拆分成各种文件的方法。</p><p>幸运的是，N64游戏将它们的文件安排在16字节的块中，这样可以更容易地看到标记文件末尾的空填充。还有一些游戏，比如Ocarina of Time，使用了一个易于解析的直接内存访问表，该表定义了原始ROM中的大多数文件边界(如今，像N64Split这样的工具可以自动执行这个过程)。游戏的调试版本还可以帮助反向工程师记录其结构，这要归功于存在未压缩的游戏文件和C宏，如__FILE__和__LINE__，它们揭示了任天堂使用的内部文件名。</p><p>由于ROM的编译器和基本结构已知，简单的反编译技术可以生成一个庞大的原始汇编语言指令列表，这些指令将馈送到N64硬件。但是，将这些指令转换成人类可解析和容易编辑的C代码绝非一个简单的过程(而且将汇编代码转换为C的自动化工具通常会引入逻辑错误或使代码混淆得太严重)。</p><p>因此，真正对N64ROM进行反向工程意味着逐个函数地检查这些汇编代码文件，并手动将它们转换成可用的C代码。与仿真不同的是，有时足够接近就足够了，但这里的精确度很重要。我们的目标是[在运行编译器之后]逐字节匹配游戏中所有函数的原始汇编代码，&#34；Kenix说。</p><p>即使以这种方式转换少数汇编指令的一个小函数也可能是一个复杂的过程。但是，单个N64功能可能会运行数千条指令，而一款N64游戏可能会有数千条这样的功能(例如，在Ocarina of Time中，超过15，700个)。</p><p>难度也可能因游戏而异。对于超级马里奥64，任天堂在编译源代码时没有任何花哨的编译器选项，这意味着反编译后的汇编语言更容易转换回C代码。然而，对于像“时间的奥卡莉娜”这样的游戏，任天堂使用优化标志来生成更快的代码，使得生成的ROM更难解开源代码。</p><p>Kenix说，当有优化标志时，对于&#39；vs&#39；While&#39；[Statement]等，很难将循环与&#39；匹配。您必须尝试所有等效的代码模式，直到找到匹配的模式。</p><p>虽然ZRET领导层明白PC端口将是他们努力的自然结果，但Kenix表示，反向工程师认为这超出了我们的工作范围。我们只需反编译游戏即可。其他人不可避免地会拿起它并写入PC端口。&#34；</p><p>但ZRET成员Rozlette指出，即使手头有反编译的C代码，制作PC端口也不像只是为Windows编译那么容易，ZRET成员罗兹莱特(Rozlette)指出。&#34；有很多代码处理与N64硬件的对话。例如，N64渲染管道与现代OpenGL有很大不同。</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://arstechnica.com/gaming/2020/05/beyond-emulation-the-massive-effort-to-reverse-engineer-n64-source-code/">https://arstechnica.com/gaming/2020/05/beyond-emulation-the-massive-effort-to-reverse-engineer-n64-source-code/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/代码/">#代码</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/逆向工程/">#逆向工程</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/源代码/">#源代码</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/massive/">#massive</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1001074.html"><img src="http://img.diglog.com/img/2020/5/thumb_40c084415cda03650064ce1eed8b3c85.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1001074.html">GitHub问题呼吁撤回帝国理工学院代码库缺陷研究</a></div><span class="my_story_list_date">2020-5-7 20:1</span></div><div class="col-sm"><div><a target="_blank" href="/story/1001043.html"><img src="http://img.diglog.com/img/2020/5/thumb_40c084415cda03650064ce1eed8b3c85.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1001043.html">帝国理工学院冠状病毒建模代码/尼尔·弗格森(主要部分)</a></div><span class="my_story_list_date">2020-5-7 19:53</span></div><div class="col-sm"><div><a target="_blank" href="/story/1000999.html"><img src="http://img.diglog.com/img/2020/5/thumb_455b755b67aef55fcf98b4e5cca766c2.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1000999.html">GitHub代码QL</a></div><span class="my_story_list_date">2020-5-7 3:35</span></div><div class="col-sm"><div><a target="_blank" href="/story/1000990.html"><img src="http://img.diglog.com/img/2020/5/thumb_32121923fe12e38e356c6e2879dda23d.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1000990.html">弗格森模型的代码回顾</a></div><span class="my_story_list_date">2020-5-7 3:20</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>