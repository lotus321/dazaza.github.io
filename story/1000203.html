<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>拼凑电子墨水仪表盘</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1>拼凑电子墨水仪表盘</h1><div class="row"><div class="col-lg-8 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time">2020-05-02 17:58:19</div><p>我意识到我在一遍又一遍地问谷歌助手同样的问题。比如现在的天气怎么样？或者我今天的日程表上有什么？因此，我开始为我的树莓PI构建一个小仪表盘，我可以代替它进行检查。</p><p>我花了大约20美元买了一个Waveshare 2.7英寸的电子纸帽子(B)。这个版本配有一个印刷电路板，可以直接插在树莓PI的通用输入/输出(GPIO)引脚上。您还可以使用随附的导线，以避免阻塞未使用的GPIO引脚。</p><p>我按照Waveshare wiki的安装说明启动了hello world程序之一-有C和Python两个版本。与其他Raspberry PI硬件附件相比，实现这一点的步骤以及示例程序非常容易实现。</p><p>我开始仔细阅读Python示例的源代码，以了解EPD库是如何工作的。该屏幕B版为三色，可显示白、黑、红三色，分辨率为264x176。示例首先清除屏幕(用白色填充)，然后创建两个层，这两个层是Pillow库中的Image对象。其中一层是黑色内容，另一层是红色内容。然后将它们传递给渲染函数EPD：：Display。</p><p>#initialize the EPD classepd=epd2in7b.EPD()EPD.init()#从清晰的(白色)背景开始.Clear()#定义简单的字体24=ImageFont.truetype(os.path.join(picdir，&#39；Font.ttc&#39；)，24)#创建空的图像对象/层HBlackimage=Image.new(&#39；1&#。，(EPD.high，EPD.width)，255)#渲染黑色部分Black_Draw=ImageDraw.Draw(HBlackImage)BLACK_DRAW.text((1，1)，top_text，font=font_Large，Fill=0)#Calculate.。</p><p>对于原型，我将显示当前的天气和来自BBC的一些新闻头条。Open Weather和News API都有慷慨的自由层。对于这些特性中的每一个，我都将编写返回文本的函数，我可以从中创建图层。</p><p>我将使用Python3.5中的格式化字符串(而不是高级的f字符串)，因为这是Raspian(默认的Raspberry PI操作系统)附带的。</p><p>def get_weet()：&#39；&#39；&#39；&#39；获取格式化的天气描述。例如：`里士满，GB：晴空`&#39；&#39；&#39；owm=pyowm.OWM(Open_Weet_Key)servation=owm.weet_at_place(Location)w=观察.get_weet()Detailed=w.get_Detailed_status().Capitalize()temp_data=w.get_temp(&#39；摄氏度；)current_temp=str(temp_data[&#34；])min_temp=str(temp_data[&#34；temp_min&#34；])max_temp=str(temp_data[&#34；temp_max&#34；])text=&#39；{}：{}\n{}°C({}°C.。</p><p>遗憾的是，News API没有可用的最新库，所以我使用请求进行HTTP调用并解析数据。我可以显示大约三个标题(每个标题都有一个额外的换行)。文本需要手动换行，以防止其脱离屏幕。</p><p>def get_news(Limit=3)：&#39；&#39；&#39；&#39；从BBC获取一些列表格式的新闻标题。例如，“备受赞誉的瑞典作家佩尔·奥洛夫·恩奎斯特去世了-PM重返工作岗位，这是对这个国家的一个提振。错误的说法是，瑞典没有采取认真的措施。”URL=&#39；https://newsapi.org/v2/top-headlines?sources=bbc-news&amp；apiKey={}&#39；。格式(News_Api_Key)resp=request.get(url=url)data=resp.json()文章=[文章[&#39；标题&#39；]用于数据中的文章.。</p><p>使用这两段文本，我创建了图像层。我希望天气在黑色的图层上，字体稍大一点。新闻将在红色的图层下面。下面是一个函数，它接受EPD类的一个实例以及两段文本。</p><p>def show_text(EPD，top_text=&#39；&#39；，Bottom_text=&#39；&#39；)：&#39；&#39；&#39；给定EPD实例和文本部分，渲染文本。&#39；&#39；&#39；&#39；HBlackImage=Image.new(&#39；1&#39；，(epd2in7b.EPD_Height，epd2in7b.EPD_Width)，255)HRedImage=Image.new(&#39；1&#39；，(epd2in7b.EPD_HEIGHT，epd2in7b.EPD_WIDTH)，255)#渲染黑色部分BLACK_DRAW=ImageDraw(HBlackImage)BLACK_DRAW.text((1，1)，top_text，font=font_Large，Fill=0)#计算黑色的深度.。</p><p>这两个Image对象包含简单的数据，并不“知道”它们是什么颜色。渲染为位图格式时，它们看起来如下所示。</p><p>注意第二层为第一层留出的空间，这样文本就不会重叠。</p><p>这个程序的主要功能是确保我们只在有人醒着的时候才显示仪表板。我希望避免文档警告的重影。传递给show_text函数的EPD类在这里初始化。</p><p>定义m</p><div class="text-break sotry_link"><a target="_blank" href="https://healeycodes.com/hacking-together-an-e-ink-dashboard/">https://healeycodes.com/hacking-together-an-e-ink-dashboard/</a></div><div class="story_tags"><button type="button" class="btn btn-light my_tag"><a href="/tag/电子/">#电子</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/ink/">#ink</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/epd/">#epd</a></button></div></div></div><div class="col-lg-4 col-0"><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/百度/">#百度</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/搜索/">#搜索</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button></div></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>