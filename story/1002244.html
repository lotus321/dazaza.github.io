<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用Crytic的智能合同中的漏洞搜索</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用Crytic的智能合同中的漏洞搜索</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-15 23:59:29</div><div class="story_img_container"><img src="http://img.diglog.com/img/2020/5/95e99b453d2936c0af879a64bde34b27.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></div><div class="page_narrow text-break page_content"><p>Crytic是我们的Github应用程序，用于发现智能合同缺陷，在某种程度上是一件大事：它可以在没有人工干预的情况下检测安全问题，在你工作的同时提供持续的保证，并在部署之前保护你的代码库。</p><p>Crytic发现了许多其他工具无法检测到的错误，包括一些不广为人知的错误。目前，Crytic有90多个探测器，我们正在不断增加新的检查并改进现有的检查。它在每次提交时运行这些错误和优化检测器，并评估您自己添加的自定义安全属性！</p><p>今天，我们将分享仅由Crytic发现的主要项目中的12个问题，其中包括一些高度严重的问题。</p><p>Crtic在安永的“夜幕降临”项目中发现了三个漏洞，其中一个严重漏洞可让任何人制造免费代币。</p><p>FTokenShield.mint不检查transfer From的返回值。如果FTokenShield与令牌一起使用，该令牌在错误传输的情况下不会恢复，并且只返回FALSE(例如，BAT)，则任何人都可以创建免费承诺-而攻击者可以免费创建令牌。</p><p>FTokenShield.registerVerificationKey和NFTokenShield.registerVerificationKey返回空字节32。不清楚正确的返回值应该是什么。这可能会导致第三方和合同出现意想不到的行为。</p><p>可以在MerkleTree.sol中声明treeHeight和0为常量，以允许编译器优化此代码。</p><p>Crytic在DeFiStrategy中发现了一个不寻常的问题：修饰符中缺少占位符执行，导致调用者函数返回默认值。此外，Crytic发现了一个与返回BalanceOf调用时严格相等相关的问题。</p><p>在无效访问的情况下，SuperSaverZap.onlyInSurface()和SuperSaverZap.stopInSurface()修饰符不会恢复。如果修饰符没有执行或还原，则函数的执行将返回默认值，这可能会误导调用者。</p><p>ERC20toUniPoolZapV1_General.addLiquity在_UniSwapExchangeContractAddress余额上严格相等。此行为可能允许攻击者通过向_UniSwapExchangeContractAddress发送令牌来陷阱协定。</p><p>Crytic发现了另一个在DOSNetwork中并不广为人知的问题：如果使用多个动态参数调用abi.encodedPacked，则可以使用不同的参数返回相同的值。</p><p>此模式容易发生冲突，使用不同的数据源和选择器的两个调用可能会导致相同的queryId(有关详细信息，请参阅Solidity文档)。</p><p>不要在encodePacked中使用多个动态类型，并考虑首先使用keccak256散列数据源和选择器。</p><p>在基线协议中，Crtic发现了一个架构问题，其中包括：实现接口的契约不继承它。</p><p>Shield是ERC1820ImplementerInterface的实现，但它不从接口继承。此行为容易出错，可能会阻止实现或接口正确更新。</p><p>Crytic在ethKids中发现了另一个不寻常的问题：*this.Balance包括当前事务的金额(msg.value)，这可能会导致不正确的值计算。</p><p>在fundWithAward中使用this.Balance不会考虑msg.value已经添加的值。因此，价格计算是不正确的。</p><p>msg.value已经存在于此.Balance中。例如，如果this.Balance在交易前是10以太，而msg.value是1eth，那么在交易期间this.Balance将是11以太)。结果，msg.value被使用了两次，culatePurche eReturn计算错误。</p><p>更改价格计算，以便_Reserve veBalance不包括事务中发送的金额。</p><p>最后，Crtic在HQ20中发现了一个众所周知的问题：可重入性。这种可重入性很有趣，因为如果协定与具有回调功能的令牌(如ERC777)一起使用，就会发生这种情况。这类似于最近的uniswap和lendf.me黑客攻击。</p><p>在不遵循检查效果交互模式的情况下，Classfied调用从外部令牌转移。如果目标令牌具有回调机制(例如，ERC777令牌)，则这会导致可被攻击者利用的重入性。</p><p>Crytic可以将代码库从关键缺陷中拯救出来，并帮助您设计更安全的代码。有什么不喜欢的？</p><p>今天就报名参加Crtic吧。有问题吗？加入我们的松弛频道(#Crytic)或在Twitter上关注@CryticCi。</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.trailofbits.com/2020/05/15/bug-hunting-with-crytic/">https://blog.trailofbits.com/2020/05/15/bug-hunting-with-crytic/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/漏洞/">#漏洞</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/crytic/">#crytic</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/hunting/">#hunting</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/问题/">#问题</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1002194.html"><img src="http://img.diglog.com/img/2020/5/thumb_ffdd2cf0a72bcf83175ab0307924ba87.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002194.html">Adobe针对DNG、Reader、Acrobat中的36个漏洞发布修补程序</a></div><span class="my_story_list_date">2020-5-15 11:36</span></div><div class="col-sm"><div><a target="_blank" href="/story/1002138.html"><img src="http://img.diglog.com/img/2020/5/thumb_299765ac255c94a6c2c8e299e7e426db.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002138.html">由于提交数量过多，Zerodium停止购买iOS漏洞</a></div><span class="my_story_list_date">2020-5-15 4:9</span></div><div class="col-sm"><div><a target="_blank" href="/story/1002107.html"><img src="http://img.diglog.com/img/2020/5/thumb_3a20791feb41759f3f28e4058962a161.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002107.html">Adobe Acrobat Reader中的安全漏洞允许以静默方式在MacOS上获得根</a></div><span class="my_story_list_date">2020-5-15 0:5</span></div><div class="col-sm"><div><a target="_blank" href="/story/1002091.html"><img src="http://img.diglog.com/img/2020/5/thumb_22cc0c7b4e377b50e282dfcbd2f137f1.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002091.html">Stuxnet的遗产在新的Windows漏洞中继续存在</a></div><span class="my_story_list_date">2020-5-14 21:58</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>