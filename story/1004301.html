<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>SWIFT AWS Lambda运行时</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">SWIFT AWS Lambda运行时</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-30 02:52:35</div><div class="story_img_container"><img src="http://img.diglog.com/img/2020/5/e7117e2db671fcdebcea09e106639103.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></div><div class="page_narrow text-break page_content"><p>我很高兴宣布SWIFT服务器生态系统的一个新开源项目-SWIFT AWS Lambda Runtime。SWIFT AWS Lambda Runtime作为SWIFT软件包分发，旨在帮助SWIFT开发人员为Amazon Web Services Lambda平台构建无服务器功能。</p><p>该项目是一个团队的努力，包括SWIFT社区的工程师，包括来自苹果和亚马逊的工程师。值得注意的是，法比安·费特是社区工作的先驱，也是图书馆的合著者。作为一个开源库，任何有兴趣为该项目做出贡献的人都可以很容易地加入进来，帮助它变得更好。</p><p>许多现代系统都有客户端组件，如iOS、MacOS或WatchOS应用程序，以及这些客户端与之交互的服务器组件。对于客户端应用程序开发人员来说，无服务器功能通常是将其应用程序扩展到云中的最简单、最有效的方式。</p><p>无服务器功能正成为在云中运行事件驱动或临时计算任务的日益流行的选择。它们为任务关键型微服务和数据密集型工作负载提供支持。在许多情况下，考虑到开发人员的按需特性，无服务器功能允许开发人员更轻松地扩展和控制计算成本。</p><p>在使用无服务器功能时，必须注意资源利用率，因为它直接影响系统成本。这就是斯威夫特大放异彩的地方！凭借其低内存占用、确定性性能和快速启动时间，SWIFT是无服务器功能架构的绝佳匹配。</p><p>将这一点与SWIFT对开发人员的友好性、表现力和对安全性的重视相结合，我们就拥有了一个适合所有技能水平、可扩展且经济高效的开发人员的解决方案。</p><p>SWIFT AWS Lambda Runtime旨在使在SWIFT中构建Lambda函数变得简单而安全。该库是AWS Lambda Runtime API的实现，并使用嵌入式异步HTTP客户端，该客户端针对AWS Runtime环境中的性能进行了微调。该库提供了一个多层API，允许构建一系列Lambda函数：从快速而简单的闭包到复杂的、性能敏感的事件处理程序。</p><p>使用AWS Lambda Runtime的最简单方式是传入闭包，例如：</p><p>//导入模块import AWSLambdaRuntime//在本例中，我们接收并响应字符串Lambda。在callback(.)中运行{(context，payload：string，callback)。成功(&#34；Hello，\(有效负载)&#34；)}。</p><p>更常见的情况是，有效负载将是JSON，它是使用COODABLE建模的，例如：</p><p>//导入模块导入AWSLambdaRuntime//请求，使用codable进行透明JSON编码私有结构请求：codable{let name：string}//响应，使用codable进行透明JSON编码私有结构响应：codable{let message：string}//在本例中我们使用codable Lambda接收和响应JSON。在callback(.)中运行{(context，request：request，callback)。Success(响应(Message：&#34；Hello，\(Request.。姓名)&#34；)}。</p><p>由于Lambda函数通常由源自AWS平台的事件(如SNS、SQS或S3事件)触发，因此该软件包还包括AWSLambdaEvents模块，提供这些常见触发事件类型的实现。例如，处理SQS消息：</p><p>//导入模块导入AWSLambdaRuntime import AWSLambdaEvents//在本例中，我们收到一条SQS消息，没有响应(Void)Lambda。运行{(上下文，消息：SQ.。留言、回叫)在.。回调(.。Success(void()}。</p><p>除了这些常见的触发事件，AWSLambdaEvents还包括用于将Lambda函数与APIGateway集成的抽象，APIGateway是一个AWS系统，可帮助将Lambda函数公开为HTTP端点。</p><p>//导入模块导入AWSLambdaRuntime import AWSLambdaEvents//在此示例中，我们收到一个APIGateway.V2.Request，//并使用APIGateway.V2.Response Lambda进行重新发布。运行{(上下文，请求：APIGateway。V2。请求、回叫)在.。回调(.。成功(APIGateway。V2。响应(statusCode：。接受)}。</p><p>将Lambda函数建模为闭包既简单又安全。SWIFT AWS Lambda Runtime将确保将用户提供的功能从网络处理线程卸载到其自己的线程，以便即使代码变慢或没有响应，底层Lambda流程也可以继续并与运行时引擎交互。这种安全性是以网络线程和处理线程之间的上下文切换带来的小性能损失为代价的。在大多数情况下，使用基于闭包的API的简单性和安全性优于下面详述的面向性能的API的复杂性。</p><p>对性能敏感的Lambda函数可以选择使用更复杂的API，该API允许用户代码在与网络处理程序相同的线程上运行。SWIFT AWS Lambda Runtime使用SwiftNIO作为其底层网络引擎，这意味着这些API基于SwiftNIO的并发原语，如EventLoop和EventLoopFuture。</p><p>//导入模块导入AWSLambdaRuntime import AWSLambdaEvents import NIO//我们的Lambda处理程序，符合EventLoopLambdaHandler struct Handler：EventLoopLambdaHandler{typealias in=sns。message//请求类型类型别名out=void//响应类型，或void//在此示例中，我们接收的SNS消息没有响应(Void)函数句柄(上下文：lambda。上下文，有效负载：输入)-&gt；EventLoopFuture&lt；输出&gt；{.。上下文。eventLoop。Make SucceededFuture(void())}}Lambda。Run(Handler())。</p><p>除了使用基于EventLoopFuture的API的认知复杂性之外，请注意这些API的使用应该格外小心。EventLoopLambdaHandler将在与库的网络引擎相同的EventLoop(线程)上执行用户提供的函数，这对实现提出了永不阻塞底层EventLoop的要求。换句话说，Lambda代码不应该使用阻塞API调用，因为它可能会阻止库与Lambda平台交互。</p><p>这是一个社区驱动的开源项目积极寻求贡献的开始。虽然核心API被认为是稳定的，但API仍可能随着其接近1.0版本而发展。有几个领域需要额外关注，包括但不限于：</p><p>如果您对SWIFT AWS Lambda Runtime感兴趣，请来参与！源代码是可用的，我们鼓励来自开源社区的贡献。如果您有反馈、问题或想要讨论该项目，请随时在SWIFT论坛上聊天。如果您想报告错误，请使用GitHub问题跟踪器。我们期待着与您合作，并帮助推动行业迈向更好、更安全的编程未来。</p><p>请随时在SWIFT论坛的相关帖子上发布有关此帖子的问题。</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://swift.org/blog/aws-lambda-runtime/">https://swift.org/blog/aws-lambda-runtime/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/aws/">#aws</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/lambda/">#lambda</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1004015.html"><img src="http://img.diglog.com/img/2020/5/thumb_007b482aa986333fc78089046c59a771.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1004015.html">我们的流数据渠道上的AWS成本降低了67%</a></div><span class="my_story_list_date">2020-5-28 9:39</span></div><div class="col-sm"><div><a target="_blank" href="/story/1003935.html"><img src="http://img.diglog.com/img/2020/5/thumb_2cbff7d22350cc140d60655e28eb11a7.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003935.html">如何与AWS竞争</a></div><span class="my_story_list_date">2020-5-27 23:47</span></div><div class="col-sm"><div><a target="_blank" href="/story/1003603.html"><img src="http://img.diglog.com/img/2020/5/thumb_6799b3b0c909aaf214b3ae67e3703924.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003603.html">所有5个AWS分区的列表(AWS、AWS-CN、AWS-US-GOV、AWS-ISO、AWS-ISO-b)</a></div><span class="my_story_list_date">2020-5-25 13:14</span></div><div class="col-sm"><div><a target="_blank" href="/story/1002578.html"><img src="http://img.diglog.com/img/2020/5/thumb_2e1a900dc4badae648b7bbd57f13f4e8.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002578.html">30分钟内在GCP/AWS上设置游戏平台</a></div><span class="my_story_list_date">2020-5-18 6:53</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>