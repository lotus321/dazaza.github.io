<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>高级PostgreSQL数据类型</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">高级PostgreSQL数据类型</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-28 03:51:35</div><div class="story_img_container"><img src="http://img.diglog.com/img/2020/5/6be00fc95f878531d2b62431648eea6a.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></div><div class="page_narrow text-break page_content"><p>这篇文章是由两部分组成的系列文章的第二部分--在这里阅读第一部分：回到PostgreSQL数据类型的基础。</p><p>在上一篇文章中，我分享了一些我在研究PostgreSQL中的数据类型时学到的有趣(有时令人惊讶)的事情。NUMERIC、INTEGER、DATE和char/varchar等数据类型存在于所有其他关系数据库系统中，因为使用此类数据的需求几乎是既定的。不同系统的实现可能略有不同，但通常有一些标准方法可以处理和分析这些类型的数据(例如，执行数学计算、找出字符串的长度、从一种类型转换为另一种类型等)。</p><p>在Postgres中，我们还有一些即使是经验丰富的开发人员也不太熟悉的数据类型。让我们快速了解一下数组、枚举和范围类型。</p><p>数组可能比较熟悉，但如果您是编程新手，请注意：它是一种用于保存对象集合的数据类型。在某些语言(如JavaScript)中，数组本身不必保存相同数据类型的值。然而，在Postgres中，数组元素必须都是同一类型-表定义暗示了这一点：</p><p>正如我们在上面的Countries列中看到的，数组声明必须具有该数组将包含的值的类型名称。</p><p>我在互联网上的搜索似乎表明，数组类型非常适合不需要严格遵循规范化规则的数据。以上面的示例为例(改编自“PostgreSQL故障排除”一书中的一个示例)：COUNTRIES_VISTED表存储每个人去过的国家的列表。如果您想标准化数据，则可以使用一个表来存储人员和每个访问过的国家/地区的组合，结果是每个人最多有几十行。您还可以使用单独的查阅表格将两个字母的国家/地区代码链接到完整的国家/地区名称。</p><p>但是，您可能不一定需要维护查找表(有人可能会争辩说，更改国家名称并不一定要在访问过的国家列表中进行相应的更改)。您可能还会发现，将访问过的国家/地区列表保存在每人一条记录中会更有帮助，而不是每人可能需要处理数十条记录。使用数组意味着您可以去掉多余的表，并且不需要拥有属于同一个人的多行。</p><p>我遇到的其他几个可以使用数组类型的示例有：时间序列数据(如股票价格)、标记(用于分类或社交媒体)、从仪器获取的读数或测量。另一个好的经验法则可能是，如果您的应用程序代码中有使用数组的地方，并且您经常发现自己在获取整个数据集，则将数据存储为数组类型可以为您节省对查找表的多一次连接。</p><p>我喜欢这样可视化枚举：如果我只需要用下拉列表中的值填充一列，那么该下拉列表中会有什么呢？枚举类型自带一组可接受的值。(出于好奇：枚举类型在名为pg_enum的系统目录中注册，其中枚举值在内部表示为整数，每个枚举“标签”或名称存储为字符串。)。</p><p>你们中的一些人可能会想：“但这听起来不像是一个检查约束吗？或者可能是引用查找表的外键？“。你没有偏离正轨！这三种方法的实现方式不同，因此其中一种方法可能比其他方法更适合特定的用例。例如，如果我的可接受值列表将不断更改，我会选择查找表，因为修改表通常比修改枚举或约束更容易。所以，归根结底，这取决于您的特定需求，尽管我确实感觉到，将这三种方法视为解决问题的多个潜在工具是可以接受的。</p><p>您可能会说，“范围”可以描述某一组值，即当某物“在某个范围内”时，它就是该集合的一部分。因此，从表面上看，它听起来可能与枚举相距不远。我发现把范围类型的主要特征想成如下是有帮助的：</p><p>a)你一想到一个区间就会想到它的界限(即下限和上限)。b)范围内的值具有固有的顺序。</p><p>从技术上讲，您可以指定一个不存在限制的范围类型(因此范围是无限的)，但是即使是一个无界范围也仍然有一个顺序。</p><p>范围类型适用于诸如年龄、价格和重量等数字数据；日期/时间数据也是典型的候选类型。我推荐阅读Jonathan Katz的博客文章，他在其中深入研究了如何将日期范围类型用于日程安排应用程序。</p><p>这些只是PostgreSQL中您可能没有使用过或没有意识到的几种数据类型。这些更“高级”的数据类型的酷之处在于，它们可以帮助简化您的应用程序代码，并让您编写更简洁的数据库查询。</p><p>例如，有一些内置运算符可以与范围类型一起使用，使您可以轻松地找到两个范围的交集，或确定某个值是否在该范围内。这并不是说，如果您设置了两个单独的列来表示范围限制(一个常见的列是开始时间和结束时间)，您就不能得到相同的答案。但是，结合使用范围运算符和专门的索引(如GIST)可能有助于以更快、更高效的方式获得所需内容。</p><p>我们在Crunchy数据交互学习门户中关于数据类型的第二门课程重点介绍上述三种类型以及XML。它允许您使用一些示例数据来处理这些数据类型，并且还向您介绍了这些数据类型附带的一些有用的函数和运算符。</p><p>您是否曾经不得不更改您的数据结构并将其从常见的数据类型迁移到更高级的数据类型(如上述三种类型)？你的决策过程是怎样的？你的经历如何？请在下面发表评论。</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://info.crunchydata.com/blog/advanced-postgresql-data-types">https://info.crunchydata.com/blog/advanced-postgresql-data-types</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/可能/">#可能</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1003842.html"><img src="http://img.diglog.com/img/2020/5/thumb_4645b4c0568fe413d109202574ecaa93.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003842.html">病毒猎人瀑布是他低估的病毒的猎物</a></div><span class="my_story_list_date">2020-5-27 5:4</span></div><div class="col-sm"><div><a target="_blank" href="/story/1003816.html"><img src="http://img.diglog.com/img/2020/5/thumb_8ab3047d889e72f610eebb0de7aa53cf.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003816.html">《侠盗猎车手6》将于2023年问世？Take-在发布日期提交给SEC的两个提示</a></div><span class="my_story_list_date">2020-5-27 3:6</span></div><div class="col-sm"><div><a target="_blank" href="/story/1003782.html"><img src="http://img.diglog.com/img/2020/5/thumb_844e194e7e8f646bcdf46e353dd7615c.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003782.html">冠状病毒大流行可能导致7.5万人“绝望而死”</a></div><span class="my_story_list_date">2020-5-26 14:56</span></div><div class="col-sm"><div><a target="_blank" href="/story/1003772.html"><img src="http://img.diglog.com/img/2020/5/thumb_b6b2ab9ae1b83603e16d42267011e0fd.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003772.html">奇怪的是，降低写作中的阅读水平会增加观点</a></div><span class="my_story_list_date">2020-5-26 14:34</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>