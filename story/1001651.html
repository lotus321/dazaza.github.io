<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>抓取食谱网站</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">抓取食谱网站</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-11 14:34:24</div><div class="page_narrow text-break page_content"><p>食谱进口商是藏红花最重要的特点之一。它允许用户输入URL，并将尝试从该网站提取食谱内容。</p><p>偶尔，菜谱站点会使用客户端呈现或阻止“bot”请求，此方法不起作用。然而，这还不足以保证使用像木偶师这样的东西。</p><p>大约75%的用户选择导入的网站易于解析，但对于其余25%的网站，则需要更先进的技术。</p><p>事实证明，当一个网站包含一些标准食谱元数据时，谷歌就会显示这些卡片。</p><p>因此，几乎每个流行的食谱网站都会包括关于标题、服务、配料、说明等…的元数据。用于食谱(外语食谱也会出现这种情况)。</p><p>对于这些网站，不涉及任何猜测。只需读取元数据即可。</p><p>为此，将在HTML中搜索类型为application/ld+json的脚本标记，该标记包含大型JSON blob中的元数据。</p><p>&lt；脚本类型=&#34；application/ld+json&#34；&gt；{&#34；@Context&#34；：&#34；http://schema.org&#34；，&#34；@TYPE&#34；：&#34；食谱&#34；，&#34；名称&#34；：&#34；经典马里纳拉酱汁&#34；，&#34；ReceipeIngreative&#34；：[&#34；1罐28盎司的完整西红柿，1/4杯橄榄油，7个大蒜去皮并切成丝，1个小干整辣椒，1茶匙犹太盐，1个大的新鲜罗勒树枝，//更多的田地}/lt；/script&gt；#34；，#34；，#34；1大新鲜罗勒树枝#34；，#34；]//更多的领域}&lt；/script&gt；#34；，#34；，#34；，#34；，#34；，#34；，#34；，#34；，#34；，#34；，#34；//更多的领域}&lt；/脚本&&gt;；</p><p>如果不存在，则遍历HTML以查找使用itemprop注释的标记。</p><p>&lt；H1 itemprop=&#34；名称&gt；Simple Marinara Sauce&lt；/H1&gt；&lt；div&gt；&lt；span itemprop=&#34；ReceipeIngreary&34；&gt；2罐炖番茄&lt；/span&&gt;；&lt；span itemprop=&#34；ReceipeIngreative&34；&gt；span itemprop=&#34；regpeIngreative&#34；&gt；span itemprop=&#34；regpeIngreative&#34；&gt；span itemprop=&#34；regepeIngreative&#34；&gt；1茶匙盐/span&&gt;；/div&gt；</p><p>识别任意HTML中的配料和说明是最棘手的一步，所以我将把它留到最后。我们将首先从如何提取其他字段开始。</p><p>使用og：title元标记。如果不存在，则使用title标记。</p><p>将收集Body标记内的所有图像。然后删除较小的图像，用户从其余选项中选择正确的图像。</p><p>考虑每个HTML标记，直到找到一个包含Make：、Services：、Serving：或Year：的文本的标记。</p><p>好的，我们来谈谈寻找配料和说明书的技巧。</p><p>HTML可以在树结构中表示，其中HTML标记的子项成为树中节点的子项。</p><p>使用这个概念，HTML以深度优先的搜索方式被遍历，根据节点内部的文本对它们成为指令/成分的可能性进行评分。</p><p>它有没有使用任何特定于烹饪的指导性词汇，如：“撒”、“混”、“热”等。…。</p><p>有没有用“盐”、“橄榄油”、“黄油”等食品类的词呢？…。</p><p>是否包含“…”、“lb”、“oz”等单位？</p><p>找到两个单独的节点后，此步骤即告完成。一个有很高的指导分数，另一个有很高的成分分数。</p><p>在图论和计算机科学中，树或有向无环图T中两个节点v和w的最低公共祖先是同时具有v和w作为后代的最低节点。</p><p>我喜欢将其视为2个节点拥有的第一个共享父节点。这是它的一个很好的视觉效果：</p><p>这对于计算很有用，因为在大多数情况下，LCA节点将包含所有配料/说明，而所有其他HTML都可以忽略。</p><p>此时，假设配料和说明在LCA节点内，但是通常还有一些额外的节点没有用。</p><p>&lt；div&gt；&lt；！--开始忽略--&gt；&lt；div&gt；搭配您最喜欢的意大利面、披萨、千层面、肉丸、帕尔米亚干酪、三明治或任何听起来不错的食物。&lt；/div&&gt;；&lt；div&gt；这么多好的理由让这款马里纳拉酱…。那么让我们开始吧！&lt；/div&&gt;；&lt；！--End Ignore--&lt；&lt；！--第一个配料节点--&gt；&lt；div&&gt;；div&&gt;；1杯西红柿&lt；/div&&gt;；盐&lt；/div&&gt;；&lt；！--说明--&lt；div&&gt;；抛出。&lt；/div&gt；&lt；/div&gt；</p><p>&lt；div&&gt;；&lt；！--开始连续配料块--&gt；&lt；ul&gt；&lt；li&gt；1杯西红柿&lt；/li&&gt;；li&gt；盐&lt；/li&gt；&lt；/ul&&gt;；&lt；！--结束连续配料块--&gt；&lt；！--start。&lt；/div&gt；&lt；div&gt；搅拌。&lt；/div&gt；&lt；！--结束连续指令块--&gt；&lt；/div&gt；</p><p>因此，假设两个配料节点之间的所有节点都是配料(有助于检测奇怪的配料)。</p><p>&lt；ul&gt；&lt；li&gt；1杯米饭&lt；/li&gt；&lt；！--开始假定配料--&gt；&lt；li&gt；cardoon&lt；/li&gt；&lt；li&gt；Gurnard(选择黑肚)。&lt；/li&gt；&lt；！--end假定成分--&gt；&lt；li&gt；1茶匙盐&lt；/li&gt；&lt；/ul&gt；</p><p>使用这些假设，最后一步涉及遍历LCA节点的子节点。检查每个节点的，看它是属于配料块、指令块，还是应该完全忽略。</p><p>前面的分数与类名、标记(无论是…、SPAN、H1等)结合在一起考虑。和父标记。</p><p>只要达到一定的门槛，并不是所有的条件都需要满足。最好是更灵活一些，包含一些额外的信息，而不是更严格，有时会遗漏一种配料。</p><p>当已确定块时，可以提取成分/指令并完成算法。</p><p>为了让您了解一些成功解析的网站，这里使用了几个测试用例：</p><p>仍然会出现它没有正确提取配料/说明的情况，比如这个网站：http://www.cookingforengineers.com/recipe/195/Chocolate-Truffles。</p><p>用户输入指向没有食谱的网站的URL。</p><p>结合使用试探法和读取元数据，Saffron几乎可以从任何网站导入食谱。</p><p>如果您想亲自尝试一下，您可以在https://www.mysaffronapp.com.上查看</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.benawad.com/scraping-recipe-websites/">https://www.benawad.com/scraping-recipe-websites/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/食谱/">#食谱</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/recipe/">#recipe</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>