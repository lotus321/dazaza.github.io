<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>剖析SSL证书</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1>剖析SSL证书</h1><div class="row"><div class="col-lg-8 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time">2020-05-07 05:21:22</div><p>你好!。在我的网络杂志上(很快每个人都能看到)，有一个关于TLS/SSL的页面(基本上就是这条推文)，但是当你在一个页面上写200字关于一件事的时候，有很多更有趣的东西可以说。因此，在这篇文章中，我们将剖析一个SSL证书，并试着去理解它！</p><p>我不是一个安全人员，我不会给你的网站提供安全建议(想知道你应该使用什么TLS密码吗？我不知道！)。但!。我认为了解“颁发SSL证书”意味着什么是很有趣的，我可以稍微谈一下。</p><p>我很长一段时间都不明白这个“TLS”是什么，基本上更新的SSL版本叫做TLS(SSL3.0之后的版本是TLS1.0)。我将把它从头到尾都称为“SSL”，因为这对我来说不那么困惑。</p><p>mail.google.com在端口443上运行HTTPS服务器。我想确认我实际上是在与mail.google.com交谈，而不是互联网上其他由坏人拥有的随机服务器。</p><p>在很长一段时间里，这个“证书”业务对我来说都是一种神秘的东西。有一天，我的酷同事Ray告诉我，我可以通过命令行连接到服务器并下载它的证书！</p><p>(如果您只想查看SSL证书，您可以单击浏览器中的绿色锁，并可靠地获取所需的所有信息。但这更有趣。)。</p><p>因此，让我们从查看mail.google.com的证书开始，并对其进行一点解构。</p><p>这将打印一大堆东西，但我们只关注证书。在这里，是这样的：</p><p>原来，这种胡言乱语是一种名为“X509”的格式，openssl命令知道如何解码它。</p><p>所以我将这段文本保存到一个名为cert.pem的文件中。如果您想要继续操作，可以根据此要点将其保存到您的计算机中。</p><p>$openssl x509-in cert.pem-text证书：数据：版本：3(0x2)序列号：3633524695565792915(0x326cdf7599cef693)签名算法：sha256WithRSAEncryption颁发者：C=US，O=Google Inc，CN=Google Internet Authority G2有效期不早于：Jan 18 18：52：11 2017GMT：Apr 12 18：50：002017 GMT主题：C=US，ST=California，L=Mountain。cn=mail.google.com主题公钥信息：公钥算法：rsaEncryption Public-Key：(2048位)模：00：89：87：2B：0B：D4：67：EE：0F：71：8E：C8：3B：92：1A：9F：44：FC：54：9E：FA：60：1B：20：87：A8：93：17：C5：91：.。废话.。C2：4E：F8：9D：5F：FF：CF：BA：E3：65：45：95：60：DC：D8：CA：FF指数：65537(0x10001)x509v3扩展：x509v3主题备选名称：dns：mail.google.com，dns：inbox.google.com x509v3主题密钥标识符：8E:BD:69:80:84:B5:BD:AC:C1:B2:49:47:77:0C:39:37:5C:7E:F6:78签名算法：Sha256WithRSA加密21:8a:a4:08:c2:41:a9:d4:d9:a5:2e:af:3d:82:3a:00:7e:9c：1a：6a：91：ee：46：2c：71：97：64：b9：e1：fc：ae：ff：85。：8E：1C：92：.。更多的内容放在这里.。</p><p>这是一大堆东西。以下是我所理解的部分内容。</p><p>cn=mail.google.com是“常用名称”。与直觉相反，您应该忽略此字段，改为查看“Subject Alternative Name”字段。</p><p>x509v3主题备用名称：部分包含此证书适用的域的列表。这是mail.google.com和inbox.google.com，这是有道理的--它们都是电子邮件域名。</p><p>Public Key Info部分告诉我们将用于与mail.google.com通信的公钥。我们现在没有时间解释公钥密码学，但这基本上是我们要用来秘密交谈的加密密钥。</p><p>最后，签名是一件非常重要的事情。基本上任何人都可以为mail.google.com制作证书。我现在就可以做一个！但是如果我给你那张证书，你就没有理由相信那是一张真正的证书</p><p>证书(有效的域名和公钥等)。</p><p>别人的签名。这基本上是说，“嘿，这没问题，Visa是这么说的。”</p><p>我的计算机上/etc/ssl/certs中有一堆证书。这些是我的计算机信任用来签署其他证书的证书。例如，我的笔记本电脑上有/etc/ssl/certs/Staat_der_Nederlanden_EV_Root_CA.pem。一些来自荷兰的证书！谁知道呢！如果他们签署了mail.google.com证书，我的电脑会说“是的，看起来棒极了，听起来棒极了”。</p><p>如果街对面的某个随机的人签了证书，我的电脑就会像“我不知道你是谁”一样拒绝证书。</p><p>我的计算机上有一个/etc/ssl/certs/GeoTrust_Global_CA.pem文件，我认为这就是我信任此mail.google.com证书的原因。(GeoTrust签署了谷歌的证书，谷歌签署了mail.google.com)。</p><p>您将生成证书的前半部分(“jvns.ca！在X日期到期！这是我的公钥！“)。这部分是公开的。</p><p>同时，您将为您的证书生成私钥。你要保守秘密，不要把它给任何人看。您将在每次建立SSL连接时使用此密钥。</p><p>您向其他计算机信任的证书颁发机构(CA)支付为您签署证书的费用。证书颁发机构应该具有完整性，所以当他们签署证书时，他们应该确保他们颁发证书的人实际拥有域名。</p><p>你用你的签名证书来配置你的网站，并用它来证明你就是真正的你！成功！</p><p>这个“证书权威机构应该有完整性的东西”我想这就是为什么人们在赛门铁克出现这样的问题时如此生气，他们生成了“对未注册的域和赛门铁克没有域所有者授权的域的测试证书”。</p><p>我们要讨论的最后一件事是证书透明度。这是一件非常有趣的事情，而且有一个很好的网站，我几乎肯定会把它搞砸。</p><p>所以，我们说证书颁发机构“应该是诚信的”。但是证书颁发机构太多了，我的电脑都信任！他们中的任何一个随时都可以为mail.google.com签署流氓证书。这可不好。</p><p>这不是一个假设性的问题-证书透明性网站会谈论CA已被泄露或出错的不止一个实例。</p><p>所以，事情是这样的。在任何给定的时间，Google都知道mail.google.com应该存在的所有有效证书(可能只有一个或几个)。因此，证书透明度基本上是一种方法，可以确保如果mail.google.com有他们不知道的证书在流通，他们可以找出。</p><p>任何CA每次签署证书时，都应该将其放入全局公共“证书日志”中。</p><p>此外，Googlebot会将它在互联网上找到的每个证书都放入证书日志中</p><p>如果证书不在日志中，则我的浏览器将不接受它(或在将来停止接受它或其他什么)。</p><p>任何人都可以随时查看日志，以确定其中是否存在恶意证书。</p><p>因此，如果荷兰CA签署了一个邪恶的mail.google.com证书，他们要么必须将其放入公共日志(Google会发现他们的邪恶方式)，要么将其从公共日志中删除(浏览器会拒绝它)。</p><p>好吧!。我们已经下载了一个SSL证书，并对其进行了剖析，了解了一些有关它的知识。希望你们中的一些人已经学到了一些东西！</p><p>为您的Web服务器上的SSL证书和SSL配置选择正确的设置令人困惑。据我了解，大约有30亿个设置。这是一个SSL实验室对mail.google.com的结果示例，页面上有所有像OLD_TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256这样的东西(真的，这是真的)。我很高兴有像SSL Labs这样的工具来帮助人类理解所有这些。</p><p>有人告诉我，如果您不确定要做什么，https://cipherli.st/是一种选择安全SSL配置的方法。我不知道它是好是坏。</p><p>还有，让我们加密真的很酷！他们为您的站点提供证书并使其安全，您甚至不需要了解证书在内部是如何工作的！而且是免费的。</p><div class="text-break sotry_link"><a target="_blank" href="https://jvns.ca/blog/2017/01/31/whats-tls/">https://jvns.ca/blog/2017/01/31/whats-tls/</a></div><div class="story_tags"><button type="button" class="btn btn-light my_tag"><a href="/tag/ssl/">#ssl</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/证书/">#证书</a></button></div></div></div><div class="col-lg-4 col-0"><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>