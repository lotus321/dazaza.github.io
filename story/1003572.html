<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>FMT--现代格式库</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">FMT--现代格式库</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-25 06:25:35</div><div class="story_img_container"><img src="http://img.diglog.com/img/2020/5/87e0db1ab08bef61850701bfb5dea5c0.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></div><div class="page_narrow text-break page_content"><p>{fmt}是C++的开放源码格式库，可以安全快速地替代printf和iostream。</p><p>高性能：比printf和ostream的通用标准库实现更快。请参阅C++中的速度测试和快速整数到字符串转换。</p><p>源代码(最低配置仅由core.h、format.h和format-inl.h三个头文件组成)和编译代码都很小。请参见编译时间和代码膨胀。</p><p>安全性：该库是完全类型安全的，可以在编译时报告格式字符串中的错误，自动内存管理可防止缓冲区溢出错误。</p><p>fmt：：print(&#34；Hello，{}！&#34；，&#34；world&#34；)；//类似Python的格式字符串语法fmt：：printf(&#34；Hello，%s！&#34；，&#34；world&#34；)；//printf格式字符串语法。</p><p>std：：string s=fmt：：format(&#34；I&#39；D宁愿是{1}而不是{0}。(&#34；，&#34；Right&#34；，&#34；)；//s=&#34；I&#39；I&#34；I&/s=#34；I&#39；我宁愿快乐也不愿正确。</p><p>$c++-iinclude-std=c++14 test.cc.test.cc：4：17：注意：在函数模板专门化实例化&#39；fmt：：v5：：format&lt；S，int&gt；&#39；请求的herestd：：string s=format(fmt_string(&#34；{2}&#34；)，42)；^include/fmt/core.h：778：19：注意：无。^INCLUDE/fmt/Format.h：2226：16：注意：在调用&#39；&amp；checker.context_-&gt；on_error(&amp；&#34；argument索引时超出范围&#34；[0])&#39；CONTEXT_.ON_ERROR(&#34；参数索引超出范围&#34；)；^。</p><p>fmt：：memory_buffer buf；format_to(buf，&#34；{}&#34；，42)；//替换itoa(42，buffer，10)format_to(buf，&#34；{：x}&#34；，42)；//替换itoa(42，buffer，16)//使用to_string(Buf)或buf.data()访问字符串</p><p>#include&#34；fmt/format.h&#34；struct date{int年，月，日；}；模板&lt；&gt；struct fmt：：Formatter&lt；date&gt；{stexpr auto parse(format_parse_context&amp；ctx){返回ctx。Begin()；}Template&lt；TypeName FormatContext&gt；Auto Format(Const Date&amp；d，FormatContext&amp；CTX){Return Format_To(CTX.。out()，&#34；{}-{}-{}&#34；，D.年，D.月，D.日)；}}；std：：string s=fmt：：format(&#34；日期为{}&#34；日期{2012，12，9})；//s==&#34；日期为2012-12-9&#34；</p><p>//打印格式化的错误消息。void vreport_error(const char*format，fmt：：format_args args){fmt：：print(&#34；error：&#34；)；fmt：：vprint(format，args)；}模板&lt；typeName.。参数&&gt;void REPORT_ERROR(常量字符*格式，常量参数(&A；).。args){vreport_error(format，fmt：：make_format_args(args.))；}report_error(&#34；找不到文件：{}&#34；，路径)；</p><p>请注意，与完全参数化的版本相比，vreport_error不在参数类型上参数化，这可以缩短编译时间并减少代码大小。</p><p>以上结果是通过使用clang++-O3-DSPEED_TEST-DHAVE_FORMAT在macOS10.14.6上构建tinyformat_test.cpp并取三次运行中的最佳结果生成的。在测试中，格式字符串&#34；%0.10f：%04d：%+g：%s：%p：%c：%%\n&#34；或等效字符串填充了2,000,000次，并将输出发送到/dev/null；。有关详细信息，请参阅源代码。</p><p>{fmt}在浮点格式化(dtoa-Benchmark)上比std：：ostrg stream和spintf快10倍，与双重转换一样快：</p><p>脚本bloat-test.pyfrom格式基准测试重要项目的编译时间和代码膨胀。它生成100个翻译单元，并在每个单元中使用printf()或它的交替使用5次来模拟中型项目。生成的可执行文件大小和编译时间(Apple LLVM版本8.1.0(clang-802.0.42)、MacOS Sierra，三选一)如下表所示。</p><p>如您所见，就产生的二进制代码大小而言，{fmt}的开销比iostream少60%，与printf非常接近。Boost Format和Folly Format的管理费用最大。</p><p>printf+string与printf相同，但使用额外的&lt；string&gt；include来测量后者的开销。</p><p>libc、lib(Std)c++和libfmt都链接为共享库，仅用于比较格式化函数开销。Boost格式是仅限标题的库，因此它不提供任何链接选项。</p><p>有关如何构建库和运行单元测试的说明，请参阅构建库。</p><p>基准位于单独的存储库中，即格式基准，因此要运行基准，您首先需要克隆此存储库并使用CMake生成Makefile：</p><p>Scylla：与Cassandra兼容的NoSQL数据存储，可以在一台服务器上每秒处理100万个事务。</p><p>如果您知道有其他使用此库的项目，请通过电子邮件或提交问题的方式让我知道。</p><p>完成这项任务的方法有很多，从标准的printf函数系列和iostream到Boost Format和FastFormatlibrary，不一而足。创建一个新库的原因是，我发现的每个现有解决方案要么都存在严重问题，要么没有提供我需要的所有功能。</p><p>printf的好处是，作为C标准库的一部分，它相当快，而且很容易获得。主要缺点是它不支持用户定义的类型。printf也存在安全问题，尽管使用__ATTRIBUTE__((format(printf，.))可以稍微缓解这些问题。在GCC中，有一个POSIX扩展，它将i18nto printf所需的位置参数添加到printf中，但它不是C99的一部分，在某些平台上可能不可用。</p><p>“快速格式”(FastFormat)一书的作者马修·威尔逊(Matthew Wilson)称这是雪佛龙地狱。IOStreamsdon故意不支持位置参数。</p><p>好的方面是，iostream支持用户定义的类型并且是安全的，尽管错误处理很笨拙。</p><p>这是一个功能非常强大的库，既支持类似printf的格式化字符串，也支持位置参数。它的主要缺点是性能。根据各种基准测试，它比这里考虑的其他方法要慢得多。BoostFormat还存在构建时间过长和严重的代码膨胀问题(请参阅基准测试)。</p><p>这是一个有趣的库，它快速、安全并且有位置参数。然而，它有很大的限制，引用它的作者的话：</p><p>它也相当大，并且有一个很重的依赖，STLSoft，这对于在一些项目中使用它可能是有限制的。</p><p>这并不是一个真正的格式库，但为了完整起见，我决定将其包含在这里。作为iostream，它存在逐字混合文本和参数的问题。该库相当快，但是在整数格式上比在Karma自己的基准上的fmt：：format_int要慢，请参阅C++中的快速整数到字符串转换。</p><p>模板类型名称(&lt；TypeName).。参数自动捕获(常量参数(&A；).。args){return std：：make_tuple(args.)；}AUTO PRINT_MESSAGE=[](const auto&amp；.。args){fmt：：print(args.)；}；//捕获和存储参数：auto args=catch(&#34；{}{}&#34；，42，&#34；foo&#34；)；//执行格式化：std：：Apply(print_message，args)；</p><p>文档中的格式字符串语法部分基于适用于当前库的Python String module ocumentation中的格式字符串语法部分。出于这个原因，本文档是根据Python Software Foundation许可证分发的，可在doc/python-License se.tx.tx.中找到。它仅适用于您分发FMT文档的情况。</p><p>{fmt}库由Victor Zverovich(Vitaut)和Jonathan Müller(Foonathan)维护，其中有许多其他人的贡献。请参阅贡献者和发布者了解其中一些名称。如果您的贡献没有被正确列出或提及，请让我们知道，我们会纠正您的贡献。(注：{fmt}库是由Victor Zverovich(Vitaut)和Jonathan Müller(Foonathan)维护的。请参阅贡献者和发布者)。</p><p>本自述文件的基准测试部分和性能测试来自Chris Foster编写的优秀tinyformat库。Boost格式库是公认的，因为它对tinyformat产生了一些影响。实现中使用的一些想法借鉴了Loki SafeFormat和Clang中的Diagnostic API。Format字符串语法和文档基于Python的str.format。感谢Doug Turnbull对类型安全API的设计提出的宝贵意见和贡献，以及Gregory Chaajkowski实现二进制格式化的贡献。感谢Ruslan Baratov对整数格式化算法的全面比较和有关性能的有用评论，感谢Boris Kaul为C++计数数字基准所做的贡献。感谢CarterLi对代码做出的各种改进。</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/fmtlib/fmt">https://github.com/fmtlib/fmt</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/现代/">#现代</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/modern/">#modern</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/format/">#format</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1002221.html"><img src="http://img.diglog.com/img/2020/5/thumb_92dec1ba97b54dc605a63db7acf955da.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002221.html">捍卫现代网络</a></div><span class="my_story_list_date">2020-5-15 21:10</span></div><div class="col-sm"><div><a target="_blank" href="/story/1001462.html"><img src="http://img.diglog.com/img/2020/5/thumb_6aefab395ca8b6e555804ba4e4ee109e.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1001462.html">现代浏览器中外观逼真的90年代字体</a></div><span class="my_story_list_date">2020-5-10 9:15</span></div><div class="col-sm"><div><a target="_blank" href="/story/1001174.html"><img src="http://img.diglog.com/img/2020/5/thumb_5a3501e67c82ebc6c877c29e6c9bd9d2.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1001174.html">现代人的眼睛开始进行第三阶段冠状病毒疫苗试验</a></div><span class="my_story_list_date">2020-5-8 5:27</span></div><div class="col-sm"><div><a target="_blank" href="/story/1000506.html"><img src="http://img.diglog.com/img/2020/5/thumb_e2f204d4ad5a2c154ac84245f9dcc8be.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1000506.html">带有现代边界的盘古大陆地图</a></div><span class="my_story_list_date">2020-5-4 0:25</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>