<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>F#5和F#工具更新</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">F#5和F#工具更新</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-21 03:10:15</div><div class="story_img_container"><img src="http://img.diglog.com/img/2020/5/4d8f7fb3aa7a46aaaf49c2063aca8438.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></div><div class="page_narrow text-break page_content"><p>今天我们很兴奋地宣布F#5的一些更新！从F#5预览版1开始，我们发布了很多预览版功能，自那次发布以来，它们一直在稳定下来。今天，我们很高兴地宣布对F#5做了一些小的补充，并讨论了我们一直在做的一些相当酷的性能工作。</p><p>如果您在Windows上使用Visual Studio，则需要同时安装.NET5预览版SDK和Visual Studio预览版。</p><p>您可以通过.NET5预览版SDK，或者通过.NET和Jupyter笔记本支持来使用F#5预览版。</p><p>如果你使用的是.NET5预览版SDK，可以查看一个样本库，该库展示了你可以用F#5做的一些事情。你可以尝试那里的每一个特性，而不是从头开始。</p><p>如果您更愿意在自己的项目中使用F#5，则需要添加一个值为PREVIEW的LangVersion属性。它应该看起来像这样：</p><p>或者，如果您使用的是Jupyter笔记本，并且想要更具交互性的体验，请查看一个显示相同功能、但输出更具交互性的示例笔记本。</p><p>此版本仅引入了一个新的语言功能。然而，到目前为止，我们发布的其他功能已经进一步稳定。在我们调用F#5功能完成之前，我们正在考虑更多的功能，当它们可用时，我们会发布更新。</p><p>现在，您可以通过实现接口的标准方法在F#中使用这些代码：</p><p>这将使F#开发人员安全地利用使用此功能的C#编写的包或其他组件，并期望调用者支持此功能。</p><p>不过，我们目前不支持生成默认实现。如果您想这样做，请在F#语言建议库中搜索或提交建议。</p><p>我们关注提高F#编译器和工具的性能已经有一段时间了，每次发布我们都会看到渐进式的进步。虽然性能总是可以提高的，但到目前为止，我们对自己的进步相当满意！</p><p>要演示不同之处，请查看FSharpPlus存储库的这个分支，这是一个代码库，它使用某些高级功能给F#编译器带来了极大的压力。您可以修改global.json文件以在您的计算机上指定.NET SDK。在本例中，它指定了.NET 5预览和Visual Studio 2019更新16.5发布的.NET Core 3.1 SDK。如果您的计算机上有这些SDK，您可以自己测试。</p><p>这是一个相当大的进步！然而，并不是所有挂钟时间的改善都归功于F#。NET工具链中的一切也都得到了改进。</p><p>为了更深入地了解这一点，我执行了与前面相同的步骤，但运行了以下命令来生成MSBuild性能摘要：</p><p>通过一次运行，我发现在FSC任务(调用F#编译器)中花费的CPU时间有以下不同：</p><p>(注意：因为MSBuild在可能的情况下是并行运行的，所以CPU时间比挂钟时间长得多。)</p><p>在构建相同的代码库时，F#编译器花费的时间减少了16%！在编译核心项目FSharpPlus.fsproj时，我个人看到编译时间提高了35%。具体的改进可能会因机器和构建的不同而有所不同，特别是如果构建过程当时在您的计算机上没有最高的优先级。不管这些注意事项如何，在构建此项目时，构建时间总是会得到改善。这一点在其他几个经过测试的OSS项目中也是如此。</p><p>如果你对完整的分类感到好奇，我把这两个日志都上传到了GitHub的要点中。</p><p>产生这样的结果是由很多因素造成的，其中之一是改进了编译期间读取和处理元数据的方式。</p><p>此外，我们令人惊叹的OSS贡献者不断发现一些小的低效，他们一直在努力帮助我们随着时间的推移而改进。这是我们非常感激的持续努力。</p><p>在这个版本中，编译器并不是唯一变得更快的东西。在整个Visual Studio 2019生命周期中，我们一直致力于提高Visual Studio Tools for F#的性能和可靠性，此版本也不例外！从Visual Studio2019更新16.6开始，查找所有引用和重命名等功能在扫描大型代码库时应该运行得更快，显示结果的速度也会更快。</p><p>为了演示这一点，我上传了两个视频，以FAKE(一个很大的F#OSS代码库)展示了在字符串类型上查找所有引用的操作。这是一个极端情况，并不代表查找所有引用的正常用法，但它有助于演示在少数情况下可能发生的情况，即您确实需要在大型代码库中查找对非常常见类型的引用。</p><p>第一个视频是Visual Studio 2019更新16.5(点击YouTube链接获取更高清晰度)：</p><p>请注意，开始填写结果所需的时间要长得多，整个过程大约需要1分11秒才能完成。完成查找所有引用后，Visual Studio的内存使用量高达约1.75 GB：</p><p>第二个是最新的Visual Studio 2019更新16.6(点击YouTube链接获取更高清晰度)：</p><p>如您所见，结果开始显示的速度要快得多，整个过程花了大约43秒才完成！运行完“查找所有引用”后，Visual Studio的内存使用量高达约1.2 GB：</p><p>负责在用户代码中查找符号并将其返回给请求与给定输入匹配的符号的调用者的核心组件。</p><p>Visual Studio组件，该组件在“查找所有引用”窗口中显示找到的符号，并根据列表中显示的源代码为文本着色。</p><p>除了Find All References这样的功能更快之外，用于运行它的内存量也显著减少，这在您使用大型代码库时非常重要。</p><p>就像编译器的性能一样，我们令人惊叹的OSS贡献者不断地在工具调用的代码中发现一些小的低效，他们已经随着时间的推移进行了清理和改进。我们感谢他们的贡献，并期待着有更多的机会与他们一起改进F#工具。</p><p>我们已经为F#5计划了更多令人惊叹的东西，我们迫不及待地想在它们完成后向你展示。在此之前，我们将重点关注几件事：</p><p>使Jupyter和Visual Studio Code Notebook中的F#成为数据科学和分析工作的最佳语言(有关这方面的更多信息，请参阅未来的更新！)</p><p>继续合并OSS贡献，并争取尽快将它们包含到版本中。</p><p>如果您想了解更详细的内容，可以查看F#开发资源库。我们现在通过每3周一期的GitHub问题来跟踪我们关注的工作，我们鼓励你们所有人都为清单上的事情提供意见，并让我们知道你们的想法。</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://devblogs.microsoft.com/dotnet/f-5-update-for-net-5-preview-4/">https://devblogs.microsoft.com/dotnet/f-5-update-for-net-5-preview-4/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/tools/">#tools</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/功能/">#功能</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>