<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>动态链接(相对于静态链接)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">动态链接(相对于静态链接)</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-06-27 01:59:57</div><div class="page_narrow text-break page_content"><p>调查结果：绝对不是ex.c#include&lt；stdio.h&gt；#include&lt；stdlib.h&gt；#include&lt；time.h&gt；#include&lt；unistd.h&gt；int main(int argc，char*argv[]){struct timespec ts；lock_gettime(lock_monotonic，&amp；ts)；fprintf(stdout，&34；%)。if(argc==1){char*args[]={&#34；&#34；，&#34；，null}；execvp(argv[0]，args)；}否则{fprintf(stdout，&#34；\n&#34；)；}返回0；}。</p><p>test.sh我的结果$musl-GCC-o ex ex.c$./test.sh|awk&#39；BEGIN{SUM=0}{SUM+=$2-$1}END{PRINT SUM/NR}&#39；137263$MUSL-GCC-STATIC-O EX EX.c$./test.sh|AWK&#39；BEGIN{SUM=0}{SUM+=$2-$1}END{PRINT SUM/NR}&#39；64048。</p><p>研究结果：不是真的平均，动态链接的可执行文件只使用其依赖项中提供的符号的4.6%。一个好的链接器可以删除不使用的符号。nsyms.go程序包mainimport(&#34；bufio&#34；&#34；fmt&#34；&#34；os&#34；os/exec&#34；&#34；path/filepath&#34；；string&#34；)func main(){ldd：=exec.Command(&#34；ldd&#34；，os.Args[1])rc，err：=ldd.StdoutProtocol()if err！=nil{Panic(Err)}ldd.Start()var libpath[]string scan：=bufio.NewScanner(Rc)for scan.Scan(){line：=scan.Text()[1：]/*\t*/sp：=string.Split(line，&#34；&#34；)var lib string。){lib=sp[2]}Else{lib=sp[0]}if！filepath.IsAbs(Lib){lib=&#34；/usr/lib/&#34；+lib}libpath=append(libpath，lib)}ldd.Wait()rc.Close()syms：=make(map[string]interface{})for_，path：=range libpath{objdump：=exec.Command(&。，path)rc，err：=objdump.StdoutTube()if err！=nil{Panic(Err)}objdump.Start()scan：=bufio.NewScanner(RC)for i：=0；scan.Scan()；i++{if i&lt；4{Continue}line：=scan.Text()sp：=string s.Split(line，&#34；&#34；)if len(Sp)&lt。5{Continue}sym：=sp[len(Sp)-1]syms[sym]=nil}objdump p.Wait()rc.Close()}objdump：=exec.Command(&#34；objdump&#34；，&#34；-R&#34；，os.Args[1])rc，err=objdump.StdoutTube()if err！=nil{Panic(Err)}objdump.Start()Used：=make(map[string]interface{})scan=bufio.NewScanner(Rc)for i：=0；scan.Scan()；i++{if i&lt；5{Continue}sp：=string。Split(scan.Text()，&#34；&#34；)if len(Sp)&lt；3{Continue}sym：=sp[len(Sp)-1]Used[sym]=nil}objdump.Wait()rc.Close()if len(Syms)！=0&amp；&amp；len(已用)！=0&amp；&amp；len(已用=len(系统){fmt.Printf(&#34；%50s\t%d\t%d\t%f\n&#34；，os.args[1]，len(Syms)，len(已用)，float64(len(已用))/float64(len(Syms))}}。</p><p>用法$find/usr/bin-type f-Executable-print|xargs-n1./nsyms&gt；Results.txt$awk&#39；{n+=$4}end{print n/NR}&#39；&lt；Results.txt。</p><p>我的结果是，静态链接的库中的安全漏洞是否会导致较大或无法管理的更新？</p><p>调查结果：实际上并不包括libc，在2019年影响我系统上100多个二进制文件的库中，只有dbus、GNUTLS、开罗、libssh2和curl具有严重或严重漏洞。265个二进制受到其余的影响。2019年，升级我系统上所有受CVE影响的二进制文件的总下载成本为3.8 GiB。如果去掉glibc，这将减少到1.0 GiB。对于给定的静态链接二进制文件，是否会在上次构建日期之后引入这些漏洞也是未知的；如果是这样，则该二进制文件将不需要更新。许多漏洞也被限制在特定的代码路径或用例中，没有在依赖项中调用该代码路径的二进制文件不会受到影响。在漏洞之后确定此信息的过程可以自动进行。对于mbox.item()中的m，Arch-security提取tcves.py import email.utilsimport mailboximport reimport shleximport timepacman_re=re.build(r&#39；pacman-syu.*&#39；)everity_re=re.build(r&#39；严重性：(.*)&#39；)mbox=mailbox.mbox(&#34；arch-security.mbox&#34；)：m=m[。]对于m.walk()中的部分：if part.is_multipart()：如果content_type==&#39；文本/纯文本&#39；则继续content_type=part.get_content_type()[charset]=part.get_charsets(&#34；utf-8&#34；)。用法：body=part.get_payload(decode=True).decode(Charset)Break pkgs=pacman_re.findall(Body)Severity=Severity_re.findall(Body)Date=email.utils.parsedate(Date)if len(Pkgs)==0或Date=None：Continue if Date[0]&lt；=2018或Date[0]&gt；2019参数：Continue Severity=Severity[0]args=shlex.plit(。</p><p>$python3 Extractcves.py|grep Critical&gt；cves.txt$xargs Pacman-ql&lt；cves.txt|grep\\.so|awk&#39；{print$1}&#39；|ort-u&gt；affected.txt#手动删除Firefox、Thunderbird等软件包；写入剩余部分。txt$xargs Pacman-ql&lt；剩余部分。ldd.txt$./scope e.sh&lt；libs.txt</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://drewdevault.com/dynlib.html">https://drewdevault.com/dynlib.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/链接/">#链接</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/linking/">#linking</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1005266.html"><img src="http://img.diglog.com/img/2020/6/thumb_9e1e686ad00681bf7d6d47821de5fb34.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1005266.html">JavaScript开发人员的有用链接</a></div><span class="my_story_list_date">2020-6-5 14:24</span></div><div class="col-sm"><div><a target="_blank" href="/story/1004435.html"><img src="http://img.diglog.com/img/2020/5/thumb_5b90b66ea1caa1976d9e66864b08de86.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1004435.html">如何借鉴1940年代的经验设计一台好的烤面包机[视频]</a></div><span class="my_story_list_date">2020-5-31 3:57</span></div><div class="col-sm"><div><a target="_blank" href="/story/1004211.html"><img src="http://img.diglog.com/img/2020/5/thumb_e0663f9a568cb9c2d47dadd61d6cf53d.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1004211.html">“花园与溪流：技术田园”</a></div><span class="my_story_list_date">2020-5-29 15:54</span></div><div class="col-sm"><div><a target="_blank" href="/story/technology_web2_141308.html"><img src="http://img.diglog.com/img/2009/4/thumb_58f8a33e6a8348c389cbcc4c3e62f19c.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/technology_web2_141308.html">长话短链：通过链接分享文字、图片、代码等</a></div><span class="my_story_list_date">2009-4-20 6:44</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>