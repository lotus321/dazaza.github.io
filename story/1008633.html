<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>超声联网</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">超声联网</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-06-28 02:30:47</div><div class="story_img_container"><img src="http://img.diglog.com/img/2020/6/62e90dae2e247a5f39868b656df25751.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></div><div class="page_narrow text-break page_content"><p>通过使用GNuradio、麦克风和扬声器，我们提出了一种简单易用的跨超声波频率联网的实现方案。这允许您在音频链路上使用TCP/IP、UDP。</p><p>为了学习本教程，我们建议您使用GNuradio的LiveDVD版本(这基本上是一个Ubuntu发行版，已经安装了gnuradio)。这很容易从http://gnuradio.org/redmine/news/31.下载。首先，您需要将我们为GNuradio制作的补丁下载到U盘。您可以从https://github.com/anfractuosity/ultrasonicnetworking/archive/master.zip.下载该修补程序。为了使用补丁，您需要是root用户，所以输入‘sudo bash’，然后解压缩补丁，然后通过键入./setup.sh简单地运行setup.sh。为了支持可变长度的数据包，安装文件只需对GNuradio数据包编码器和解码器打补丁即可。</p><p>在运行setup.py之后，您可以初始化GNuradio，您需要以root身份运行它，所以也可以初始化sudo gnuradio-panion。然后在您的第一台笔记本电脑上加载.grc。</p><p>图1描绘了我们的图表，它使我们能够执行超声波联网。现在我们将描述图形如何在每个块中运行。左上角的第一个块是TUNTAP PDU，它允许您创建虚拟网络接口，我们可以通过该接口发送和接收数据包。</p><p>我们使用“PDU to tag Stream”块将从虚拟NIC接收的数据包转换为数据包编码器要处理的字节流。我们不能直接将标记流的输出附加到GFSK调制器，因为我们需要通过使用CRC添加校验和，还需要在数据包中添加前同步码和报头-这都是通过使用数据包编码器实现的。</p><p>前同步码本质上是一系列比特，为了将比特正确地对齐到正确的字节边界，可以在接收端检测到这些比特。分组编码器还在前同步码之后添加报头，该报头以字节为单位说明分组的长度。</p><p>GFSK调制器基本上执行频移键控调制。如图2所示，发送‘0’时调制信号的频率低于发送‘1’时的频率。我们发现，在使用笔记本电脑和麦克风的超声波联网环境中，FSK比PSK(相移键控)表现更好，PSK使用相移键控来传递比特，PSK是另一种调制技术。</p><p>GFSK块的一个非常重要的方面是采样/符号的数量。我们将其设置为值9。这意味着对于调制器接收的每个符号，都会生成9个样本。此数字越高，信号对噪声的恢复能力越强，但相应地波特率也越低(这实质上意味着发送数据包所需的时间越长)。波特率是指每秒传输的符号数。</p><p>然后，我们使用有理重采样器模块，以使信号更具弹性。每输入一个样本，它就会产生320个输出。</p><p>我们使用频率转换FIR滤波器来转换输入信号的频率。我们将信号按载波_tx移位，在本例中为-19 kHz。这就是说，信号正好在人的听觉范围之外。</p><p>因为我们在这一点上一直在处理复数信号，所以我们需要将复数输出转换为音频卡的浮点输出，我们通过使用“Complex to Real”块来实现这一点。</p><p>图形的底部描绘了程序的接收器部分。它本质上执行相同的功能，但情况相反。但是，在“Float to Complex”块之后还有两个额外的块。乘法常量模块允许您将麦克风的输出乘以固定的数字。这之后的模块是带通滤波器，只允许很小范围的频率通过解调器，这有助于消除麦克风输出中的大量噪声。</p><p>在图3中，您将看到有两个图表。上图描述了发送到发射机的输出，下图描述了从麦克风接收的输入(在对其应用了带通滤波器之后)。顶部还有一个滑块，允许您将来自麦克风的信号乘以特定值。当使用彼此距离较远的两台笔记本电脑时，此功能非常有用。</p><p>图4描述了我们使用的全双工信令。您可以看到，在本例中，我们以两种不同的频率传输，即19 kHz和18 kHz。这使得两台笔记本电脑可以同时发送自己的信号。</p><p>在GNuradio-Companion中，您需要转到Build&gt；Execute，以便执行图形。然后，您需要为它为您创建的Tap0接口分配IP地址。您需要通过终端执行此操作，例如，输入sudo ifconfig ap0 192.168.1.10。</p><p>您需要在第二台笔记本电脑B上执行相同的步骤，但这次加载b.grc并使用sudo ifconfig tap0 192.168.1.20。</p><p>我们发现最好手动为每台笔记本电脑分配ARP条目。为了分配ARP条目，在膝上型计算机A上，ARP-s 192.168.1.20&lt；膝上型计算机B的MAC地址为Tap0&&gt;-i Tap0。</p><p>您已在两台笔记本电脑上初始化的安装脚本将修补文件复制到GNuradio，并修改TCP选项，以便允许TCP/IP在非常滞后的网络中工作。</p><p>第一行是必需的，以便使客户端TCP连接在关闭之前保持打开的时间超过默认的20秒。</p><p>为了测试网络是否正常工作，我们建议使用Netcat。要测试TCP/IP连通性，请在笔记本电脑A上使用netcat-vv-l 10000，并使用netcat-vv 192.168.1.10 10000从笔记本电脑B连接到它。因为我们使用的是详细选项，所以当与笔记本电脑A建立连接时，Netcat会通知您，然后您可以从任一笔记本电脑向另一台笔记本电脑发送文本。</p><p>由于GNuradio提供的分组编码器和解码器只处理固定数量的数据，因此需要对其进行修改以支持流标签的读取。“PDU到标记流”用它们的大小标记来自TAP接口的数据包。数据包编码器/解码器无法正常处理这些标签，因此我们更改了数据包编码器，以读取这些标签，并从TAP0帧生成适当大小的数据包。然后，分组解码器将分组解封，并用其大小标记结果数据。</p><p>为了让您了解所涉及的延迟，请单击下图，其中显示了Wireshark屏幕截图，其中显示了TCP/IP连接的服务器端。你会看到它很慢！</p><p>如果有人对GNuradio补丁有任何改进建议，我将不胜感激(补丁本身很快就完成了)。</p><p>下面的视频来自我之前做的一次实验，目的是简单地测试我们是否可以以23 kHz的频率发送数据。</p><p>Minimodem看起来是一个很棒的程序，但据我所知，它只支持FSK。我热衷于尝试不同的调制方案，GNuradio提供了许多不同的调制方案；我最初尝试使用PSK进行设置。</p><p>这也为我介绍了一些用于软件定义无线电的技术是如何工作的。</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.anfractuosity.com/projects/ultrasound-networking/">https://www.anfractuosity.com/projects/ultrasound-networking/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/超声/">#超声</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>