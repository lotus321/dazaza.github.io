<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>从Node到Deno</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">从Node到Deno</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-17 23:49:34</div><div class="story_img_container"><img src="http://img.diglog.com/img/2020/5/c8ce40af901c64c85bdf410cc6032ca1.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></div><div class="page_narrow text-break page_content"><p>上周我发表了一篇关于Deno的文章，以及如何使用Deno和Preact创建聊天应用程序。从那时起，出现了许多疑问。他们中的大多数都是关于如何做我们在Node中做过的相同的事情，但是是关于新的Deno生态系统。</p><p>我试着收集了Node中一些最常用的主题，并寻找它们与Deno的替代方案。首先，我想说明一下，我们可以使用许多当前的Node.js模块。没有必要为所有事情寻找替代方案，因为许多模块都是可重用的。您可以访问pika.dev来查找要在Deno中使用的模块。也就是说，让我们从下面的清单开始吧：</p><p>有了Node.js，我们可以使用Electron创建桌面应用程序。电子使用Chromium作为界面来运行Web环境。但是，我们能把电子和德诺一起用吗？还有其他选择吗？</p><p>嗯，现在电子还远远不能在德诺的统治下被处决。我们必须寻找替代方案。因为Deno是用Rust制作的，所以我们可以使用web-view rust绑定在Deno中运行Destkop应用程序。</p><p>这样，我们就可以使用原生操作系统Webview来运行任意多个Webview。</p><p>从&#34；https://deno.land/x/webview/mod.ts&#34；；const contentType=&#39；text/html&#39；const sharedOptions={Width：400，Height：200，Resizable：TRUE，DEBUG：TRUE，NETWORM：FALSE，}；导入{Webview}；const webview 1=new Webview({title：&#34；Multiple Deno_Webview Example&#34；，url：`data：${contenttype}，&lt；html&gt；&lt；body&gt；&lt；h1&gt；1&lt；/h1&gt；&lt；/body&gt；&lt；/html&gt；`，.。sharedOptions，})；const webview2=new WebView({title：&#34；Multiple Deno_webview Example&#34；，url：`data：${contentType}，&lt；html&gt；&lt；body&gt；&lt；h1&gt；2&lt；/h1&gt；&lt；/body&gt；&lt；/html&gt；`，.。共享选项，})；等待承诺。全部([webview1.。run()，webview2。run()])；</p><p>Foreve和PM2是用于确保给定脚本作为守护进程连续运行的CLI工具。与Forever不同的是，PM2更完整，并且还充当负载均衡器。两者在Node中都非常有用，但是我们可以在Deno中使用它们吗？</p><p>永远仅用于节点，因此使用它是不可行的。另一方面，使用PM2，我们可以运行非节点脚本，因此我们仍然可以将其用于Deno。</p><p>Express和Koa是最著名的Node框架。它们以其健壮的路由系统和HTTP助手(重定向、缓存等)而闻名。我们可以在德诺使用它们吗？答案不是..。但也有一些替代方案。</p><p>Deno自己的STD库已经涵盖了Express或Koa提供的许多需求。https://deno.land/std/http/.。</p><p>从&#34；https://deno.land/std/http/server.ts&#34；导入{getCookie}；从&#34；https://deno.land/std/http/cookie.ts&#34；；let Request=new ServerRequest()；请求导入{serverRequest}。Headers=新的Header()；请求。标题。设置(&#34；Cookie&#34；，&#34；Full=of；Tasty=巧克力&#34；)；const cookies=getCookies(Request)；控制台。日志(&#34；cookies：&#34；，cookies)；</p><p>然而，申报路线的方式并不是很有吸引力。因此，让我们来看看更多的替代方案。</p><p>从&#34；https://deno.land/x/oak/mod.ts&#34；；const app=new Application()；app导入{应用程序，}。使用((Ctx)=&gt；{ctx.。回应。Body=&#34；Hello World！&#34；；})；等待APP。监听({port：8000})；</p><p>从&#34；https://deno.land/x/abc/mod.ts&#34；；const app=new Application()；app导入{Application}。静态(&#34；/static&34；，&#34；资产&#34；)；应用程序。GET(&#34；/hello&#34；，(C)=&gt；&#34；Hello！&#34；)。启动({port：8080})；</p><p>将*作为Exp从&#34；https://raw.githubusercontent.com/NMathar/deno-express/master/mod.ts&#34；；const port=3000；const app=new exp导入。app()；app。使用(例如。static_(&#34；./public&#34；))；应用。使用(例如。bodyParser。json())；app.。get(&#34；/api/todos&#34；，async(req，res)=&gt；{等待res.。json([{name：&#34；买点牛奶&#34；}])；})；const server=等待APP。监听(端口)；控制台。log(`app侦听端口${server.。port}`)；</p><p>MongoDB是一个具有巨大伸缩性和灵活性的文档数据库。在JavaScript生态系统中已经被广泛使用，有许多像Mean或MERN这样的堆栈使用它。它很受欢迎。</p><p>所以，是的，我们可以将MongoDB与Deno一起使用。为此，我们可以使用此驱动程序：https://github.com/manyuanrong/deno_mongo.。</p><p>从&#34；https://deno.land/x/mongo@v0.6.0/mod.ts&#34；；//初始化插件等待init()；const client=new mongoClient()；客户端导入{init，mongoClient}。connectWithUri(&#34；mongodb：//localhost：27017&#34；)；const db=client。数据库(&#34；test&#34；)；常量用户=db.。Collection(&#34；Users&#34；)；//INSERT常量INSERTID=等待用户。insert One({username：&#34；user1&#34；，password：&#34；pass1&#34；})；//findOne常量user1=等待用户。findOne({_id：insert tId})；//查找常量用户=等待用户。find({username：{$ne：null}})；//聚合常量文档=等待用户。Aggregation([{$Match：{username：&#34；Many&#34；}}，{$group：{_id：&#34；$username&#34；，总计：{$sum：1}])；//updateOne const{matchedCount，modfiedCount，upsertedId}=等待用户。updateOne(username：{$ne：null}，{$set：{username：&#34；username&#34；})；//delete eOne常量delete eCount=等待用户。delete One({_id：insert tId})；</p><p>从&#34；https://deno.land/x/postgres/mod.ts&#34；；const client=new client({User：&#34；user&#34；，database：&#34；test&#34；，hostname：&#34；localhost&#34；，port：5432})；导入{Client}；等待客户端。connect()；const result=等待客户端。查询(&#34；SELECT*FROM People；&#34；)；控制台。日志(结果。行)；等待客户端。end()；</p><p>从&#34；https://deno.land/x/mysql/mod.ts&#34；；const client=导入{Client}等待新客户端()。connect({hostname：&#34；127.0.0.1&#34；，username：&#34；root&#34；，db：&#34；dbname&#34；，poolSize：3，//连接限制密码：&#34；password&#34；，})；让result=等待客户端。EXECUTE(`INSERT INTO USERS(Name)VALUES(？)`，[&#34；aralroca&#34；，])；console。log(Result)；//{affectedRows：1，lastInsertId：1}。</p><p>从&#34；https://denopkg.com/keroxp/deno-redis/mod.ts&#34；；const redis=等待连接({主机名：&#34；127.0.0.1&#34；，端口：6379})导入{CONNECT}；const ok=等待redis。set(&#34；Example&#34；，&#34；This is a Example&#34；)；Const Example=Await redis。GET(&#34；示例&#34；)；</p><p>Nodemon在开发环境中用于监视文件中的任何更改，自动重启服务器。这使得节点开发更加愉快，无需手动停止和重新启动服务器即可看到应用的更改。可以在德诺使用吗？</p><p>在Node.js生态系统中，测试者有很多选择。然而，没有一种官方方法可以测试Node.js代码。</p><p>Deno的优点之一是，我们可以将ESmodule与TypeScript一起使用，而不需要webpack、Parcel或Rollup等捆绑器。</p><p>然而，您可能想知道，如果给定一棵文件树，我们是否可以将所有内容都放在一个文件中，以便在Web上运行它。</p><p>嗯，是的，这是可能的。我们可以使用Deno的CLI来做到这一点。因此，不需要第三方捆绑器。</p><p>在过去的几年里，更漂亮已经在JavaScript生态系统中广为人知，因为有了它，您就不必担心格式化文件了。</p><p>事实是，它仍然可以在Deno上使用，但它失去了意义，因为Deno有自己的格式化程序。</p><p>使用Deno时，Package.json将不复存在。我非常怀念的一件事是在Package.json中声明的脚本。</p><p>一个简单的解决方案是使用Makefile并使用make执行它。但是，如果您错过了NPM语法，可以为Deno提供一个NPM风格的脚本运行器：</p><p>NVM是用于管理多个活动节点版本的CLI，可根据您的项目轻松升级或降级版本。</p><p>近年来，NPX在执行NPM包时变得非常流行，而不必安装它们。现在，许多项目不会存在于NPM中，因为Deno是一个独立的生态系统。那么，我们如何才能执行DENO模块，而不必使用Deno Install https://url-of-module.ts？安装它们</p><p>与我们运行项目的方式相同，我们将模块的URL放入模块的URL中，而不是放入文件：</p><p>如您所见，我们不仅需要记住模块的名称，还要记住整个URL，这使得它的使用更加困难。另一方面，它提供了更大的灵活性，因为我们可以运行任何文件，而不仅仅是像npx这样在Package.json中指定为二进制文件的文件。</p><p>从海德/阿尔卑斯山-德诺出发：1.0.0号港口。WORKDIR/APP用户拒绝复制部门。运行deno cache dess.ts#缓存deps add。。运行Deno cache main.ts#main入口点。CMD[&#34；--Allow-Net&#34；，&#34；main.ts&#34；]。</p><p>要将Deno用作lambda，在Deno STD库中有一个模块。https://deno.land/x/lambda.。</p><p>从&#34；https://deno.land/x/lambda/mod.ts&#34；；导出异步函数处理程序(Event：APIGatewayProxyEvent，Context：Context)导入{APIGatewayProxyEvent，APIGatewayProxyResult，Context}：Promise&lt；APIGatewayProxyResult&gt；{Return{Body：`欢迎使用Deno${deno.。版本。Deno}🦕`，标题：{&#34；Content-Type&#34；：&#34；Text/HTML；Charset=utf8&#34；}，statusCode：200}；}。</p><p>我确信我忘记了一些Node主题和它们的Deno替代方案，如果我错过了什么您想让我解释的地方，请告诉我。我希望这篇文章能帮助你和德诺打破僵局。</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://dev.to/aralroca/from-node-to-deno-5gpn">https://dev.to/aralroca/from-node-to-deno-5gpn</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/node/">#node</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/deno/">#deno</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>