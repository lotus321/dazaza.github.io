<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>日志框架不是瓶颈，您的笔记本电脑会告诉您其他谎言</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">日志框架不是瓶颈，您的笔记本电脑会告诉您其他谎言</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-05-14 09:08:00</div><div class="page_narrow text-break page_content"><p>很容易想象大型的、令人印象深刻的服务器硬件比您可能带到咖啡馆的机器更快。事实是，服务器硬件是不同的，不一定更快。</p><p>机械同情界长期以来一直主张开发人员使用服务器硬件作为日常驱动程序。我过去常常担心，接受他们的建议意味着失去我习惯的许多桌面功能。就像声卡一样。最后，我听从了他们的建议，今年换成了多插槽Xeon ThinkStation。我保留了笔记本电脑，以供移动使用。</p><p>我的笔记本电脑的i7CPU的基本频率是2.8 GHz，涡轮增压(更多信息见下文)高达3.9 GHz。同时，我在Google Cloud上使用的至强处理器的基本频率为2.3 GHz。什么给予？</p><p>这个想法大概是这样的：消费者工作负载服务于一个人做的事情很少。服务器工作负载正在为许多用户提供服务。</p><p>在家玩视频游戏时，您需要主游戏循环的高时钟频率。</p><p>挂在旧的数据中心，同时为1000人呈现网页？这是一个不同的故事。对于服务器工作负载，为了在相同的热量/功率空间中“容纳”更多内核，放弃时钟频率通常是有意义的。</p><p>有很多例外，当你进入CPU数量更高的消费类机器时，时钟频率通常会下降，而且Xeon的范围也很广。你想怎么快就怎么快就能搞到Xeons。</p><p>您的笔记本电脑可能会告诉您，单线程工作负载的性能优于并行工作负载，而事实恰恰相反。</p><p>在生产中，您的笔记本电脑可能会告诉您性能瓶颈不是CPU，而是CPU。</p><p>大多数消费类机器都有一个单插槽，周围有RAM DIMM，访问RAM的任何部分都有大致相同的延迟。</p><p>服务器通常有许多CPU插座，每个RAM芯片都有一个“主”插座，也就是它所连接的特定插座。访问插座上“本地”的RAM速度很快，而访问另一个插座上的RAM则很慢。</p><p>默认情况下，mmap将在连接到执行系统调用的插槽的DIMM上为您提供内存。请参阅set_mempolicy(2)。</p><p>你的笔记本电脑会告诉你，一个程序在一个线程中分配内存，然后在另一个线程中使用它是很快的。</p><p>今天一台好的笔记本电脑都有一个大的NVMe固态硬盘插在它的小脑袋里。NVMe的尖叫速度很快，这正是你处理照片、视频或玩游戏等大文件时想要的。</p><p>平均而言，服务器有不同的需求。接受网络请求并进行数据库调用的Rails应用程序可能几乎不接触磁盘。文件服务器通常将文件缓存在缓冲池中，从RAM而不是磁盘为它们提供服务。</p><p>您在GCP上得到的默认磁盘，即区域永久磁盘，最多只能达到240MiB/s，这比您笔记本电脑上的NVMe磁盘慢一个数量级。</p><p>您的笔记本电脑会让您认为日志记录框架不是您的主要瓶颈。</p><p>Xeon CPU也有Turbo Boost，所以这不是消费者硬件和服务器硬件之间的严格区别，而是消费者和服务器工作负载的区别。</p><p>在具有并行负载的服务器上，Turbo Boost可能无法发挥作用。它旨在加速低并发工作负载，如您的游戏渲染循环。如果服务器上的所有内核都在工作，它就已经运行得很好、很热，不会为您提供Turbo Boost。</p><p>因此，您的单线程基准测试将获得甜美的5 GHz翘曲速度并投入生产吗？享受2.4 GHz的公园漫步。</p><p>多亏了Turbo Boost，您的笔记本电脑测试可能会看到真实世界中时钟速度的两倍。</p><p>如果您的主要开发环境是基于终端的，那么流行的选择是简单地在云VM上运行shell。</p><p>对我来说，我选择了一台双至强ThinkStation P720，我现在把它作为我的主要开发机器，每天我都会更多地了解我正在为其编写软件的硬件。</p></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://tech.davis-hansson.com/p/tower/">https://tech.davis-hansson.com/p/tower/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/电脑/">#电脑</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/笔记本电脑/">#笔记本电脑</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/framework/">#framework</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/app/">#app</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/病毒/">#病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/冠状病毒/">#冠状病毒</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>