[{"category": "", "categoryclass": "", "imagename": "9e510c6e23105b68f1aecd2161bc664b.png", "infoid": 1000408, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u6211\u4eec\u7684\u8d8b\u52bf\u89c2\u5bdf\u5bb6\u6ce8\u610f\u5230\u4e9a\u9a6c\u900a\u4e0a1TB\u56fa\u6001\u786c\u76d8\u7684\u4ef7\u683c\u5927\u5e45\u4e0b\u964d\u3002\u4f60\u73b0\u5728\u53ea\u9700\u82b197.99\u7f8e\u5143\u5c31\u53ef\u4ee5\u4e70\u5230\u8bc4\u7ea7\u6700\u9ad8\u7684\u9a71\u52a8\u5668\u4e4b\u4e00\u3002\n\u552e\u4ef797.99\u7f8e\u5143\u7684Silicon Power 1TB\u56fa\u6001\u786c\u76d83D NAND\u652f\u6301TRIM\u3001\u5783\u573e\u6536\u96c6\u6280\u672f\u3001RAID\u548cECC(\u9519\u8bef\u68c0\u67e5\u4e0e\u7ea0\u6b63)\uff0c\u4ee5\u63d0\u4f9b\u4f18\u5316\u7684\u6027\u80fd\u548c\u589e\u5f3a\u7684\u53ef\u9760\u6027\uff0c\u5148\u8fdb\u7684SLC\u7f13\u5b58\u6280\u672f\u53ef\u63d0\u9ad8\u6027\u80fd\u5e76\u5ef6\u957f\u4f7f\u7528\u5bff\u547d\u3002\n\u4f46\u8fd9\u5e76\u4e0d\u662f\u552f\u4e00\u4e00\u5bb6\u5927\u5e45\u4e0b\u964d\u7684\u4ea7\u54c1\uff0c\u5176\u4ed6\u5236\u9020\u5546\u90fd\u5728\u6548\u4eff\uff0c\u5927\u5e45\u964d\u4ef7\u3002\nAce A55\u91c7\u7528\u5148\u8fdb\u76843D NAND\u95ea\u5b58\uff0c\u6bd4\u914d\u59072D NAND\u95ea\u5b58\u7684\u4f20\u7edf\u56fa\u6001\u786c\u76d8\u5177\u6709\u66f4\u9ad8\u7684\u53ef\u9760\u6027\u548c\u66f4\u9ad8\u7684\u7535\u6e90\u6548\u7387\u3002A55\u63d0\u4f9b\u4e86\u66f4\u597d\u7684\u8010\u7528\u6027\u548c\u66f4\u957f\u7684\u7535\u6c60\u7eed\u822a\u65f6\u95f4\uff0c\u60a8\u53ef\u4ee5\u66f4\u957f\u65f6\u95f4\u5730\u5de5\u4f5c\uff0c\u800c\u65e0\u9700\u9891\u7e41\u7ed9\u7b14\u8bb0\u672c\u7535\u8111\u5145\u7535\u3002\nA55\u7531\u9ad8\u8d28\u91cf\u63a7\u5236\u5668\u548c\u539f\u88c5\u540c\u6b65NAND\u95ea\u5b58\u9a71\u52a8\uff0c\u53ef\u63d0\u4f9b\u4ee4\u4eba\u96be\u4ee5\u7f6e\u4fe1\u7684\u9ad8\u4f20\u8f93\u901f\u5ea6\uff0c\u4ece\u800c\u7f29\u77ed\u542f\u52a8\u65f6\u95f4\u3001\u5feb\u901f\u52a0\u8f7d\u5e94\u7528\u7a0b\u5e8f\u548c\u5feb\u901f\u5904\u7406\u6587\u4ef6\u3002\nA55\u7279\u522b\u5e94\u7528\u4e86\u201cSLC\u7f13\u5b58\u6280\u672f\u201d\uff0c\u5141\u8bb8\u6240\u6709\u6570\u636e\u9996\u5148\u5199\u5165SLC\u90e8\u5206\uff0c\u4ece\u800c\u5b9e\u73b0\u66f4\u9ad8\u7684\u5cf0\u503c\u5199\u5165\u6027\u80fd\u3002\u6b64\u5916\uff0c\u8be5\u6280\u672f\u53ef\u4ee5\u51cf\u5c11\u5199\u5165\u653e\u5927\uff0c\u4ece\u800c\u63d0\u4f9b\u66f4\u597d\u7684\u8010\u7528\u6027\u548c\u66f4\u957f\u7684\u56fa\u6001\u786c\u76d8\u5bff\u547d\u3002\nA55\u9644\u5e26\u514d\u8d39\u4e0b\u8f7d\u7684\u56fa\u6001\u786c\u76d8\u8fd0\u884c\u72b6\u51b5\u76d1\u63a7\u5de5\u5177-SP Toolbox\u8f6f\u4ef6\uff0c\u8be5\u5de5\u5177\u4e13\u4e3a\u60a8\u8bbe\u8ba1\uff0c\u53ef\u8f7b\u677e\u76d1\u63a7\u56fa\u6001\u786c\u76d8\u7684\u5f53\u524d\u8fd0\u884c\u72b6\u51b5\u3002\u8fd9\u6837\uff0c\u60a8\u5c31\u53ef\u4ee5\u8fd0\u884c\u6027\u80fd\u6d4b\u8bd5\u3001\u83b7\u5f97\u603b\u4f53\u8fd0\u884c\u72b6\u51b5\u8bc4\u4f30\u5e76\u68c0\u67e5\u6709\u5173SSD\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u8bbe\u5907\u4e0a\u7684\u5df2\u7528\u7a7a\u95f4\u3001\u8bbe\u5907\u6e29\u5ea6\u3001\u5199\u5165\u7684\u603b\u5b57\u8282\u6570\u3001S.M.A.R.T.\u72b6\u6001\u3001\u64e6\u9664\u8ba1\u6570\u72b6\u6001\u548c\u5757\u6570\u3002\nA55\u91c7\u7528\u574f\u5757\u7ba1\u7406\u529f\u80fd\u6784\u5efa\uff0c\u53ef\u6301\u7eed\u76d1\u63a7\u548c\u66f4\u6362\u574f\u5757\uff0c\u4ee5\u5ef6\u957f\u56fa\u6001\u786c\u76d8\u7684\u4f7f\u7528\u5bff\u547d\uff0c\u4f7f\u60a8\u7684\u7cfb\u7edf\u4fdd\u6301\u826f\u597d\u72b6\u6001\u3002\nA55\u662f\u540c\u7c7b\u4e2d\u6700\u8f7b\u3001\u6700\u8584\u7684\u56fa\u6001\u786c\u76d8\u4e4b\u4e00\uff0c\u4f46\u5b83\u662f\u9632\u9707\u548c\u9632\u9707\u7684\uff0c\u56e0\u4e3a\u5b83\u6ca1\u6709\u6d3b\u52a8\u90e8\u4ef6\u3002\u6b64\u5916\uff0c\u8fd8\u914d\u5907\u4e86S.M.A.R.T.\u76d1\u63a7\u7cfb\u7edf\u548cECC\u6280\u672f\uff0c\u4ee5\u4fdd\u8bc1\u66f4\u9ad8\u7684\u6570\u636e\u4f20\u8f93\u5b89\u5168\u6027\u3002", "note_en": "Our trend watchers noticed a significant drop in 1TB SSD prices on Amazon. You can now pick up one of the highest rated drives for just $97.99.\n The  $97.99 Silicon Power 1TB SSD 3D NAND supports TRIM, Garbage Collection technology, RAID, and ECC (Error Checking &amp; Correction) to provide optimized performance, and enhanced reliability and the advanced SLC Cache Technology allows performance boost and longer lifespan.\n  But that\u2019s not the only one that\u2019s dropped significantly, the other manufacturers are all following suit and dropping their prices significantly.\n   Applying the advanced 3D NAND flash, Ace A55 features higher reliability and better power efficiency than traditional SSDs equipped with 2D NAND flash. The A55 offers improved endurance and longer battery life that you\u2019re able to work longer without frequently recharge your laptop.\n  Powered by high quality controller and original synchronous NAND flash, the A55 delivers incredibly high transfer speeds that enable short boot time, fast application loading and quick file processing.\n  The A55 especially applies the \u201dSLC Cache technology\u201d that allows all data to be written in the SLC portion first and leads to higher peak writing performance. In addition, the technology can reduce write amplification and thus offer better endurance and longer lifespan of the SSD.\n  The A55 comes with a free-download SSD health monitor tool \u2013 SP Toolbox Software, which is especially designed for you to easily monitor the current health status of a SSD. By such, you can run a performance test, get an overall health evaluation and check detailed information about your SSD, including used space on device, device temperature, total bytes written, S.M.A.R.T. status, erase count status and block numbers.\n   The A55 is built with Bad Block Management, which can continually monitor and replace bad blocks to keep your system in good condition with prolonged lifespan of a SSD.\n  The A55 is one of the lightest and thinnest SSD of its kind yet it is shock- and vibration-proof since it contains no moving parts. Furthermore, S.M.A.R.T. monitoring system and ECC technology are equipped to promise higher data transmission safety.", "posttime": "2020-05-03 04:19:42", "tags": "\u786c\u76d8,\u56fa\u6001\u786c\u76d8,\u56fa\u6001,ssd,\u5199\u5165", "title": "1 TB\u56fa\u6001\u786c\u76d8\u7684\u6210\u672c\u521a\u521a\u964d\u81f398\u7f8e\u5143\u4ee5\u4e0b", "title_en": "The cost of a 1TB SSD drive just dropped below $98", "transed": 1, "url": "https://arador.com/the-cost-of-a-1tb-ssd-drive-just-dropped-below-98/", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u786c\u76d8", "\u56fa\u6001\u786c\u76d8", "\u56fa\u6001", "ssd", "\u5199\u5165"]}, {"category": "", "categoryclass": "", "imagename": "0bc64b67a28f0c524e40524296d717a5.jpg", "infoid": 1000407, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u4efb\u4f55\u60f3\u6cd5\u6700\u597d\u7684\u90e8\u5206\u662f\u5f53\u5b83\u662f\u65b0\u9c9c\u7684\u548c\u65b0\u7684\uff0c\u800c\u4f60\u8fd8\u4e0d\u77e5\u9053\u5b83\u7684\u9650\u5236\u548c\u9650\u5236\u3002\u5b83\u51e0\u4e4e\u53ef\u4ee5\u662f\u795e\u5947\u7684\uff01\u54e6\uff0c\u4f60\u4f1a\u5e2e\u52a9\u5ba2\u6237\uff0c\u4f60\u4f1a\u8d5a\u5230\u94b1\uff01\u4f60\u9996\u5148\u8981\u505a\u7684\u5c31\u662f\u2026\u3002\u5199\u5f88\u591a\u4ee3\u7801\u3002\n\u6709\u591a\u5c11\u4ee3\u7801\uff1f\u55ef\uff0c\u5f88\u660e\u663e\uff0c\u8fd9\u53d6\u51b3\u4e8e\u4f60\u7684\u60f3\u6cd5\u548c\u4f60\u8ba1\u5212\u5efa\u7acb\u7684\u4e1a\u52a1\u3002\u4f46\u662f\uff0c\u5728\u4efb\u4f55SaaS\u4e1a\u52a1\u4e2d\uff0c\u90fd\u6709\u5927\u91cf\u7684\u4ee3\u7801\u662f\u60a8\u9700\u8981\u548c\u60f3\u8981\u7684\uff0c\u800c\u4e14\u5728\u60a8\u751a\u81f3\u53ef\u4ee5\u7f16\u5199\u4e00\u884c\u4e1a\u52a1\u903b\u8f91\u4e4b\u524d\uff0c\u60a8\u90fd\u5fc5\u987b\u7f16\u5199\u5176\u4e2d\u7684\u5f88\u591a\u4ee3\u7801\u3002\n\u597d\u7684\uff0c\u9996\u5148\u4f60\u9700\u8981\u4e00\u4e9b\u5f00\u59cb\u7684\u4e1c\u897f\u3002\u9664\u975e\u60a8\u8ba1\u5212\u4ece\u5934\u5f00\u59cb\u7f16\u5199\u6240\u6709\u5185\u5bb9\uff0c\u5426\u5219\u60a8\u5c06\u9700\u8981\u8bbe\u7f6e\u4e00\u4e9b\u901a\u7528\u6846\u67b6\u6765\u652f\u6301\u73b0\u4ee3Web\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\u3002\u5728\u524d\u7aef\uff0c\u8fd9\u5927\u6982\u662f\u8fd9\u6837\u7684\uff1a\n\u5982\u679c\u60a8\u7684\u6846\u67b6\u4e2d\u6ca1\u6709HTTP\u8bf7\u6c42\u5e93\uff0c\u90a3\u4e48\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2aHTTP\u8bf7\u6c42\u5e93\u3002\u4f8b\u5982\uff1aSuperAgent\uff0cAxios\uff0cGET\u3002\n\u5c06\u6240\u6709\u8fd9\u4e9b\u4e0d\u540c\u7684\u5de5\u5177\u8bbe\u7f6e\u5728\u4e00\u8d77\u4e5f\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\u3002\u53ea\u8981\u641c\u7d22\u4e00\u4e0b\u4e3aX#34\uff1b\u914d\u7f6ewebpack\u7684\u7248\u672c\uff0c\u5c31\u4f1a\u53d1\u73b0\u4e3a\u4e0d\u540c\u7248\u672c\u7684webpack\u548cX\u5199\u7684\u535a\u5ba2\u5e16\u5b50\u6bd4\u6bd4\u7686\u662f\u3002\u867d\u7136\u6709\u4e9b\u4f1a\u6709\u6240\u5e2e\u52a9\uff0c\u4f46\u4e5f\u6709\u4e00\u4e9b\u4f1a\u8d62\uff0c\u6709\u65f6\u53ea\u6709\u5b9e\u9a8c\u624d\u80fd\u63ed\u6653\u54ea\u4e2a\u662f\u54ea\u4e2a\u3002\n\u8c22\u5929\u8c22\u5730\uff0c\u6709\u4e00\u4e9b\u5de5\u5177\u53ef\u4ee5\u8ba9\u8fd9\u4e00\u5207\u53d8\u5f97\u66f4\u5bb9\u6613\u3002React\u7684Next.js\u548cVue\u7684Nuxt.js\u53ea\u662f\u4e24\u4e2a\u4f8b\u5b50\uff0c\u4f46\u662f\u6709\u8bb8\u591a\u98ce\u683c\u7684UI\u6846\u67b6\u53ef\u4ee5\u663e\u8457\u51cf\u5c11\u4e0a\u9762\u7684\u8bbe\u7f6e\u65f6\u95f4\u3002\u5f53\u7136\uff0c\u73b0\u5728\u60a8\u5fc5\u987b\u4e86\u89e3UI\u6846\u67b6\u548cUI\u5e93\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u4f46\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u8fd9\u79cd\u6743\u8861\u662f\u503c\u5f97\u7684\u3002\n\u8f6c\u5230\u540e\u7aef\uff0c\u60a8\u5c06\u9700\u8981\u4e00\u4e2aWeb\u6846\u67b6\u3002\u201c\u8fd9\u5728\u5f88\u5927\u7a0b\u5ea6\u4e0a\u53d6\u51b3\u4e8e\u60a8\u4f7f\u7528\u7684\u8bed\u8a00\uff0c\u4f46\u60a8\u6709\u5f88\u591a\u53ef\u4f9b\u9009\u62e9\u7684\u8bed\u8a00\uff1a\n\u8fd9\u4e2a\u5217\u8868\u51b3\u4e0d\u662f\u5f88\u5e7f\u6cdb--\u4ec5\u4ec5\u662f\u8ffd\u8e2a\u4e00\u79cd\u8bed\u8a00\u7684\u6240\u6709\u53ef\u7528\u7684\u6846\u67b6\u5c31\u662f\u5b83\u81ea\u5df1\u7684\u4e00\u7bc7\u6587\u7ae0\u4e86\u3002\u4f46\u5b83\u786e\u5b9e\u663e\u793a\u4e86\u5404\u79cd\u53ef\u7528\u7684\u9009\u62e9\u3002\u6bcf\u79cd\u8bed\u8a00\u548c\u6846\u67b6\u90fd\u6709\u81ea\u5df1\u7684\u80fd\u529b\u548c\u53d6\u820d\uff0c\u8fd9\u662f\u4f60\u5728\u505a\u51fa\u9009\u62e9\u4e4b\u524d\u5fc5\u987b\u8003\u8651\u7684\u3002\u73b0\u5728(\u6216\u4e4b\u540e\uff01)\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u4f60\u5f88\u96be\u6539\u53d8\u4e3b\u610f\u3002)\u3002\n\u5b9e\u9645\u4e0a\uff0c\u8ba9\u6211\u4eec\u9000\u4e00\u6b65\u8bf4\u3002\u5f53\u7136\uff0c\u8fd9\u4e9b\u90fd\u662f\u57fa\u672c\u7684\uff0c\u4f46\u60a8\u4ecd\u7136\u9700\u8981\u67d0\u4e2a\u5730\u65b9\u6765\u8fd0\u884c\u6240\u6709\u8fd9\u4e9b\u4ee3\u7801\uff0c\u5e76\u4ee5\u67d0\u79cd\u65b9\u5f0f\u52a0\u5feb\u5bf9\u4ee3\u7801\u66f4\u6539\u7684\u8bc4\u4f30\u3002\n\u4f60\u53ef\u4ee5\u5728\u4f60\u7684\u672c\u5730\u673a\u5668\u4e0a\u8fd0\u884c\u6240\u6709\u7684\u4e1c\u897f\uff0c\u4f46\u8fd9\u5f88\u5c11\u662f\u7406\u60f3\u7684\u3002\u9996\u5148\uff0c\u60a8\u7684\u672c\u5730\u73af\u5883\u4e0d\u592a\u53ef\u80fd\u4e0e\u60a8\u7684\u751f\u4ea7\u73af\u5883\u76f8\u4f3c\uff0c\u5e76\u4e14\u60a8\u4e0d\u5e0c\u671b\u5728\u90e8\u7f72\u65f6\u770b\u4f3c\u5fae\u4e0d\u8db3\u9053\u7684\u5dee\u5f02\u9020\u6210\u95ee\u9898\u3002\u6b64\u5916\uff0c(\u76f8\u5bf9\u800c\u8a00)\u81ea\u52a8\u6267\u884c\u672c\u5730\u73af\u5883\u8bbe\u7f6e\u975e\u5e38\u56f0\u96be\uff0c\u56e0\u6b64\u5c06\u5176\u4ed6\u4efb\u4f55\u4eba\u6dfb\u52a0\u5230\u9879\u76ee\u4e2d\u5fc5\u7136\u4f1a\u5bfc\u81f4\u51b2\u7a81\uff0c\u7279\u522b\u662f\u5982\u679c\u4ed6\u4eec\u60f3\u8981\u4f7f\u7528\u4e0e\u60a8\u5b8c\u5168\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002\n\u865a\u62df\u673a\u7684\u4f18\u52bf\u5728\u4e8e\u975e\u5e38\u6613\u4e8e\u7406\u89e3\u548c\u4f7f\u7528\u3002\u5982\u679c\u4f60\u77e5\u9053\u5982\u4f55\u6d4f\u89c8\u4f60\u81ea\u5df1\u7684\u7cfb\u7edf\uff0c\u4f60\u5c31\u4f1a\u77e5\u9053\u5982\u4f55\u6d4f\u89c8\u865a\u62df\u7684\u7cfb\u7edf\u3002\u4f7f\u7528Ansible\u8fd9\u6837\u7684\u5de5\u5177\uff0c\u5b83\u4eec\u5f88\u5bb9\u6613\u5b9e\u73b0\u81ea\u52a8\u5316\uff1b\u4f7f\u7528Vagant\u8fd9\u6837\u7684\u5de5\u5177\uff0c\u5f00\u53d1\u65f6\u4e5f\u5f88\u5bb9\u6613\u4f7f\u7528\u3002\u6b64\u5916\uff0c\u60a8\u53ef\u80fd\u53ea\u9700\u8981\u4fee\u6539\u5c11\u91cfAnsible\u811a\u672c\u6216\u53d8\u91cf\uff0c\u5373\u53ef\u5c06\u60a8\u7684\u5f00\u53d1\u90e8\u7f72\u811a\u672c\u8f6c\u6362\u4e3a\u751f\u4ea7\u90e8\u7f72\u811a\u672c\u3002\n\u4f46\u5b83\u4eec\u53ef\u80fd\u6709\u70b9\u91cd\uff0c\u56e0\u4e3a\u5b83\u4eec\u662f\u5728\u6a21\u62df\u53e6\u4e00\u53f0\u5b8c\u6574\u7684\u673a\u5668\u3002\u8fd9\u65b9\u9762\u6709\u5f88\u597d\u7684\u89e3\u51b3\u65b9\u6848(\u542f\u7528CPU\u4f18\u5316\uff0c\u4f7f\u7528AMI\u6216\u5176\u4ed6\u673a\u5668\u6620\u50cf\u51cf\u5c11\u90e8\u7f72\u65f6\u95f4\u7b49)\uff0c\u4f46\u4e5f\u6709\u66ff\u4ee3\u65b9\u6848\u3002\n\u7801\u5934\u96c6\u88c5\u7bb1\u8f7b\u5f97\u79bb\u8c31\u3002\u4ece\u672c\u8d28\u4e0a\u8bf4\uff0c\u4ed6\u4eec\u53ea\u662f\u6309\u7167\u60a8\u7684\u6307\u793a\u8fd0\u884c\u8fd0\u884c\u60a8\u7684\u4ee3\u7801\u6240\u9700\u7684\u7cfb\u7edf\u90e8\u5206\u3002\u6b64\u5916\uff0c\u5f88\u591aCI\u7cfb\u7edf\u90fd\u63a5\u53d7dockerfile\u4f5c\u4e3a\u8f93\u5165\uff0c\u4ee5\u81ea\u52a8\u8fd0\u884c\u4ee3\u7801\u7684\u6d4b\u8bd5\u548c\u90e8\u7f72\u3002\u4e00\u4e2a\u5efa\u9020\u826f\u597d\u7684\u7801\u5934\u8bbe\u7f6e\u662f\u4e00\u4ef6\u7f8e\u4e3d\u7684\u4e8b\u60c5\u3002\n\u7136\u800c\uff0cdocker\u53ef\u80fd\u4f1a\u8ba9\u4eba\u6709\u70b9\u56f0\u60d1\u3002*\u5b83\u9700\u8981\u5b66\u4e60\u4e0e\u76f4\u63a5\u5728\u673a\u5668\u6216\u865a\u62df\u673a\u4e0a\u5de5\u4f5c\u4e0d\u540c\u7684\u5fc3\u6001\u548c\u5de5\u5177\uff0c\u5e76\u4e14\u53ef\u4ee5\u81ea\u7136\u5730\u5f15\u5bfc\u60a8\u8f6c\u5411\u66f4\u590d\u6742\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5426\u5219\u66f4\u7b80\u5355\u7684\u89e3\u51b3\u65b9\u6848\u4f1a\u66f4\u9002\u5408\u60a8\u7684\u7528\u4f8b\u3002(\u5fae\u670d\u52a1\u60a8\u597d\uff01)\u3002\n\u53ef\u4ee5\u4e3a\u60a8\u8282\u7701\u5927\u91cf\u65f6\u95f4\u7684\u4e00\u4ef6\u5c0f\u4e8b\u662f\u5728\u60a8\u7684\u4ee3\u7801\u4e0a\u8bbe\u7f6e\u76d1\u89c6\u5668\u3002*\u8fd9\u4e9b\u7a0b\u5e8f\u4f1a\u5bc6\u5207\u5173\u6ce8\u4ee3\u7801\u4e2d\u7684\u66f4\u6539\uff0c\u7136\u540e\u91cd\u65b0\u7f16\u8bd1\u5e76\u91cd\u65b0\u542f\u52a8\u670d\u52a1\u5668\uff0c\u4ee5\u4fbf\u5728\u60a8\u5237\u65b0\u6d4f\u89c8\u5668\u65f6\u59cb\u7ec8\u8fd0\u884c\u6700\u65b0\u7248\u672c\u7684\u4ee3\u7801\u3002\u201c\u60a8\u5c06\u4f7f\u7528\u7684\u8bb8\u591a\u5de5\u5177\u90fd\u5e26\u6709\u5185\u7f6e\u7684\u89c2\u5bdf\u5668(\u4f8b\u5982webpack)\uff0c\u4f46\u5bf9\u4e8e\u5176\u4ed6\u5de5\u5177\uff0c\u60a8\u9700\u8981\u5b89\u88c5\u81ea\u5df1\u7684(nodemon\u6765\u76d1\u89c6\u60a8\u7684node.js\u670d\u52a1\u5668)\u3002\n\u4e0e\u4efb\u4f55\u5176\u4ed6\u914d\u7f6e\u4e00\u6837\uff0c\u60a8\u5fc5\u987b\u6267\u884c\u4ee5\u4e0b\u914d\u7f6e\uff0c\u4ee5\u786e\u4fdd\u6bcf\u4e2a\u76d1\u89c6\u5668\u53ea\u76d1\u89c6\u6b63\u786e\u7684\u76ee\u5f55\uff0c\u786e\u4fdd\u6587\u4ef6\u5728\u60a8\u7684\u4e3b\u673a\u7cfb\u7edf\u548cVM/docker\u5bb9\u5668\u4e4b\u95f4\u4ee5\u4e00\u79cd\u4e0d\u4f1a\u7eca\u5012\u60a8\u7684\u76d1\u89c6\u5668\u7684\u5feb\u901f\u65b9\u6cd5\u5171\u4eab\uff0c\u7b49\u7b49\u3002\n\u5982\u679c\u8fd0\u6c14\u597d\u7684\u8bdd\uff0c\u4f60\u5df2\u7ecf\u6709\u4e86\u4e00\u4e2a\u8bbe\u8ba1\u8981\u7528\uff0c\u4f46\u662f\u4f60\u8fd8\u6ca1\u6709\u3002", "note_en": "The best part of any idea is when it&#39;s fresh and new, and you don&#39;t yet know the limitations and restrictions. \u00a0It can be almost magical! \u00a0Oh, the customers you&#39;ll help and the money you&#39;ll make! \u00a0All you have to do first is... write a lot of code.\n How much code? \u00a0Well, obviously that depends on your idea and what business you&#39;re planning on setting up. \u00a0But there&#39;s a huge amount of code you&#39;ll need and want for  any SaaS business, and a lot of it you&#39;ll have to write before you can write even  line one of your business logic.\n    Okay, first you&#39;re gonna need something to start from. \u00a0Unless you plan on writing  everything from scratch, you&#39;ll need to set up some common frameworks to enable a modern web app to run. \u00a0On the front-end, that&#39;s something like:\n An HTTP requests library, if your framework doesn&#39;t come with one. \u00a0Examples:  Superagent,  Axios,  got.\n Getting all these various tools set up to work together will take some time as well. \u00a0Just searching &#34;configuring webpack for X&#34; reveals a minefield of blog posts written for various versions of webpack and X. \u00a0Some will help, some won&#39;t, and sometimes only experimentation will reveal which is which.\n Thankfully, there are tools that make a lot of this easier. \u00a0 Next.js for React and  Nuxt.js for Vue are just two examples, but there are many flavours of UI frameworks that can significantly reduce the setup time for the above. \u00a0Of course, now you have to learn how your UI framework works as well as your UI library, but generally that trade-off is worthwhile.\n Moving on to the back-end, you&#39;re going to want a web framework. \u00a0This will largely depend on the language you&#39;re working with, but you have plenty to choose from:\n  This list is by no means extensive - just tracking down all the available frameworks for a single language would be an article in it&#39;s own. \u00a0But it does display the variety of choices available. \u00a0Each language and framework has its own capabilities and trade-offs, and that&#39;s something you&#39;ll have to take into account before you make your choice. \u00a0(Or after! \u00a0It&#39;s just harder to change your mind at that point.)\n  Actually, let&#39;s take a step back for a second. \u00a0Sure, those are the basics, but you still need someplace to  run all that code, and in a way that speeds up your evaluation of code changes.\n You could run everything on your local machine, but that&#39;s rarely ideal. \u00a0For starters, your local environment is highly unlikely to resemble your production environment, and you don&#39;t want seemingly-minor differences causing problems when you deploy. \u00a0Plus, it&#39;s very hard (comparatively) to automate local environment setup, so adding anyone else to the project is bound to cause conflict, especially if they want to use an entirely different OS from you.\n   Virtual Machines have the advantage of being very simple to understand and work with. \u00a0If you know how to navigate your own system, you&#39;ll know how to navigate a virtual one just fine. \u00a0They&#39;re easily automated with something like  Ansible, and easy to use for development with something like  Vagrant. \u00a0Plus, you&#39;ll likely only need to modify a bit of your Ansible scripts or variables to turn your development deploy script into a production deploy script.\n But they can be a bit  heavy, as they are emulating an entire other machine. \u00a0There are good solutions to this (enabling CPU optimizations, using AMIs or other machine images to reduce deploy time, etc), but there&#39;s also an alternative.\n  Docker containers are  crazy lightweight. \u00a0Essentially, they just run the bits of the system required to run your code, as dictated by you. \u00a0Plus, a great many CI systems accept dockerfiles as input to automatically run tests and deploys of your code. \u00a0A well-built docker setup is a thing of beauty.\n However, docker can be a bit  confusing. \u00a0It requires learning a different mindset and tooling from working directly on a machine or virtual machine, and can lead you naturally towards more-complex solutions where a simpler one would otherwise work better for your use case. \u00a0(Hello, microservices!)\n  A small thing that can save you a lot of time is setting watchers on your code. \u00a0These are programs that keep an eye out for changes in your code, then re-compile and restart servers so that the latest version of your code is always running when you refresh your browser. \u00a0Many of the tools you&#39;ll use will come with built-in watchers (webpack, for example), but for others, you&#39;ll need to install your own ( nodemon to watch your Node.js server).\n And like with anything else, there&#39;s configuration you have to do to make sure that each watcher is only watching the correct directories, that files are shared between your host system and VM/docker container in a fast method that won&#39;t trip up your watchers, etc.\n  With any luck, you&#39;ll have a design already to work with, but you still need to translate that design into an application template and common UI components and architecture. A good CSS framework can really help here, allowing you to set up common colours and sizes that you can use across the entire project, and using component-based development can allow you to, say, create a TextInput element once, then use it across your project multiple times. You&#39;ll also need to set  ...\n  Proper logging can give you more and more-useful information than a slapdash setup can. \u00a0You&#39;ll want to log requests and request data, useful checkpoint information, and the usual stuff - errors, stack traces, etc. \u00a0But you also want to make sure not to log  too much. \u00a0For example, you&#39;ll obviously want to omit passwords, but you should also in general omit headers, especially headers containing authentication tokens, for obvious security reasons.\n  Database schemas are part of your app as well, and that means they need to be represented as code somewhere and checked into version control. \u00a0Manually updating your production database to match your development database is amateur-hour.\n So in addition to your back-end frameworks and your front-end frameworks, you&#39;ll need a database migration framework, and you&#39;ll need to write migrations for it.\n  Users are the fundamental primitive of a SaaS application, and there&#39;s a common set of interactions you&#39;ll require: sign-up, login, logout, edit profile, etc. \u00a0But sitting underneath all that is a bit of a contentious topic: user authentication.\n There are a bunch of ways to do user authentication, but most of them are wrong and will end up leaving you with security vulnerabilities. \u00a0 JWTs are popular and can be secured, but you need to follow some best practices:\n Don&#39;t store JWTs in localStorage, since any JS that runs on your page can access them, and if you get hit with a cross-site scripting attack, they can export your tokens en masse.\n  Include a global version code in your JWTs so that you can instantly invalidate all JWTs every issued.\n Include a user version code in your JWTs so that a user can instantly invalidate all JWTs ever issued for them specifically. \u00a0This is useful to include a &#34;log out all devices&#34; option for users who may have lost a device or had their account compromised.\n Send a  Cross-Site Request Forgery token with every request as a javascript-injected header, and make sure that token matches one you&#39;ve stored for the user on login.\n You&#39;ll notice a lot of these practices are &#34;in case of a security breach&#34;, and you&#39;d hope that if you did everything correctly, they&#39;d be unnecessary. \u00a0However, that&#39;s a fantasy and should be treated as such. \u00a0No site is 100% secure and bug-free, and yours won&#39;t be either. \u00a0Instead, you need to work in layers, so that if any one layer of security fails, there are still other layers and countermeasures in place.\n  When users sign up, log in, and really all throughout your app, they&#39;ll be filling out and submitting forms. These forms will need to be validated for the appropriate data, preferably on both the front-end (before the data is sent to the server, to provide the best experience to the user) and the back-end (to ensure no junk data is saved to the database). If your back-end isn&#39;t in JavaScript, you&#39;ll need validation libraries for both languages that have the  ...\n  Transactional email is the email you send when certain events happen for your users. \u00a0These can be lifecycle events, like welcome emails, &#34;trial about to expire&#34; emails, etc, or service-related emails like email address confirmation emails, password reset emails, notifications about your service, etc.\n You&#39;ll need to find and configure a decent mailer module, and usually perform some DNS configuration at your mail service host&#39;s instruction. \u00a0Some mailer modules will come with template capabilities built-in, while others will leave you to install your own.\n  Getting paid is why most people are going to start a SaaS in the first place, so processing payments and subscriptions is mightily important. Choosing and setting up an account with a payments provider is up to individual preference, but Stripe offers probably the best API and developer experience out there, while PayPal is usually the most-requested provider of choice from users. It&#39;s likely that you&#39;ll want to offer multiple ways to pay through multiple providers,  ...\n If you offer subscriptions, you&#39;ll want to allow users to choose between a monthly billing cycle and an annual one. \u00a0Annual billing is a great way for dedicated users to save money, while also offering you the benefits of higher  LTV and getting you the money up-front, increasing your liquidity.\n If you have multiple levels of plans, you&#39;ll need to implement the ability for users to change between those levels, usually offering a prorated fee for the month of transition.\n Though it&#39;s definitely not the &#34;happy path&#34;, you&#39;ll need to offer users the ability to cancel subscriptions. \u00a0You shouldn&#39;t add extra friction to this, since some users will just be cancelling temporarily, and you want to leave a good impression on them, but it&#39;s important to try to capture the reason they&#39;re leaving, so you can improve your service.\n  Once you&#39;ve fully-developed your fancy new SaaS, you&#39;re going to need to put it up on the web for people to interact with, and for that, you&#39;re going to need a deploy system. \u00a0Even if that system is largely manual, you&#39;re going to want defined, repeatable, documented steps that ensure that deploys go off without incident.\n   There are a whole lot more things you can do to ensure a safe and clean deploy, but this list is at least a good starting place.\n  Much like how we discussed security in layers above, backups of production data are another layer of defence in case something goes wrong. \u00a0If you&#39;re still using manual processes to alter user data, it can be very easy for a slip of the keys to accidentally alter or delete the wrong user&#39;s data. \u00a0And if you&#39;re using automated processes, it&#39;s usually a lot harder to make those simple mistakes, but more complex mistakes can make it very easy to edit or delete  huge  ...\n What makes a proper backup, then? \u00a0That&#39;s a whole topic on its own, but you should start with:\n Complete: Don&#39;t just backup the database - if the user uploads files, those should be backed up as well.\n  Retained: You&#39;ll want to keep your backups around for a while, though you might want to set up a schedule for longer-retained backups. \u00a0(i.e. Daily backups retained for 30 days, weekly backups retained for 3 months, monthly backups retained for 1 year.)\n Secure: Your backups should be kept with the same level of security as your data. \u00a0If your data is encrypted at rest, your backups should be as well. \u00a0Make sure to keep your encryption keys secure. \u00a0If you lose those keys, you lose the backup.\n Tested: A backup that hasn&#39;t been tested  is not a backup. \u00a0You don&#39;t want to find out that your backup process doesn&#39;t work (or stopped working) when you need to restore critical data. \u00a0There should be an automated test process that runs after backups are created.\n If you&#39;re lucky, your hosting platform will offer some level of database backup as a service, which will save you a lot of time and effort setting up. \u00a0It likely won&#39;t cover 100% of your needs, but it will get you a lot closer than starting from scratch.\n  Okay! \u00a0That&#39;ll get you off the ground, but once you start seeing any success at all, you&#39;re going to start wanting something a little more... robust. \u00a0Eventually, manually editing the database is going to get tedious (not to mention dangerous), and users will start asking the same questions over and over. \u00a0You&#39;re going to have to slow down on development related to your core business and implement a bunch more supporting features.\n  You can edit and delete users directly from the database, sure, but all it takes is one time forgetting to add a  WHERE or  LIMIT clause to a statement to make you long for a proper administration console. \u00a0(And backups. \u00a0You set up backups, right?)\n An admin console is also a great place for dashboards, user statistics, summaries, metrics, etc. \u00a0Your admin console can become your one-stop-shop for running your SaaS.\n  Documentation can serve multiple purposes. \u00a0Primarily, it&#39;s for user education, but conveniently, this is user education you don&#39;t have to do manually. \u00a0Think about it like automated customer support - a user that answer their question from your documentation is a user that doesn&#39;t email you.\n If your documentation is publicly available, it can also help users make purchasing decisions. \u00a0By answering questions about your service openly and up-front, you can let users more-easily determine if your service will work for them, as well as reassure them about your transparency.\n Public documentation also helps with SEO, since your keywords will likely naturally come up frequently on your documentation pages.\n  Once you have a sufficient number or sufficiently large customers, you&#39;ll likely start getting requests around tax time for their billing history. \u00a0Your payment system will keep track of payments for you, and many of them will be able to generate invoices from their web interface that you can send to customers who request it.\n That might hold you for a while, but eventually, you&#39;ll want this functionality built into your system, so clients can self-serve, and your customer support team can focus on more-important issues.\n  Making the right decisions early on and as your service grows can have compounding benefits, but frequently, it&#39;s difficult to find time to devote to tasks that aren&#39;t seen as critical. \u00a0Still, if you can make the time to invest in them, it can pay off for you and your users as well.\n  Especially now, when people are trying to cut costs in both their lives and businesses, the ability to  pause a subscription instead of  cancel it outright can mean the difference between saving a customer and losing them. \u00a0Similarly, the ability to credit customers some free time or usage on your service can aid in retention, especially if something goes wrong and you want to make it up to them.\n  When displaying publicly-visible auto-incrementing IDs (such as user IDs), it can be a good idea to obfuscate what that number actually is. \u00a0This prevents competitors and skittish customers from identifying how much usage your service has seen so far. \u00a0A great library for this is  Hashids, which has many compatible implementations across many languages.\n  The fewer languages your app uses, the less common code that you&#39;ll have to duplicate between the various services and projects you require. Some are going to be unavoidable, such as JavaScript if you have a web app with any serious browser interactions, Swift for iOS, and Java/Kotlin for Android. Web apps, however, offer a truly terrifying number of languages you can choose for server code: PHP, Ruby, JavaScript, Typescript, Go, Rust, Java,  ...\n In extreme situations, you can limit yourself to just one language, even across multiple disparate platforms. \u00a0JavaScript can do front-end and back-end web development, desktop development through Electron, and mobile development through Cordova. \u00a0There are definite trade-offs for going this route, but for a smaller studio, this opens up a multi-platform strategy on a limited budget.\n  Linters like  ESLint,  RuboCop, and  Flake8 can make a  marked improvement in your code. \u00a0They can catch stylistic errors long before they make it into production, and many stylistic errors are really just shortcomings of your chosen language, where hard-to-find bugs breed and propagate.\n  Monorepos are  great! \u00a0They&#39;re especially great if you&#39;re just starting your SaaS, as they&#39;re far simpler than trying to work with multiple repositories when managing dependencies, figuring out code re-use, and ensuring that all the correct code is committed before deploys go out.\n Everyone&#39;s situation is different, of course, and it may make sense in your case to go with multiple repositories, or even one day switch to such a strategy, but when you&#39;re starting out, you want to limit the complexity of your project as much as you can, and the monorepo strategy will definitely pay off in this regard.\n  Being able to log in as your users from your Admin Console can help immensely when trying to sort out customer service issues. Instead of having several back-and-forth &#34;what do you see now?&#34; emails, you can just log in as them and find out. There are a lot of things to consider when writing a user impersonation feature, however: Do you require special access to impersonate users? Do you require the user&#39;s permission to impersonate  ...\n These aren&#39;t the only considerations, but ideally it&#39;s enough to make the point that there&#39;s a lot more to user impersonation than simply changing a token ID.\n  Once you start getting enough customers with sufficient expectations, you&#39;ll have to make modifications to your deploy process for increased reliability and flexibility:\n Updating in-place won&#39;t work forever. \u00a0Eventually, switching to  blue/green deploys or even something as simple as displaying a maintenance mode page while you update will be necessary to keep people from interacting with the system while performing significant changes.\n If you have a complex  SPA, you&#39;ll want to be able to inform users when you&#39;ve made an update that requires reloading that code. \u00a0Tracking version numbers both in your UI code and on the server will allow you to pop up a notification, allowing the user to save their work and then reload.\n Ideally, you should be using a  bug  tracking  service. \u00a0If you also send your  source maps to them when performing a deploy, they can provide even better error messages when UI errors occur.\n Serving your UI JavaScript from your server is simple and easy, but users appreciate  fast, and your job is to do the hard work so that users have a good time. \u00a0A relatively easy way to speed up your user&#39;s experience is to upload your UI JavaScript on release to a  CDN. \u00a0This is a one-time change you need to make that pays dividends for your users going forwards.\n You&#39;ll likely be manually checking that releases go as expected, but automated smoke tests that run on every deploy are a better way to catch issues that might otherwise slip by you when you&#39;re tired, distracted, or in a hurry.\n  If you don&#39;t want to start from an empty folder and write all this code yourself, you should consider using a SaaS starter kit, and it just so happens that you&#39;re reading the blog for one right now! \u00a0With Nodewood, you can get started writing business logic today, saving weeks or even months of development time.\n Nodewood starts you off with a full working web app, with a Vue front-end and Express back-end, built entirely from JavaScript. \u00a0Form validation, testing, user authentication and management, subscription/billing are all built-in, alongside a sleek and customizable application theme with an easy-to-extend admin console.", "posttime": "2020-05-03 04:19:37", "tags": "\u4ee3\u7801,saas,code,users", "title": "\u542f\u52a8SaaS\u9700\u8981\u7f16\u5199\u7684\u4ee3\u7801\u5217\u8868", "title_en": "The List of Code You Need to Write to Start a SaaS", "transed": 1, "url": "https://nodewood.com/blog/the-huge-list-of-code-you-need-to-write-to-start-a-saas/", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u4ee3\u7801", "saas", "code", "users"]}, {"category": "", "categoryclass": "", "imagename": "", "infoid": 1000406, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u5728\u8fd9\u7bc7\u4e3a\u201c\u5723\u5730\u4e9a\u54e5\u6cd5\u5f8b\u8bc4\u8bba\u201d\u7814\u8ba8\u4f1a\u64b0\u5199\u7684\u77ed\u6587\u4e2d\uff0c\u4e39\u5c3c\u5c14\u00b7\u7d22\u6d1b\u592b(Daniel Solove)\u6559\u6388\u7814\u7a76\u4e86\u201c\u6ca1\u6709\u4ec0\u4e48\u53ef\u9690\u7792\u201d\u7684\u8bba\u70b9\u3002\u5f53\u88ab\u95ee\u53ca\u653f\u5e9c\u76d1\u63a7\u548c\u6570\u636e\u6316\u6398\u65f6\uff0c\u8bb8\u591a\u4eba\u7684\u56de\u7b54\u662f\uff1a\u6211\u6ca1\u6709\u4ec0\u4e48\u53ef\u9690\u7792\u7684\u3002\u6839\u636e\u201c\u6ca1\u4ec0\u4e48\u53ef\u9690\u85cf\u201d\u7684\u8bba\u70b9\uff0c\u9664\u975e\u653f\u5e9c\u53d1\u73b0\u975e\u6cd5\u6d3b\u52a8\uff0c\u5426\u5219\u9690\u79c1\u4e0d\u4f1a\u53d7\u5230\u5a01\u80c1\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2a\u4eba\u6ca1\u6709\u6b63\u5f53\u7406\u7531\u58f0\u79f0\u5b83\u662f\u79c1\u4eba\u7684\u3002\u6ca1\u4ec0\u4e48\u597d\u8bf4\u7684..\u3002\n\u7d22\u6d1b\u592b\uff0c\u4e39\u5c3c\u5c14\u00b7J\uff0c\u6211\u6ca1\u6709\u4ec0\u4e48\u53ef\u9690\u7792\u7684\uff0c\u4e5f\u6ca1\u6709\u5176\u4ed6\u5bf9\u9690\u79c1\u7684\u8bef\u89e3\u3002\u201c\u5723\u5730\u4e9a\u54e5\u6cd5\u5f8b\u8bc4\u8bba\u201d\uff0c\u7b2c44\u5377\uff0c\u7b2c745\u9875\uff0c2007\u5e74\uff1b\u534e\u76db\u987f\u5927\u5b66\u6cd5\u5b66\u9662\u516c\u6cd5\u7814\u7a76\u8bba\u6587\u7b2c289\u53f7\u3002\u53ef\u5728srn\uff1ahttps://ssrn.com/abstract=998565\u4e0a\u83b7\u5f97\u3002", "note_en": "In this short essay, written for a symposium in the San Diego Law Review, Professor Daniel Solove examines the nothing to hide argument. When asked about government surveillance and data mining, many people respond by declaring: &#34;I&#39;ve got nothing to hide.&#34; According to the nothing to hide argument, there is no threat to privacy unless the government uncovers unlawful activity, in which case a person has no legitimate justification to claim that it remain private. The nothing to  ...\n           Solove, Daniel J., &#39;I&#39;ve Got Nothing to Hide&#39; and Other Misunderstandings of Privacy. San Diego Law Review, Vol. 44, p. 745, 2007; GWU Law School Public Law Research Paper No. 289. Available at SSRN:  https://ssrn.com/abstract=998565", "posttime": "2020-05-03 04:19:26", "tags": "\u6ca1\u4ec0\u4e48,hide,law", "title": "\u201c\u6211\u6ca1\u4ec0\u4e48\u597d\u9690\u7792\u7684\u201d\u548c\u5176\u4ed6\u5bf9\u9690\u79c1\u7684\u8bef\u89e3(2007)", "title_en": "'I've Got Nothing to Hide' and Other Misunderstandings of Privacy (2007)", "transed": 1, "url": "https://papers.ssrn.com/sol3/papers.cfm?abstract_id=998565&", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u6ca1\u4ec0\u4e48", "hide", "law"]}, {"category": "", "categoryclass": "", "imagename": "5db30ed4131a273bbb8e928a119566b5.jpg", "infoid": 1000405, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u5728\u6700\u8fd1\u7684\u4e00\u6b21AWS\u6210\u672c\u4f18\u5316\u95ee\u7b54\u4e2d\uff0cCorey Quinn\u8c08\u5230\u4e86\u4ed6\u4f7f\u7528DynamoDB\u7684\u5b9e\u9a8c\uff1a\n\u6211\u5728\u8fea\u7eb3\u6469\u6f5c\u6c34\u7684\u6df1\u5ea6\u6bd4\u6211\u9884\u60f3\u7684\u8981\u6df1\u3002\u4ee4\u4eba\u60ca\u8bb6\u7684\u662f\uff0c\u8fd9\u771f\u662f\u592a\u68d2\u4e86\u3002\u6211\u5bf9\u6570\u636e\u5e93\u4e86\u89e3\u4e0d\u591a\uff0c\u4f46\u6211\u6b63\u5728\u770b\u5b83\uff0c\u73b0\u5728\u6211\u5728\u60f3\uff1a\u201c\u8fea\u7eb3\u6469\u592a\u68d2\u4e86\uff0c\u6211\u80fd\u628a\u5b83\u8bef\u7528\u6210\u4ec0\u4e48\u5462\uff1f\u201dS3\u662f\u6211\u6700\u559c\u6b22\u7684\u6d88\u606f\u961f\u5217\uff0c\u8def\u753153\u662f\u6211\u6700\u559c\u6b22\u7684\u6570\u636e\u5e93\uff0c\u4f46\u6211\u4e0d\u80fd\u5b8c\u5168\u786e\u5b9a\u5230\u76ee\u524d\u4e3a\u6b62\u53d1\u751f\u4e86\u4ec0\u4e48\u3002\u81f3\u4e8e\u5176\u4ed6\u521b\u9020\u6027\u7684\u7528\u9014\uff0c\u6211\u53ef\u4ee5\u6ee5\u7528\u7684\u4e1c\u897f\u3002\u4e5f\u8bb8\u4f7f\u7528\u8fea\u7eb3\u6469\u4f5c\u4e3a\u4e00\u79cd\u8ba1\u7b97\u673a\u670d\u52a1-\u6211\u6253\u8d4c\u6211\u53ef\u4ee5\u6559\u5b83\u4e0b\u68cb\u3002\nDynamoDB\u662f\u4e9a\u9a6c\u900a\u6258\u7ba1\u7684NoSQL\u670d\u52a1-\u57fa\u672c\u4e0a\u662f\u4e00\u4e2a\u6570\u636e\u5e93\u3002\u5b83\u662f\u7528\u4e8e\u4fdd\u5b58\u5927\u91cf\u975e\u7ed3\u6784\u5316\u6570\u636e\u7684\u952e\u503c\u5b58\u50a8\u3002\u6211\u4eec\u5728\u5de5\u4f5c\u4e2d\u4f7f\u7528DynamoDB\u6765\u5b58\u50a8\u6570\u636e\uff0c\u6240\u4ee5\u6211\u5bf9\u4f7f\u7528\u5b83\u7565\u77e5\u4e00\u4e8c\uff0c\u800c\u4e14\u6211\u559c\u6b22\u91c7\u7eb3\u7cdf\u7cd5\u900f\u9876\u7684\u597d\u4e3b\u610f\uff0c\u5e76\u5c06\u5b83\u4eec\u62e8\u523011\u3002\n\u5f53\u4f60\u5b66\u4e60\u7f16\u7a0b\u65f6\uff0c\u4e00\u9879\u5e38\u89c1\u7684\u4efb\u52a1\u662f\u6784\u5efa\u8ba1\u7b97\u5668\uff1a\u52a0\u6cd5\u3001\u51cf\u6cd5\u3001\u4e58\u6cd5\u548c\u9664\u6cd5\u3002\u8fd9\u5c06\u662f\u6d4b\u8bd5Amazon\u6700\u4e0d\u53d7\u6b22\u8fce\u7684\u8ba1\u7b97\u5e73\u53f0\u7684\u597d\u65b9\u6cd5-\u6211\u4eec\u53ef\u4ee5\u5728DynamoDB\u4e4b\u4e0a\u6784\u5efa\u8ba1\u7b97\u5668\u5417\uff1f\u4e8b\u5b9e\u8bc1\u660e\u6211\u4eec\u53ef\u4ee5\u505a\u5230\uff0c\u8fd9\u5c31\u662f\u6211\u5728\u8fd9\u7bc7\u6587\u7ae0\u4e2d\u8981\u7ecf\u5386\u7684\u3002(\u5c06\u8fd9\u4e2a\u5b9e\u9a8c\u6269\u5c55\u5230\u56fd\u9645\u8c61\u68cb\uff0c\u7559\u7ed9\u8bfb\u8005\u4f5c\u4e3a\u7ec3\u4e60\u3002)\u3002\n\u4e3a\u4e86\u907f\u514d\u6000\u7591\uff1a\u8fd9\u662f\u4e00\u4e2a\u574f\u4e3b\u610f\u2122\u3002\u8bf7\u52ff\u5728\u751f\u4ea7\u4e2d\u4f7f\u7528\u6b64\u4ee3\u7801\uff0c\u4e5f\u4e0d\u8981\u5728\u751f\u4ea7\u73af\u5883\u7684\u5341\u82f1\u91cc\u534a\u5f84\u5185\u4f7f\u7528\u6b64\u4ee3\u7801\u3002\u8fd9\u662f\u4e00\u7bc7\u8bbd\u523a\u6587\u7ae0\uff0c\u4e0d\u662f\u4e25\u8083\u7684\u8282\u76ee\u3002\nDynamoDB\u652f\u6301\u591a\u79cd\u7f16\u7a0b\u8bed\u8a00\uff0c\u5305\u62ecJava\u3001.NET\u548cPython\u3002\u6211\u5c06\u5728\u8fd9\u7bc7\u6587\u7ae0\u4e2d\u4f7f\u7528Python\uff0c\u56e0\u4e3a\u8fd9\u662f\u6211\u6240\u719f\u6089\u7684\uff0c\u4f46\u662f\u8fd9\u4e9b\u60f3\u6cd5\u4e5f\u53ef\u4ee5\u5728\u5176\u4ed6\u8bed\u8a00\u4e2d\u4f7f\u7528\u3002\n\u5728DynamoDB\u4e2d\uff0c\u6211\u4eec\u6240\u6709\u7684\u8ba1\u7b97\u90fd\u5728Table\u4e2d\u8fd0\u884c\u3002\u5728\u8868\u4e2d\uff0c\u64cd\u4f5c\u5728\u884c\u5185\u8fd0\u884c\u3002\u8ba9\u6211\u4eec\u7f16\u5199\u4e00\u4e9b\u4ee3\u7801\u6765\u4e3a\u6211\u4eec\u521b\u5efa\u8868\uff0c\u5e76\u5206\u914d\u53ef\u4ee5\u7528\u6765\u8ddf\u8e2a\u5355\u4e2a\u8ba1\u7b97\u7684\u884cID\uff1a\n\u5bfc\u5165contextlib\u5bfc\u5165UUID\u5bfc\u5165boto3 DynamoDB=boto3\u3002\u8d44\u6e90(&#34\uff1bDynamoDB&#34\uff1b)\u7c7bDynamoCalculator\uff1a&#34\uff1b&#34\uff1b&#34\uff1b\u4f7f\u7528DynamoDB\u8fdb\u884c\u8ba1\u7b97\u7684\u6574\u6570\u8ba1\u7b97\u5668\u3002&#34\uff1b&#34\uff1b&#34\uff1bdef__enter__(Self)\uff1atable_name=f&#34\uff1b\u8ba1\u7b97\u5668-{uuid.uuid4()}&#34\uff1bDynamoDB\u3002CREATE_TABLE(AttributeDefinitions=[{&#34\uff1bAttributeName&#34\uff1b\uff1a&#34\uff1bCalculation_id&#34\uff1b\uff0c&#34\uff1b\uff1a&#34\uff1bS&#34\uff1b\uff0c}]\uff0cTableName=TABLE_NAME\uff0cKeySchema=[{&#34\uff1bAttributeName&#34\uff1b\uff1a&#34\uff1bCalculation_id&#34\uff1b.\u3002\n\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u4e3a\u6211\u4eec\u5904\u7406\u521b\u5efa\u548c\u6e05\u7406-\u5b83\u4e0d\u4ec5\u4e3a\u6211\u4eec\u521b\u5efa\u8868\uff0c\u8fd8\u4f1a\u5728\u4e4b\u540e\u5220\u9664\u5b83\u3002\u5728\u60a8\u53ef\u4ee5\u8fdb\u884c\u7b2c\u4e00\u6b21\u8ba1\u7b97\u4e4b\u524d\uff0c\u8fd9\u786e\u5b9e\u4f1a\u9020\u6210\u4e00\u4e9b\u5ef6\u8fdf\uff0c\u4f46\u8fd9\u610f\u5473\u7740\u6211\u4eec\u7684\u5e10\u6237\u4e2d\u6ca1\u6709\u95f2\u7f6e\u7684\u8868\u3002\n\u8bb0\u4f4f\uff1a\u4e91\u7684\u6602\u8d35\u90e8\u5206\u4e0d\u662f\u60a8\u4f7f\u7528\u7684\uff0c\u800c\u662f\u60a8\u5fd8\u8bb0\u5173\u95ed\u7684\u90e8\u5206\u3002\u6b64API\u786e\u4fdd\u6211\u4eec\u6c38\u8fdc\u4e0d\u4f1a\u5fd8\u8bb0\u5173\u95ed\u6211\u4eec\u7684\u8868\uff01\n\u91cd\u8981\u63d0\u793a\uff1a\u5982\u679c\u60a8\u521b\u5efa\u7684\u8d44\u6e90\u5177\u6709\u5e94\u8be5\u59cb\u7ec8\u8fd0\u884c\u7684\u6e05\u7406\uff0c\u5219\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u662f\u5728Python API\u4e2d\u5f3a\u5236\u6267\u884c\u6b64\u64cd\u4f5c\u7684\u597d\u65b9\u6cd5\u3002\u4f8b\u5982\u5957\u63a5\u5b57\u6216\u6587\u4ef6\uff0c\u60a8\u5e94\u8be5\u5728\u5b8c\u6210\u540e\u59cb\u7ec8\u5173\u95ed\u5b83\u4eec\u3002\n\u5728\u5176\u4ed6\u8bed\u8a00\u4e2d\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528Try\u2026\u3002\u9664\u4e86\u2026\u3002\u6700\u540e\uff0c\u4f46\u662f\u8c03\u7528\u8005\u5fc5\u987b\u8bb0\u5f97\u505a\u6e05\u7406\u3002Python\u4f7f\u7528WITH\u8bed\u53e5\u5411\u8c03\u7528\u8005\u9690\u85cf\u8fd9\u79cd\u590d\u6742\u6027\u3002\u60a8\u53ef\u80fd\u5df2\u7ecf\u4f7f\u7528\u8fc7\u4e00\u4e2a-\u4f7f\u7528OPEN(\u2026)\u3002\uff0c\u5b83\u603b\u662f\u5728\u60a8\u4f7f\u7528\u5b8c\u6587\u4ef6\u540e\u5c06\u5176\u5173\u95ed\uff0c\u65e0\u8bba\u60a8\u7684\u4ee3\u7801\u8fd4\u56de\u8fd8\u662f\u629b\u51fa\u5f02\u5e38\u3002\n\u5982\u679c\u60a8\u4e0d\u4f7f\u7528\u5b83\u4eec\uff0c\u5b83\u4eec\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u529f\u80fd\uff0c\u503c\u5f97\u5b66\u4e60\u3002\nDynamoDB\u652f\u6301\u5c06\u6570\u5b57\u4f5c\u4e3a\u4e00\u7ea7\u7c7b\u578b\uff0c\u6211\u4eec\u53ef\u4ee5\u5206\u522b\u4f7f\u7528GetItem\u548cPutItem API\u8bfb\u53d6\u548c\u5199\u5165\u6570\u5b57\u503c\u3002PutItem API\u5b8c\u5168\u66ff\u6362\u4e86\u884c\u7684\u5185\u5bb9\uff0c\u8fd9\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u5f88\u6709\u7528\u5e76\u4e14\u6613\u4e8e\u6279\u5904\u7406\uff0c\u4f46\u5b83\u5e76\u4e0d\u603b\u662f\u9002\u5408\u8fd9\u9879\u5de5\u4f5c\u7684\u5de5\u5177\u3002\n\u5047\u8bbe\u6211\u4eec\u4f7f\u7528DynamoDB\u6765\u5b58\u50a8\u8ba1\u6570\u5668\u3002\u6211\u4eec\u5e0c\u671b\u9012\u589e\u8ba1\u6570\u5668\u7684\u503c\uff0c\u4f46\u4e0d\u4ece\u8868\u4e2d\u8bfb\u53d6\u73b0\u6709\u503c-\u5982\u679c\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u5728\u8bfb\u53d6\u548c\u5199\u5165\u4e4b\u95f4\u66f4\u65b0\u8ba1\u6570\u5668\uff0c\u6211\u4eec\u5c06\u4e22\u5931\u6570\u636e\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528UpdateItem API\uff0c\u5b83\u53ef\u4ee5\u6839\u636e\u884c\u7684\u73b0\u6709\u503c\u4fee\u6539\u884c\u3002\n\u7c7b\u53d1\u7535\u673a\u8ba1\u7b97\u5668\uff1a.\u3002def add(self\uff0cx\uff1aint\uff0cy\uff1aint)-&gt\uff1bint\uff1a&#34\uff1b&#34\uff1b&#34\uff1b\u5c06\u4e24\u4e2a\u6574\u6570\u76f8\u52a0\u5e76\u8fd4\u56de\u7ed3\u679c\u3002&#34\uff1b&#34\uff1b&#34\uff1b&#34\uff1b\u4e0e\u81ea\u5df1\u3002row_id()AS CALCULATION_ID\uff1aSelf\u3002\u684c\u5b50\u3002put_item(Item={&#34\uff1bCalculation_id&#34\uff1b\uff1aCalculation_id\uff0c&#34\uff1bsum&#34\uff1b\uff1ax})\u81ea\u8eab\u3002\u684c\u5b50\u3002UPDATE_ITEM(Key={&#34\uff1bCalculation_id&#34\uff1b\uff1aCalculation_id}\uff0cUpdateExpression=&#34\uff1bSet#sum=#sum+\uff1aY&#34\uff1b\uff0cExpressionAttributeNames={&#34\uff1b#sum&#34\uff1b\uff1a&#34\uff1bsum&#34\uff1b}\uff0cExpressionAttributeValues.\u3002\n\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u4f7f\u7528PutItem\u5c06\u7b2c\u4e00\u4e2a\u6570\u5b57(X)\u5199\u5165\u5230\u8868\u4e2d\u3002\u7136\u540e\uff0c\u6211\u4eec\u6267\u884c\u4e00\u4e2aUpdateItem\uff0c\u5c06\u7b2c\u4e8c\u4e2a\u6570\u5b57(Y)\u6dfb\u52a0\u5230\u73b0\u6709\u503c\u4e2d\u3002\u6700\u540e\uff0c\u6211\u4eec\u8c03\u7528GetItem\u6765\u68c0\u7d22\u603b\u548c\u3002\n\u4e8b\u5b9e\u8bc1\u660e\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e09\u4e2aAPI\u8c03\u7528\u5408\u5e76\u4e3a\u4e00\u4e2a\u3002UpdateItem API c", "note_en": "On a recent  AWS Cost Optimisation Q&amp;A, Corey Quinn talked about his experiments with  DynamoDB:\n  I\u2019ve been diving deeper into Dynamo than I would expect. It\u2019s surprisingly awesome. I don\u2019t know much about databases, but I\u2019m looking at it, and now I\u2019m wondering:  \u201cDynamo\u2019s awesome, what can I misuse it as?\u201d S3 is my favourite message queue, Route\u00a053 is my favourite database, but I\u2019m not entirely sure what\u2019s going on as far. As far as other creative uses, the things I could misuse. Maybe using Dynamo as a compute service \u2013 I bet I can teach that thing to place chess.\n  DynamoDB is Amazon\u2019s hosted NoSQL service \u2013 basically, a database. It\u2019s a key-value store for holding large amounts of unstructured data. We use DynamoDB for data storage at work, so I know a bit about using it, and I love taking  terrible brilliant ideas and dialling them up to 11.\n  When you\u2019re learning to program, a common task is building a calculator: addition, subtraction, multiplication and division.  This would be a good way to test Amazon\u2019s least-loved compute platform \u2013 can we build a calculator on top of DynamoDB? It turns out we can, and that\u2019s what I\u2019m going to walk through in this post. (Extending this experiment to play chess is left as an exercise for the reader.)\n  For the avoidance of doubt: this is a Bad Idea\u2122. Do not use this code in production, or within a ten-mile radius of a production environment. This is a satire post, not serious programming.\n       DynamoDB supports a wide variety of programming languages, including  Java,  .NET and  Python. I\u2019m going to use Python in this post, because that\u2019s what I\u2019m familiar with, but these ideas can be used in other languages.\n  Within DynamoDB, we run all our computing inside  Table. Within a table, operations run within  Rows. Let\u2019s write some code to create a table for us, and to assign a row ID that we can use to track an individual calculation:\n  import  contextlib import  uuid import  boto3 dynamodb  =  boto3 . resource ( &#34;dynamodb&#34; ) class  DynamoCalculator :  &#34;&#34;&#34; An integer calculator that uses DynamoDB for compute. &#34;&#34;&#34;  def  __enter__ ( self ):  table_name  =  f &#34;calculator-{uuid.uuid4()}&#34;  dynamodb . create_table (  AttributeDefinitions = [{  &#34;AttributeName&#34; :  &#34;calculation_id&#34; ,  &#34;AttributeType&#34; :  &#34;S&#34; ,  }],  TableName = table_name ,  KeySchema = [{  &#34;AttributeName&#34; :  &#34;calculation_id&#34;  ...\n  The context manager handles creation  and cleanup for us \u2013 not only does it create a table for us, it deletes it afterwards. This does create a bit of latency before you can do your first calculation, but it means we don\u2019t have tables hanging around in our account.\n  Remember: the expensive part of the cloud isn\u2019t what you use, it\u2019s what you forget to turn off. This API ensures that we\u2019ll never forget to turn off our table!\n  Serious point:  if you create resources that have cleanup that should always run, context managers are a great way to enforce this in a Python API. Examples are sockets or files, which you should always close when you\u2019re done.\n  In other languages, you use  try \u2026 except \u2026 finally, but the caller has to remember to do the cleanup. Python has the  with statement to hide this complexity from the caller. You\u2019ve probably used one already \u2013  with open(\u2026), which always closes the file once you\u2019re done using it, whether your code returned or threw an exception.\n  If you\u2019re not using them, they\u2019re a powerful feature and worth learning.\n    DynamoDB supports numbers as a first-class type, and we can read and write numeric values with the GetItem and PutItem APIs, respectively. The PutItem API completely replaces the contents of a row, which is useful in some cases and easy to batch, but it\u2019s not always the right tool for the job.\n  Suppose we were using DynamoDB to store a counter. We want to increment the value of the counter, but without reading the existing value from the table \u2013 if another process updated the counter between the read and the write, we\u2019d lose data. For this, we can use the UpdateItem API, which can modify a row based on its existing values.\n    class  DynamoCalculator :  ...  def  add ( self ,  x :  int ,  y :  int )  -&gt;  int :  &#34;&#34;&#34; Adds two integers and returns the result. &#34;&#34;&#34;  with  self . row_id ()  as  calculation_id :  self . table . put_item (  Item = { &#34;calculation_id&#34; :  calculation_id ,  &#34;sum&#34; :  x }  )  self . table . update_item (  Key = { &#34;calculation_id&#34; :  calculation_id },  UpdateExpression = &#34;SET #sum = #sum + :y&#34; ,  ExpressionAttributeNames = { &#34;#sum&#34; :  &#34;sum&#34; },  ExpressionAttributeValues  ...\n  Here we use PutItem to write the first number ( x) to the table. Then we do an UpdateItem to add the second number ( y) to the existing value. Finally, we call GetItem to retrieve the sum.\n  It turns out we can consolidate these three API calls into one. The UpdateItem API creates a row if it doesn\u2019t exist yet (saving the PutItem), and we can also ask it to give us the value it just wrote to the row (saving the GetItem). Here\u2019s what the consolidated version looks like:\n  class  DynamoCalculator :  ...  def  add ( self ,  x :  int ,  y :  int )  -&gt;  int :  &#34;&#34;&#34; Adds two integers and returns the result. &#34;&#34;&#34;  with  self . row_id ()  as  calculation_id :  resp  =  self . table . update_item (  Key = { &#34;calculation_id&#34; :  calculation_id },  UpdateExpression = &#34;SET #sum = :x + :y&#34; ,  ExpressionAttributeNames = { &#34;#sum&#34; :  &#34;sum&#34; },  ExpressionAttributeValues = { &#34;:x&#34; :  x ,  &#34;:y&#34; :  y },  ReturnValues = &#34;ALL_NEW&#34;  )  return  ...\n    with  DynamoCalculator ()  as  calculator :  print ( calculator . add ( 1 ,  2 ))  # 3  print ( calculator . add ( 5 ,  3 ))  # 8  print ( calculator . add ( 5 ,  - 1 ))  # 4\n  Addition is a very common operation, so it\u2019s important we make it as fast as possible. Consolidating three API calls into one is a good optimisation!\n    Subtraction is the opposite of addition, with the convenient property that subtracting  y is the same as adding (negative  y). This leads some people to define subtraction like so:\n  def  subtract ( self ,  x :  int ,  y :  int )  -&gt;  int :  &#34;&#34;&#34; Subtracts one integer from another and returns the result. &#34;&#34;&#34;  return  self . add ( x ,  - y )\n  But you and I know these people are feeble and weak-willed. This approach uses Python to reverse the sign of  y for us, which is a computational operation. What\u2019s the point of having a compute platform like DynamoDB if we don\u2019t use it for computing?\n  DynamoDB\u2019s UpdateItem API supports subtraction as well as addition, which is a much better approach:\n  class  DynamoCalculator :  ...  def  subtract ( self ,  x :  int ,  y :  int )  -&gt;  int :  &#34;&#34;&#34; Subtracts one integer from another and returns the result. &#34;&#34;&#34;  with  self . row_id ()  as  calculation_id :  resp  =  self . table . update_item (  Key = { &#34;calculation_id&#34; :  calculation_id },  UpdateExpression = &#34;SET #difference = :x - :y&#34; ,  ExpressionAttributeNames = { &#34;#difference&#34; :  &#34;difference&#34; },  ExpressionAttributeValues = { &#34;:x&#34;\n      This is where things get a bit trickier \u2013 the UpdateExpression used by the UpdateItem API doesn\u2019t support multiplication, only addition and subtraction. We\u2019ll have to build our own implementation of multiplication. A simple approach is to use a recursive algorithm:\n  def multiply(x, y): if y == 0: return 0 else: return x + multiply(x, y - 1)\n    multiply(5, 3) = 5 + multiply(5, 2) = 5 + (5 + multiply(5, 1)) = 5 + (5 + (5 + multiply(5, 0))) = 5 + (5 + (5 + 0)) = 15\n    If we want to implement this, we need a test for equality, and branching statements. How do we do that? We could use Python, or we could find a way to do them with DynamoDB. We both know what the correct answer is.\n  Let\u2019s start by testing if two integers are the same. For this, we can misuse  conditional operations.\n  Suppose we were using DynamoDB to store date-based information. Each row includes a timestamp, and we want newer data to replace older data, but not the other way around. We could do a GetItem and then a PutItem before we write anything, but if the row changes between the Get and the Put, we could write bad data.\n  A better approach would be to supply a condition with our PutItem \u2013 for example,  \u201conly update this row if the timestamp in the new row is greater than the timestamp in the already-stored row\u201d. If the condition is true, the write succeeds. If the condition is false, the write fails and we get an error.\n  One of the conditions you can specify is that two values are the same. So let\u2019s try to write to the table with this condition \u2013 if it succeeds, the numbers are equal; if it fails, they\u2019re not.\n  class  DynamoCalculator :  ...  def  eq ( self ,  x :  int ,  y :  int )  -&gt;  bool :  &#34;&#34;&#34; Returns True if two integers are equal, False otherwise. &#34;&#34;&#34;  with  self . row_id ()  as  calculation_id :  try :  self . table . put_item (  Item = { &#34;calculation_id&#34; :  calculation_id },  ConditionExpression = &#34;:x = :y&#34; ,  ExpressionAttributeValues = { &#34;:x&#34; :  x ,  &#34;:y&#34; :  y },  )  except  Exception  as  exc :  return  False  else :  return  ...\n  (We are using a bit of Python control flow for the  try \u2026 except block \u2013 I can\u2019t think of a better way to do this, but at least the equality testing is done inside DynamoDB.)\n  Next, let\u2019s use DynamoDB to implement basic control flow. For an IF statement, we have a condition, an \u201cif true\u201d action, and an \u201cif false\u201d action. We can continue to misuse conditional operations, and pass the boolean directly to DynamoDB:\n  from  typing  import  Callable class  DynamoCalculator :  ...  def  if_ (  self ,  condition :  bool ,  if_true :  Callable [[],  int ],  if_false :  Callable [[],  int ]  )  -&gt;  bool :  &#34;&#34;&#34; If ``condition`` is True, returns the output of ``if_true``. If ``condition`` is False, returns the output of ``if_false``. &#34;&#34;&#34;  with  self . row_id ()  as  calculation_id :  try :  self . table . put_item (  Item = { &#34;calculation_id&#34; :  calculation_id  ...\n  Notice that this code doesn\u2019t call \u201cif_true\u201d or \u201cif_false\u201d until they\u2019re needed. This is a sophisticated programming technique called   lazy evaluation, and our ability to use it here speaks to the power of DynamoDB as a computing platform.\n    class  DynamoCalculator :  ...  def  multiply ( self ,  x :  int ,  y :  int )  -&gt;  int :  &#34;&#34;&#34; Multiplies two integers and returns the result. &#34;&#34;&#34;  def  if_y_non_zero ():  return  self . add ( x ,  self . multiply ( x ,  self . subtract ( y ,  1 )))  return  self . if_ (  self . eq ( y ,  0 ),  if_true = lambda :  0 ,  if_false = if_y_non_zero  )\n  This works if  y is positive or zero, but if  y is negative it keeps decrementing forever. We need to tweak our algorithm slightly:\n  def multiply(x, y): if y == 0: return 0 elif y &lt; 0: return -1 * multiply(x, -y) else: return x + multiply(x, y - 1)\n  We can get  -y by computing  0 - y, and similar for  -1 * multiply(x, -y). This leaves the problem of working out if  y is negative.\n  DynamoDB supports all the logical operators in conditional updates, so we can follow the same technique we\u2019ve already used twice:\n  class  DynamoCalculator :  ...  def  lt ( self ,  x :  int ,  y :  int )  -&gt;  int :  &#34;&#34;&#34; Returns True if x &lt; y, False otherwise. &#34;&#34;&#34;  with  self . row_id ()  as  calculation_id :  try :  self . table . put_item (  Item = { &#34;calculation_id&#34; :  calculation_id },  ConditionExpression = &#34;:x &lt; :y&#34; ,  ExpressionAttributeValues = { &#34;:x&#34; :  x ,  &#34;:y&#34; :  y },  )  except  Exception  as  exc :  return  False  else  ...\n  This gives us the last piece we need to create a fully working multiplication function:\n  class  DynamoCalculator :  ...  def  multiply ( self ,  x :  int ,  y :  int )  -&gt;  int :  &#34;&#34;&#34; Multiplies two integers and returns the result. &#34;&#34;&#34;  def  if_y_non_negative ():  return  self . add ( x ,  self . multiply ( x ,  self . subtract ( y ,  1 )))  def  if_y_negative ():  y_pos  =  self . subtract ( 0 ,  y )  return  self . subtract ( 0 ,  self . multiply ( x ,  y_pos ))  return  self . if_ (  self . eq ( y ,  0 ),  if_true = lambda :  0 ,  if_false = lambda  ...\n      def divide(x, y): if y &lt; 0: return -1 * divide(x, -y) else: if x &lt; y: return 0 else: return 1 + divide(x - y, y)\n    class  DynamoCalculator :  ...  def  divide ( self ,  x :  int ,  y :  int )  -&gt;  int :  &#34;&#34;&#34; Divides x by y and returns the result. Assumes y != 0. &#34;&#34;&#34;  def  if_y_negative ():  return  self . subtract ( 0 ,  self . divide ( x ,  self . subtract ( 0 ,  y )))  def  if_y_positive ():  return  self . if_ (  self . lt ( x ,  y ),  if_true = lambda :  0 ,  if_false = lambda :  self . add ( 1 ,  self . divide ( self . subtract ( x ,  y ),  y ))  )  return  self  ...\n  This is the great thing about building our calculator from a library of reusable functions and operators: we can combine them to create more sophisticated functions.\n    We can continue to compose the functions we\u2019ve already written to round out our calculator.\n  We can get \u201cnot equal to\u201d by defining a NOT operator, and applying that to the output of \u201ceq()\u201d:\n  def  not_ ( self ,  condition :  bool )  -&gt;  bool :  &#34;&#34;&#34; Returns the negation of ``condition``. &#34;&#34;&#34;  return  self . if_ (  condition ,  if_true = lambda :  False ,  if_false = lambda :  True  )  def  ne ( self ,  x :  int ,  y :  int )  -&gt;  bool :  &#34;&#34;&#34; Returns True if two integers are different, False otherwise. &#34;&#34;&#34;  return  self . not_ ( self . eq ( x ,  y ))\n  We can define \u201cless than or equal to\u201d by defining an OR operator, and applying that to the output of \u201clt()\u201d and \u201ceq()\u201d:\n  def  or_ ( self ,  condition1 :  bool ,  condition2 :  bool )  -&gt;  bool :  &#34;&#34;&#34; Returns True if at least one of ``condition1`` and ``condition2`` is True. &#34;&#34;&#34;  int_1  =  self . if_ ( condition1 ,  if_true = lambda :  1 ,  if_false = lambda :  0 )  int_2  =  self . if_ ( condition2 ,  if_true = lambda :  1 ,  if_false = lambda :  0 )  return  self . ne ( self . add ( int_1 ,  int_2 ),  0 )  def  le ( self ,  x :  int ,  y :  int )  -&gt;  ...\n  We can define \u201cgreater than\u201d and \u201cgreater than or equal to\u201d as the negation of \u201cless than or equal to\u201d and \u201cless than\u201d, respectively:\n  def  gt ( self ,  x :  int ,  y :  int )  -&gt;  bool :  &#34;&#34;&#34; Returns True if x &gt; y, False otherwise. &#34;&#34;&#34;  return  self . not_ ( self . le ( x ,  y ))  def  ge ( self ,  x :  int ,  y :  int )  -&gt;  bool :  &#34;&#34;&#34; Returns True if x &gt;= y, False otherwise. &#34;&#34;&#34;  return  self . not_ ( self . lt ( x ,  y ))\n  And finally, for completion\u2019s sake, let\u2019s define an AND operator and a NAND operator:\n  def  and_ ( self ,  condition1 :  bool ,  condition2 :  bool )  -&gt;  bool :  &#34;&#34;&#34; Returns True if both ``condition1`` and ``condition2`` are True. &#34;&#34;&#34;  int_1  =  self . if_ ( condition1 ,  if_true = lambda :  1 ,  if_false = lambda :  0 )  int_2  =  self . if_ ( condition2 ,  if_true = lambda :  1 ,  if_false = lambda :  0 )  return  self . eq ( self . add ( int_1 ,  int_2 ),  2 )  def  nand ( self ,  condition1 :  bool  ...\n  The  NAND gate is a key part of processor design, and being able to do it only using DynamoDB proves its capabaility as a computing platform.\n    This post shows the potential for using DynamoDB as a cloud computing platform. We were able to implement a simple calculator, comparison operators, and even better, a set of  logical gates (AND, OR, NOT and NAND). This lays the foundation for building far more sophisticated programs.\n  Performance remains an issue. As we \u2019d expect, simple operations (addition, subtraction) are faster than more complex operations (multiplication, division), but there \u2019s room for improvement in both areas. It \u2019s not clear whether the bottleneck is DynamoDB itself, or my home internet connection. Hopefully a future update will bring the ability to run code directly  ...\n  Pricing follows the usual AWS model of \u201cclear as mud\u201d. DynamoDB pricing is based on  how many read and write \u201cunits\u201d you use, but it\u2019s not obvious how many units a given operation might require.\n  It\u2019s too soon to recommend using DynamoDB for production compute workloads, but these early signs are promising. I hope Amazon continues to work on improving DynamoDB, and I look forward to seeing how other people use it in future.\n        DynamoDB isn\u2019t a compute platform, it\u2019s a database. Still not a question. And you\u2019re wrong \u2013 it  is a compute platform, as this experiment shows.\n  Why did you do this? Finally, a proper question! Partly for fun, partly as a way to get some practice with the gnarly bits of the DynamoDB API that I forget every time I use.\n  Can I get all the code you\u2019ve written? Sure, it\u2019s all here:\n      #!/usr/bin/env python &#34;&#34;&#34;What happens if you try to use DynamoDB as an integer calculator?&#34;&#34;&#34; import  contextlib from  typing  import  Callable import  uuid import  boto3 dynamodb  =  boto3 . resource ( &#34;dynamodb&#34; ) class  DynamoCalculator :  &#34;&#34;&#34; An integer calculator that uses DynamoDB for compute. &#34;&#34;&#34;  def  __enter__  ...", "posttime": "2020-05-03 04:19:22", "tags": "dynamodb", "title": "\u4f7f\u7528DynamoDB\u4f5c\u4e3a\u8ba1\u7b97\u5668", "title_en": "Using DynamoDB as a Calculator", "transed": 1, "url": "https://alexwlchan.net/2020/04/using-dynamodb-as-a-calculator/", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["dynamodb"]}, {"category": "", "categoryclass": "", "imagename": "", "infoid": 1000404, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u6d88\u9664\u5197\u4f59\u901a\u5e38\u88ab\u89c6\u4e3a\u63d0\u9ad8\u751f\u4ea7\u6548\u7387\u548c\u51cf\u5c11\u6d6a\u8d39\u7684\u4e00\u79cd\u65b9\u5f0f\u3002\u4f46\u662f\uff0c\u6b63\u786e\u7684\u5197\u4f59\u53ef\u4ee5\u6781\u5927\u5730\u63d0\u9ad8\u8d28\u91cf\u3002\u4f8b\u5982\uff0c\u4e2d\u4e16\u7eaa\u53d1\u660e\u7684\u590d\u5f0f\u7c3f\u8bb0\u662f\u4f1a\u8ba1\u7684\u4e00\u5927\u8fdb\u6b65\uff0c\u56e0\u4e3a\u5b83\u5f15\u5165\u4e86\u5197\u4f59\uff0c\u51e0\u4e4e\u6d88\u9664\u4e86\u5e38\u89c1\u7684\u7b97\u672f\u9519\u8bef\u3002\n\u826f\u597d\u7684\u5197\u4f59\u901a\u8fc7\u5177\u6709\u901a\u5f80\u76f8\u540c\u7ed3\u679c\u7684\u4e24\u4e2a\u72ec\u7acb\u8def\u5f84\u6765\u68c0\u6d4b\u6545\u969c\u3002\u4e00\u6761\u8def\u5f84\u4e2d\u7684\u6545\u969c\u4e0d\u4f1a\u5f71\u54cd\u53e6\u4e00\u6761\u8def\u5f84\uff0c\u56e0\u6b64\u7ed3\u679c\u4e2d\u7684\u5dee\u5f02\u8868\u660e\u5b58\u5728\u9519\u8bef\u3002\n\u4e0d\u826f\u5197\u4f59\u7684\u533a\u522b\u5728\u4e8e\u8981\u4e48\u4e0d\u63d0\u4f9b\u53ef\u68c0\u67e5\u7684\u7ed3\u679c\uff0c\u8981\u4e48\u5197\u4f59\u8def\u5f84\u76f8\u4e92\u4f9d\u8d56\uff0c\u4f7f\u5f97\u4e00\u6761\u8def\u5f84\u4e2d\u7684\u9519\u8bef\u4f20\u64ad\u5230\u53e6\u4e00\u6761\u8def\u5f84\uff0c\u56e0\u6b64\u9519\u8bef\u7684\u7ed3\u679c\u662f\u4e00\u81f4\u7684\u3002\n\u7f16\u7a0b\u8bed\u8a00\u5e7f\u6cdb\u4f7f\u7528\u5b83\u6765\u51cf\u5c11\u7f16\u7801\u9519\u8bef\u3002\u5982\u679c\u4e00\u79cd\u8bed\u8a00\u5b8c\u5168\u6ca1\u6709\u5197\u4f59\uff0c\u90a3\u4e48\u4efb\u4f55\u968f\u673a\u7684\u5b57\u7b26\u5e8f\u5217\u90fd\u662f\u6709\u6548\u7684\u7a0b\u5e8f\u3002\u7f16\u8bd1\u5668\u751f\u6210\u7684\u6bcf\u6761\u9519\u8bef\u6d88\u606f\u90fd\u662f\u67e5\u627e\u7528\u6237\u9519\u8bef\u7684\u8bed\u8a00\u4e2d\u7684\u5197\u4f59\u793a\u4f8b\u3002\u51e0\u4e4e\u6ca1\u6709\u5197\u4f59\u7684\u8bed\u8a00\u7684\u4e00\u4e2a\u4f8b\u5b50\u662f\u673a\u5668\u4ee3\u7801-\u51e0\u4e4e\u4efb\u4f55\u4f4d\u6a21\u5f0f\u90fd\u662f\u6709\u6548\u7684\u64cd\u4f5c\u7801\u3002\u4efb\u4f55\u4e3a\u673a\u5668\u4ee3\u7801\u7f16\u5199\u8fc7\u53cd\u6c47\u7f16\u7a0b\u5e8f\u7684\u4eba\u90fd\u77e5\u9053\u8fd9\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\u2026\u2026\u3002\n\u53d8\u91cf\u58f0\u660e\u5c31\u662f\u5176\u4e2d\u4e4b\u4e00\u3002\u4f46\u662f\uff0c\u7531\u4e8e\u7f16\u8bd1\u5668\u53ef\u4ee5\u6839\u636e\u4e0a\u4e0b\u6587\u8ba1\u7b97\u51fa\u58f0\u660e\u7684\u9700\u8981\uff0c\u6240\u4ee5\u58f0\u660e\u4f3c\u4e4e\u662f\u53ef\u4ee5\u4e22\u5f03\u7684\u4e3b\u8981\u5197\u4f59\u3002\u8fd9\u79f0\u4e3a\u9690\u5f0f\u53d8\u91cf\u58f0\u660e\u3002\u8fd9\u542c\u8d77\u6765\u662f\u4e2a\u597d\u4e3b\u610f\uff0c\u800c\u4e14\u5b83\u7ecf\u5e38\u88ab\u8f7d\u5165\u65b0\u7684\u8bed\u8a00\u4e2d\u3002\u95ee\u9898\u662f\uff0c\u7f16\u8bd1\u5668\u65e0\u6cd5\u533a\u5206\u9884\u671f\u7684\u65b0\u58f0\u660e\u548c\u6253\u5b57\u9519\u8bef-\u7ef4\u62a4\u4e0d\u5584\u7684\u7a0b\u5e8f\u5458\u4e5f\u65e0\u6cd5\u533a\u5206\u3002\u4e0d\u8fc7\uff0c\u8fc7\u4e86\u4e00\u6bb5\u65f6\u95f4\uff0c\u90a3\u4e2a..\u3002\n\u4e3a\u4ec0\u4e48\u9700\u8981\u5206\u53f7\uff1f\u7f16\u8bd1\u5668\u5b8c\u5168\u6709\u80fd\u529b\u5f04\u6e05\u695a\u8fd9\u4e00\u70b9\u3002\u4f46\u662f\uff0c\u5982\u679c\u662f\u8fd9\u6837\u7684\u8bdd\u5462\uff1a\n\u8fd9\u53ef\u4ee5\u662f(x=3+y*p++)\uff0c\u5176\u4e2d*\u662f\u4e58\u6cd5\u800c\u4e0d\u662f\u95f4\u63a5\u7684\u3002\u7f3a\u5c11\u5206\u53f7\u4e5f\u4f1a\u4f7f\u9519\u8bef\u6062\u590d\u53d8\u5f97\u5f88\u5dee\uff0c\u56e0\u4e3a\u7f16\u8bd1\u5668\u65e0\u6cd5\u8ba1\u7b97\u51fa\u5f53\u524d\u9519\u8bef\u8bed\u53e5\u7684\u7ed3\u675f\u4f4d\u7f6e\u548c\u4e0b\u4e00\u4e2a\u9519\u8bef\u8bed\u53e5\u7684\u5f00\u59cb\u4f4d\u7f6e\u3002\u5206\u53f7\u5728\u6587\u672c\u4e2d\u5f62\u6210\u6f02\u4eae\u7684\u201c\u951a\u201d\uff0c\u5e2e\u52a9\u7f16\u8bd1\u5668\u548c\u9605\u8bfb\u5668\u4e0e\u4ee3\u7801\u7ed3\u6784\u540c\u6b65\u3002\n(JavaScript\u662f\u4e00\u4e2a\u793a\u4f8b\uff0c\u5176\u4e2d\u5206\u53f7\u662f\u53ef\u9009\u7684\uff0c\u5e76\u4e14\u662f\u4ece\u8bed\u6cd5\u4e2d\u63a8\u65ad\u51fa\u6765\u7684\u3002Python\u4e0d\u662f\u4e00\u4e2a\u793a\u4f8b\uff0c\u56e0\u4e3a\u5b83\u4ecd\u7136\u4f7f\u7528\u50cf\\n\u8fd9\u6837\u7684\u8bcd\u6cd5\u63d0\u793a\u6765\u6307\u793a\u8bed\u53e5\u7684\u7ed3\u675f\u3002)\u3002\n\u7f16\u7a0b\u8bed\u8a00\u4e2d\u5197\u4f59\u7684\u6700\u4f73\u793a\u4f8b\u53ef\u80fd\u662f\u5355\u5143\u6d4b\u8bd5\u3002\u5355\u5143\u6d4b\u8bd5\u662f\u51fd\u6570\u529f\u80fd\u7684\u53e6\u4e00\u79cd\u89c4\u8303\uff0c\u4f46\u5b83\u4eec\u6307\u5b9a\u7684\u4e0d\u662f\u65b9\u6cd5\uff0c\u800c\u662f\u7ed3\u679c\u3002\u5728\u7ed3\u679c\u4e2d\u91cd\u73b0\u7684\u65b9\u6cd5\u4e2d\u51fa\u73b0\u76f8\u540c\u9519\u8bef\u7684\u51e0\u7387\u975e\u5e38\u3001\u975e\u5e38\u4f4e\u3002\u8fd9\u610f\u5473\u7740\u5373\u4f7f\u53ea\u9002\u5ea6\u4f7f\u7528\u5355\u5143\u6d4b\u8bd5\u4e5f\u53ef\u4ee5\u663e\u8457\u63d0\u9ad8\u7a0b\u5e8f\u8d28\u91cf\uff0c\u8fd9\u5c31\u662fD\u7f16\u7a0b\u8bed\u8a00\u5185\u7f6e\u5355\u5143\u6d4b\u8bd5\u652f\u6301\u7684\u539f\u56e0\u3002\n\u5197\u4f59\u5e76\u4e0d\u603b\u662f\u597d\u7684\u3002\u4f8b\u5982\uff0c\u5728C\u8bed\u8a00\u4e2d\uff0c\u6e90\u4ee3\u7801\u5206\u4e3a\u5934\u6587\u4ef6\u548c\u5b9e\u73b0\u6587\u4ef6\u3002\u58f0\u660e\u5728\u8fd9\u4e24\u4e2a\u7248\u672c\u4e2d\u90fd\u6709\u8f6c\u8f7d\u3002\u8fd9\u79cd\u5197\u4f59\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u526f\u672c\u662f\u5b57\u9762\u4e0a\u590d\u5236\u7684\u6587\u672c-\u5176\u4e2d\u4e00\u4e2a\u4e2d\u7684\u9519\u8bef\u88ab\u7b80\u5355\u5730\u590d\u5236\u5230\u53e6\u4e00\u4e2a\u4e2d\uff0c\u6ca1\u6709\u8d4b\u4e88\u5197\u4f59\u4efb\u4f55\u4ef7\u503c\u3002\u6709\u7528\u7684\u5197\u4f59\u9700\u8981\u662f\u72ec\u7acb\u7684\u3002\n\u4e4d\u4e00\u770b\uff0c\u8fd9\u770b\u8d77\u6765\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u5197\u4f59\u3002\u5b83\u6b63\u5728\u68c0\u67e5tmp\u7684\u7c7b\u578b\u662f\u5426\u4e3aint\u3002\u4f46\u662f\u4e0d\uff0c\u5b83\u6ca1\u6709\u68c0\u67e5\u7c7b\u578b\uff0c\u5b83\u5f3a\u5236\u7c7b\u578b\u4e3aint\uff0c\u5e76\u5c06\u521d\u59cb\u5316\u5f0f(a+b)\u8f6c\u6362\u4e3aint\u3002\u5982\u679ca\u548cb\u88ab\u91cd\u65b0\u58f0\u660e\u4e3a\u67d0\u4e2a\u5176\u4ed6\u7c7b\u578b(\u5982\u65e0\u7b26\u53f7\u6216\u6d6e\u70b9\u578b)\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u95ee\u9898\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cD\u7f16\u7a0b\u8bed\u8a00\u5f15\u5165\u4e86auto\uff0c\u5c06tmp\u58f0\u660e\u4e3a(a+b)\u7c7b\u578b\uff1a\n\u4e00\u79cd\u5e38\u89c1\u7684\u60c5\u51b5\u662fC++\u4e2d\u58f0\u660e\u548c\u8868\u8fbe\u5f0f\u4e4b\u95f4\u7684\u8bed\u6cd5\u6b67\u4e49\u3002\u4f8b\u5982\uff1a\n\u8fd9\u662f\u5c06P\u58f0\u660e\u4e3a\u6307\u5411T\u7684\u6307\u9488\uff0c\u8fd8\u662f\u5c06T\u548cP\u76f8\u4e58\uff1f\u5728\u8fd9\u91cc\uff0c\u5c11\u91cf\u7684\u5197\u4f59\u5c06\u4f1a\u6709\u5f88\u5927\u7684\u5e2e\u52a9\u3002\n\u5728C++\u4e2d\uff0c\u91cd\u8f7d\u4f7f\u7528&lt\uff1b\u548c&gt\uff1b\u6765\u8868\u793a\u6a21\u677f\u53c2\u6570\u5217\u8868\u3002\u4ec0\u4e48\u529f\u80fd\uff1a\n\u523b\u8584\uff1f\u8fd9\u79cd\u7f3a\u4e4f\u5197\u4f59\u6027\u7684\u540e\u679c\u662f\u51fa\u4e86\u540d\u7684\u8fdf\u949d\u9519\u8bef\u6d88\u606f\uff0c\u56e0\u4e3a\u7f16\u8bd1\u5668\u6ca1\u6709\u592a\u591a\u7684\u4fe1\u606f\u6765\u6307\u5bfc\u5b83\u731c\u6d4b\u7528\u6237\u7684\u610f\u56fe\u3002\nC++\u6dfb\u52a0\u4e86\u4e00\u4e9b\u5173\u952e\u5b57\uff0c\u5982typeName\uff0c\u4ee5\u53ca\u4e00\u4e9b\u4ea7\u54c1\uff0c\u5982-&gt\uff1btemplate\uff0c\u4ee5\u589e\u52a0\u5197\u4f59\uff0c\u4ece\u800c\u6539\u8fdb\u9519\u8bef\u68c0\u67e5\u548c\u8bca\u65ad\u3002\n\u901a\u8fc7\u67e5\u770b\u7f16\u8bd1\u5668\u5b9e\u73b0\u8005\u503e\u5411\u4e8e\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u6dfb\u52a0\u7684\u8b66\u544a\u8bca\u65ad\uff0c\u60a8\u53ef\u4ee5\u611f\u89c9\u5230\u8bed\u8a00\u4e2d\u7f3a\u5c11\u5197\u4f59\u7684\u5730\u65b9\u3002\u5bf9\u4e8e\u65b0\u8bed\u8a00\u7684\u8bbe\u8ba1\u8005\u6765\u8bf4\uff0c\u5e38\u89c1\u7684\u8b66\u544a\u662f\u6539\u8fdb\u7075\u611f\u7684\u4e30\u5bcc\u6765\u6e90\u3002\n\u8bb8\u591a\u7f16\u7a0b\u8bed\u8a00\u8bbe\u8ba1\u8005\u9519\u8bef\u5730\u8ba4\u4e3a\u6d88\u9664\u5197\u4f59\u53ef\u4ee5\u63d0\u9ad8\u7a0b\u5e8f\u5458\u7684\u5de5\u4f5c\u6548\u7387\u3002\u8fd9\u4e00\u70b9\u901a\u8fc7\u5c0f\u7684\u57fa\u51c6\u6765\u5c55\u793a\uff0c\u8868\u660e\u5b83\u4eec\u662f\u591a\u4e48\u7b80\u6d01\uff0c\u6697\u793a\u7b80\u6d01\u4f7f\u4e00\u79cd\u8bed\u8a00\u53d8\u5f97\u5f3a\u5927\u548c\u5bcc\u6709\u8868\u73b0\u529b\u3002\u8fd9\u5bf9\u4e8e\u5c0f\u7a0b\u5e8f\u786e\u5b9e\u5f88\u6709\u6548\uff0c\u6bd4\u5982\u53ea\u6709\u51e0\u4e2a\u811a\u672c", "note_en": "Eliminating redundancy is often viewed as a way to streamline\rproductivity and reduce waste. But the right kind of redundancy\rcan dramatically improve quality. For example,\r double entry bookkeeping,\rinvented in the middle ages, was a great advance\rin accounting because it introduced a redundancy that nearly eliminated\rcommon arithmetic errors.\n    A good redundancy detects faults by having two independent\rpaths to the same result. A failure in one path does not affect the other,\rso the discrepancy in result indicates an error.\n  A bad redundancy is distinguished by either not providing a checkable\rresult, or by having the redundant paths dependent on each other in\rsuch a way that an error in one path propagates to the other, so the wrong\rresults agree.\n  Programming languages extensively use this to reduce coding errors. If there was no redundancy at all in a language, then any random sequence of characters would be a valid program. Every error message generated by the compiler is an example of redundancy in the language that finds user errors. An example of a language with next to no redundancy is machine code \u2014nearly any bit pattern is a valid opcode. Anyone who \u2019s written a disassembler for machine code knows that it \u2019s nearly impossible  ...\n    Variable declarations are one. But since the compiler can figure the need for declarations from the context, declarations seem like prime redundancies that can be jettisoned. This is called implicit variable declaration. It sounds like a great idea, and it gets regularly enshrined into new languages. The problem is, the compiler cannot tell the difference between an intended new declaration and a typo \u2014and the poor maintenance programmer can \u2019t tell, either. After a while, though, the  ...\n      why would semicolons be needed? The compiler is perfectly capable of figuring\rthat out. But what about:\n    that could be  (x = 3 + y * p++) where the  * is a multiply rather than an\rindirection. Lack of semicolons also makes error recovery poor, as the\rcompiler cannot figure out where the current wrong statement ends and the\rnext one starts. Semicolons make for nice \u201canchors\u201d in the text that help\rboth the compiler and the reader synchronize with the code structure.\n  (Javascript is an example where the semicolon is optional and is inferred\rfrom the grammar. Python is not an example, because it still uses lexical\rcues like  \\n to indicate the end of a statement.)\n  Probably the best example of redundancy in a programming language is\runit tests. Unit tests are an alternative specification for what a function\rdoes, but rather than specify the method, they specify the results.\rThe odds of the same error in the method being reproduced in the results\rare very, very low. This means that even only moderate use of\runit tests can dramatically improve program quality, which is why\runit test support is built in to the D programming language.\n    Redundancy isn\u2019t always good. In C, for example, source code is divided\rup into header files and implementation files. The declarations are reproduced\rin both. The problem with this redundancy is that the copies are literally\rcopied text \u2014 an error in one is simply copied to the other, giving no\rvalue to the redundancy. A useful redundancy needs to be independent.\n      At first glance, this looks like a good redundancy. It\u2019s checking that the\rtype of  tmp is  int. But no, it isn\u2019t checking the type, it\u2019s forcing\rthe type to be  int, and converting the initializer  (a+b) to be  int.\rThis can result in problems if  a and  b are redeclared as some other type,\rlike  unsigned or  float. To\rsolve this problem, the D programming language has introduced  auto to\rhave  tmp declared as the type of  (a+b):\n        A common case is the syntactic ambiguity between declarations and expressions\rin C++. For example:\n    Is that a declaration of  P as a pointer to  T, or is it multiplying  T and  P?\rA little redundancy would go a long way here.\n  There\u2019s the overloaded use of  &lt; and  &gt; to denote template argument lists in C++.\rWhat does:\n    mean? The consequence of this lack of redundancy is notoriously obtuse error\rmessages as the compiler has too little to guide it in guessing at what\rthe user\u2019s intent is.\n  C++ has added some keywords, like  typename, and some productions, like\r -&gt;template, to add redundancy and so improve\rerror checking and diagnostics.\n  You can get a feel for where redundancy in a language is lacking by looking\rat warning diagnostics the compiler implementors tend to add over time.\rFor the designer of a new language, common warnings are a rich source of\rinspiration for improvements.\n    Many programming language designers mistakenly assume that removing redundancy makes programmers more productive. This is exhibited with small benchmarks showing how terse they are, with the implication that terseness makes a language powerful and expressive. And this does work great for small programs, such as scripts that are only a few lines long. But it doesn \u2019t scale well, and this rapidly becomes apparent as the source code gets larger and  ...\n  Well\u2014designed redundancy can, however, dramatically improve productivity\rwith its ability to uncover errors early in the development process.\rRedundancy not only helps find errors, it helps produce better error\rmessages, and helps the maintenance programmer in understanding the intent\rof the code.\n  The trick, of course, is figuring out which redundancies are good,\rand which aren\u2019t.", "posttime": "2020-05-03 04:19:16", "tags": "\u7f16\u7a0b,programming language,\u7f16\u7a0b\u8bed\u8a00,programming,\u9519\u8bef", "title": "\u7f16\u7a0b\u8bed\u8a00\u4e2d\u7684\u5197\u4f59", "title_en": "Redundancy in Programming Languages", "transed": 1, "url": "https://www.digitalmars.com/articles/b05.html", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u7f16\u7a0b", "language", "\u7f16\u7a0b\u8bed\u8a00", "\u9519\u8bef"]}, {"category": "", "categoryclass": "", "imagename": "", "infoid": 1000403, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u4ece\u4e00\u5f00\u59cb\uff0cBluecore\u5c31\u8fd0\u884c\u5728Google Cloud Platform(GCP)\u4e0a\u3002\u5230\u4e86\u6784\u5efa\u9ad8\u6027\u80fd\u670d\u52a1\u7684\u65f6\u5019\uff0c\u6211\u4eec\u81ea\u7136\u800c\u7136\u5730\u5e0c\u671b\u5229\u7528GCP\u57fa\u7840\u8bbe\u65bd\uff0c\u800c\u4e0d\u662f\u81ea\u5df1\u6784\u5efa\u5b83\u3002\u901a\u8fc7\u4f7f\u7528Kubernetes(GKE)\u3001Redis(MemoryStore)\u3001BigTable\u548c\u5176\u4ed6GCP\u6280\u672f\uff0c\u6211\u4eec\u80fd\u591f\u6784\u5efa\u5177\u6709\u8db3\u591f\u5e26\u5bbd\u548c\u5ef6\u8fdf\u7684\u670d\u52a1\uff0c\u6bcf\u79d2\u53d1\u900110000\u4e2a\u4e2a\u6027\u5316\u63a8\u8350\u3002\n\u4f60\u5f88\u53ef\u80fd\u6536\u5230\u4e86\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\uff0c\u5f15\u8bf1\u4f60\u8d2d\u4e70\u4f60\u653e\u5728\u7f51\u4e0a\u8d2d\u7269\u8f66\u91cc\u7684\u4e00\u79cd\u4ea7\u54c1\uff0c\u800c\u4e14\u5b83\u53ef\u80fd\u8fd8\u9644\u5e26\u4e86\u4e00\u4e9b\u5176\u4ed6\u63a8\u8350\u7684\u4ea7\u54c1\u3002\u6211\u4eec\u662f\u600e\u4e48\u60f3\u51fa\u8fd9\u4e9b\u4ea7\u54c1\u6765\u63a8\u8350\u6d88\u8d39\u8005\u7684\u5462\uff1f\u5728Bluecore\uff0c\u6211\u4eec\u901a\u8fc7\u4e24\u79cd\u65b9\u5f0f\u521b\u5efa\u4ea7\u54c1\u63a8\u8350\uff1a\u901a\u8fc7\u4ea7\u54c1\u63a8\u8350\u6216\u901a\u8fc7\u6d88\u8d39\u8005\u884c\u4e3a\u63a8\u8350\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u6839\u636e\u6700\u8fd1\u67e5\u770b\u6216\u4ee5\u524d\u8d2d\u4e70\u7684\u4ea7\u54c1\u6765\u63a8\u8350\u4ea7\u54c1\u3002Bluecore\u5df2\u7ecf\u5f00\u53d1\u51fa\u5f3a\u5927\u7684\u6570\u636e\u6a21\u578b\u6765\u8ba1\u7b97.\u3002\n\u5c06\u4ea7\u54c1\u6620\u5c04\u5230\u7528\u6237\u5e76\u4e0d\u662f\u4e00\u4e2a\u770b\u8d77\u6765\u90a3\u4e48\u7b80\u5355\u7684\u8fc7\u7a0b\u3002\u6211\u4eec\u8bc4\u4f30\u6709\u5173\u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u5c06\u54ea\u4e9b\u4ea7\u54c1\u63d2\u5165\u7535\u5b50\u90ae\u4ef6\u7684\u89c4\u5219\u3002\u4f8b\u5982\uff0c\u4e0d\u5305\u62ec\u7f3a\u8d27\u6216\u6253\u6298\u7684\u4ea7\u54c1\u3002\u56e0\u4e3a\u6211\u4eec\u53ea\u5c55\u793a\u6709\u6548\u7684\u4ea7\u54c1\u662f\u5f88\u91cd\u8981\u7684\uff0c\u6211\u4eec\u5fc5\u987b\u6709\u4e00\u4e2a\u6700\u65b0\u7684\u4ea7\u54c1\u76ee\u5f55\u3002\u5bf9\u4e8e\u4efb\u4f55\u4e00\u5bb6\u7ed9\u5b9a\u7684\u96f6\u552e\u5e97\uff0c\u4ea7\u54c1\u90fd\u662f\u4e0d\u65ad\u53d8\u5316\u7684\u3002\u56e0\u6b64\uff0c\u4f7f\u6211\u4eec\u7684\u4ea7\u54c1\u4fdd\u6301\u6700\u65b0\u9700\u8981\u5176\u81ea\u8eab\u7684\u670d\u52a1\u3002\n\u867d\u7136\u7535\u5b50\u90ae\u4ef6\u662f\u6211\u4eec\u7684\u4e3b\u8981\u4ea7\u54c1\uff0c\u4f46Bluecore\u4e5f\u5728\u96f6\u552e\u5546\u7684\u7f51\u7ad9\u4e0a\u63d0\u4f9b\u5b9e\u65f6\u4ea7\u54c1\u63a8\u8350\uff0c\u8fd9\u5e26\u6765\u4e86\u6bd4\u7535\u5b50\u90ae\u4ef6\u66f4\u4e25\u683c\u7684\u5ef6\u8fdf\u9650\u5236\u3002\u73b0\u573a\u63a8\u8350\u8feb\u4f7f\u6211\u4eec\u91cd\u65b0\u8003\u8651\u6211\u4eec\u7684\u63a8\u8350\u57fa\u7840\u8bbe\u65bd\u3002\u63a8\u8350\u670d\u52a1\u7684\u6784\u5efa\u8003\u8651\u5230\u4e86Bluecore\u7684\u5de5\u7a0b\u4ef7\u503c\u4e4b\u4e00\uff0c\u5373\u6784\u5efa\u201c\u5c3d\u53ef\u80fd\u7b80\u5355\uff0c\u5c3d\u53ef\u80fd\u5f3a\u5927\u201d\u7684\u4e1c\u897f\u3002\u5728\u63a8\u8350\u670d\u52a1\u7684\u6574\u4e2a\u53d1\u5c55\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u2026\u2026\u3002\n\u5236\u4f5c\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\u6709\u4e09\u4e2a\u7ec4\u6210\u90e8\u5206\uff1a\u6a21\u677f(\u7535\u5b50\u90ae\u4ef6\u7684\u8bbe\u8ba1\u5927\u7eb2)\u3001\u53d7\u4f17(\u5c06\u63a5\u6536\u7535\u5b50\u90ae\u4ef6\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u5217\u8868)\u548c\u63a8\u8350(\u6211\u4eec\u638c\u63e1\u7684\u6bcf\u4e2a\u6536\u4ef6\u4eba\u7684\u6570\u636e\u79d1\u5b66\u6a21\u578b\u6d3e\u751f\u7684\u503c)\u3002\u6a21\u677f\u5728\u4e91\u6570\u636e\u5b58\u50a8\u4e2d\uff0c\u6211\u4eec\u7684\u53d7\u4f17\u5728BigQuery\u4e2d\u751f\u6210\uff0c\u6211\u4eec\u7684\u63a8\u8350\u5728\u6570\u636e\u5b58\u50a8\u4e2d\u3002\u7535\u5b50\u90ae\u4ef6\u662f\u5728Google App Engine Standard(GAE)\u4e2d\u751f\u6210\u7684\uff0c\u6211\u4eec\u6309\u6bcf\u5c01\u7535\u5b50\u90ae\u4ef6\u67e5\u8be2\u4e91\u6570\u636e\u5b58\u50a8(\u6709\u65f6.\u3002\n\u597d\u5427\uff0c\u4e0d\u3002\u6b63\u5982\u6211\u4eec\u4e4b\u524d\u63d0\u5230\u7684\uff0c\u6211\u4eec\u73b0\u5728\u652f\u6301\u5f53\u6d88\u8d39\u8005\u5728\u7f51\u7ad9\u4e0a\u65f6\u663e\u793a\u7684\u63a8\u8350\u3002\u8fd9\u610f\u5473\u7740\u5ef6\u8fdf\u73b0\u5728\u786e\u5b9e\u5f88\u91cd\u8981\u3002\u4ece\u4ec5\u9650\u7535\u5b50\u90ae\u4ef6\u5230\u540c\u65f6\u63d0\u4f9b\u73b0\u573a\u548c\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u7684\u8f6c\u53d8\u8feb\u4f7f\u6211\u4eec\u91cd\u65b0\u8bc4\u4f30\u6211\u4eec\u7684\u67b6\u6784\u3002\u73b0\u573a\u5efa\u8bae\u8981\u6c42\u6211\u4eec\u6709\u66f4\u4e25\u683c\u7684SLO(300-400\u6beb\u79d2)\u3002\u5728\u7f51\u7ad9\u5f00\u59cb\u611f\u89c9\u7f13\u6162\u4e4b\u524d\uff0c\u8fd9\u5c31\u662f\u4f60\u5f97\u5230\u7684\u5168\u90e8\u4fe1\u606f\u3002\u5728\u8003\u8651\u5230\u5176\u4ed6\u670d\u52a1\u3001\u7f51\u7edc\u548c\u4f20\u8f93\u5230.\u7684\u60c5\u51b5\u4e0b\uff0c\u5efa\u8bae\u83b7\u53d6\u53ea\u662f\u52a0\u8f7d\u65f6\u95f4\u7684\u4e00\u90e8\u5206\u3002\n\u53d7\u4f17(\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u5217\u8868)\u751f\u6210\u548c\u4e2a\u6027\u5316(\u5c06\u5730\u5740\u4e0e\u4ed6\u4eec\u7684\u63a8\u8350\u8fdb\u884c\u6620\u5c04)\u662f\u5206\u5f00\u7684\uff0c\u8fd9\u610f\u5473\u7740\u6a21\u677f\u4ec5\u9650\u4e8e\u9644\u52a0\u5230\u53d7\u4f17\u67e5\u8be2\u884c\u7684\u6570\u636e\u3002\u5982\u679c\u63a8\u8350\u7c7b\u578b\u5728\u5355\u4e2a\u6a21\u677f\u5185\u8fdb\u884c\u4e2a\u6027\u5316\uff0c\u5219\u53d7\u4f17\u67e5\u8be2\u5c06\u65e0\u6cd5\u7ba1\u7406\u3002\n\u5728\u65b0\u7248\u672c\u7684\u63a8\u8350\u670d\u52a1\u4e2d\uff0c\u6211\u4eec\u60f3\u8981\u505a\u4e94\u4ef6\u57fa\u672c\u7684\u4e8b\u60c5\uff1a\n\u8003\u8651\u5230\u6211\u4eec\u7684\u65b0\u76ee\u6807\uff0c\u672c\u7740\u201c\u5c3d\u53ef\u80fd\u7b80\u5355\uff0c\u5c3d\u53ef\u80fd\u5f3a\u5927\u201d\u7684\u7cbe\u795e\uff0c\u8ba9\u6211\u4eec\u6784\u5efa\u4e00\u4e2a\u5929\u771f\u7684\u670d\u52a1\u5b9e\u73b0\u3002\u6211\u4eec\u77e5\u9053\u6211\u4eec\u9700\u8981GRPC\u670d\u52a1\uff0c\u6211\u4eec\u7684\u63a8\u8350\u6570\u636e\u6765\u81eaBigQuery/Datastore\uff0c\u800c\u6211\u4eec\u7684\u4ea7\u54c1\u6570\u636e\u9a7b\u7559\u5728Datastore\u4e2d\u3002\u6211\u4eec\u7684\u63a8\u8350\u670d\u52a1(\u7528GO\u7f16\u5199)\u652f\u6301\u8fd0\u884c\u65f6\u4e2a\u6027\u5316\uff0c\u56e0\u4e3a\u73b0\u5728\u6211\u4eec\u5c06\u4ea7\u54c1\u548c\u63a8\u8350\u6570\u636e\u63d0\u4f9b\u7ed9\u670d\u52a1\uff0c\u5e76\u5c06\u63a8\u8350\u7684\u4ea7\u54c1\u63d0\u4f9b\u7ed9\u4e2a\u6027\u5316\u2026\u2026\u3002\n\u6570\u636e\u5b58\u50a8\u975e\u5e38\u6602\u8d35\uff0c\u800c\u4e14BigQuery\u65e0\u6cd5\u6ee1\u8db3\u6211\u4eec\u7684\u5ef6\u8fdf\u8981\u6c42\u3002\u6240\u4ee5\u518d\u8bf4\u4e00\u6b21\uff0c\u4e0d\u662f\u3002\u5373\u4f7f\u6211\u4eec\u5c06\u6240\u6709\u5efa\u8bae\u5bfc\u51fa\u5230\u6570\u636e\u5b58\u50a8\u533a\uff0c\u6211\u4eec\u4ecd\u7136\u65e0\u6cd5\u8fbe\u5230\u5ef6\u8fdf\u76ee\u6807\u3002\u4e0d\u8fc7\u6ca1\u5173\u7cfb\uff0c\u6211\u4eec\u4e0d\u80fd\u8d23\u602a\u9524\u5b50\u662f\u4e2a\u574f\u87ba\u4e1d\u5200\uff0c\u6211\u4eec\u53ea\u662f\u9700\u8981\u5408\u9002\u7684\u5de5\u5177\uff01\n\u8ba9\u6211\u4eec\u628a\u91cd\u70b9\u653e\u5728\u5982\u4f55\u6539\u8fdb\u56fe\u8868\u7684\u201cRECS\u201d\u90e8\u5206\u3002\u5efa\u8bae\u88ab\u5199\u5165BigQuery\u6216Google Cloud Storage(GCS)\uff0c\u7136\u540e\u4e00\u4e9b\u88ab\u52a0\u8f7d\u5230\u6570\u636e\u5b58\u50a8\u4e2d\u3002\u76f8\u53cd\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6765\u81eaBigQuery\u548cGCS\u7684\u6240\u6709\u63a8\u8350\u52a0\u8f7d\u5230BigTable\u4e2d\u3002BigQuery Storage API\u7684\u53d1\u5e03\u4f7f\u5f97\u4eceBigQuery\u4e2d\u63d0\u53d6\u6d77\u91cf\u6570\u636e\u53d8\u5f97\u66f4\u5feb\u3002\u6211\u4eec\u56fa\u5b9a\u7684\u63a8\u8350\u6a21\u5f0f\u4f7f\u8303\u56f4\u4fdd\u6301\u5728\u53ef\u7ba1\u7406\u7684\u8303\u56f4\u5185\u3002\n\u5728\u8003\u8651\u63d0\u9ad8\u6027\u80fd\u65f6\uff0c\u5f88\u591a\u65f6\u5019\u7b54\u6848\u662f\u5b9e\u73b0\u7f13\u5b58\u3002\u5728\u6211\u4eec\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e0d\u662f\u4e00\u4e2a\u597d\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u56e0\u4e3a\u63a5\u6536\u8005\u7684\u63a8\u8350\u6570\u636e\u5728\u5176\u65e0\u6548\u4e4b\u524d\u5f88\u53ef\u80fd\u53ea\u88ab\u8bfb\u53d6\u4e00\u6b21\u3002\u7f13\u5b58\u672a\u547d\u4e2d\u610f\u5473\u7740\u6211\u4eec\u5c06\u4ece\u6e90\u8bfb\u53d6\uff0c\u4ece\u800c\u5bfc\u81f4\u5ef6\u8fdf\u3001\u91d1\u94b1\u6216\u4e24\u8005\u90fd\u8981\u4ed8\u51fa\u4ee3\u4ef7\uff0c\u5c31\u50cf\u6211\u4eec\u5728\u524d\u9762\u7684\u7cfb\u7edf\u56fe\u4e2d\u6240\u8bf4\u7684\u90a3\u6837\u3002\u7136\u800c\uff0cBigtable\u5728\u53d7\u5230\u91cd\u521b\u65f6\u8868\u73b0\u826f\u597d\u3002E", "note_en": "From the beginning, Bluecore has run on the  Google Cloud Platform (GCP). When it came time to build a high-performance service, it was only natural that we looked to leverage the GCP infrastructure, rather than building it ourselves. By using Kubernetes ( GKE),  Redis ( MemoryStore),  Bigtable, and other GCP technologies, we were able to build a service with sufficient bandwidth and latency to send 10,000s of personalized recommendations per second.\n  You \u2019ve most likely received an email tempting you to buy a product you left in your online shopping cart, and it probably also came with a few other recommended products. How did we come up with these products to recommend the consumer? At Bluecore, we create product recommendations in two ways: via a product or via the consumer \u2019s behavior. For example, a product may be recommended based on one that was recently viewed or previously purchased. Bluecore has developed powerful data models to calculate  ...\n  Mapping products to users is not as simple a process as it seems. We evaluate rules about which products we can insert into the email at runtime. For example, to exclude products that are out of stock or on discount. Since it is important that we only show valid products, we must have an up-to-date product catalog. Products change constantly for any given retail store. Therefore, keeping our products up-to-date requires a service of its own.\n Though email is our primary product, Bluecore also provides real-time product recommendations on retailer\u2019s websites, which introduces much tighter latency bounds than email would otherwise require. Onsite recommendations forced us to rethink our recommendations infrastructure. The recommendations service was built with one of Bluecore\u2019s engineering values in mind, to build things  \u201cas simple as possible, as powerful as necessary.\u201dThroughout the evolution of the recommendations service, we have  ...\n   Three components go into making an email: the template (design outline of the email), the audience (the list of email addresses that will receive an email), and the recommendations (the values derived from the data science models per recipient we have information on). The templates live in  Cloud Datastore, our audiences are generated in  BigQuery, and our recommendations are in Datastore. Emails are generated in  Google App Engine Standard(GAE), and we query Cloud Datastore as each email (sometimes  ...\n  Well, no. As we mentioned before, we now support recommendations shown while the consumer is on the website. This means latency does matter now. The shift from email-only to both on-site and email services forced us to re-evaluate our architecture. Onsite recommendations require that we have a much tighter SLO of 300 \u2013400 ms. This is about all you get before a website starts to feel slow. Recommendation fetching is only part of the load time given that other services, network, and transit to  ...\n Audience (list of email addresses) generation and personalization (mapping an address with their recommendations) were separate, which means that templates were limited to data appended to the rows of the audience query. If the type of recommendation were personalized within a single template, the audience query would be unmanageable.\n  In the new version of the recommendation service we want to do five basic things:\n   With our new goals in mind, and in the spirit of being  \u201cas simple as possible, as powerful as necessary,\u201d let\u2019s build a naive implementation of the service. We know we want a  gRPC service, our recommendations data comes from BigQuery/Datastore, and our product data lives in Datastore. Our recommendations service, written in  Go, supports runtime personalization because now we feed the products and recommendations data to a service and give those recommended products to the personalization  ...\n   Datastore is expensive and Bigquery can\u2019t meet our latency requirements. So again, no. Even if we exported all of our recommendations to Datastore, we  still wouldn\u2019t hit our latency goals. That\u2019s okay though, we can\u2019t blame a hammer for being a bad screwdriver, we just need the right tool!\n   Let\u2019s focus on how we can improve the \u201crecs\u201d portion of our diagram. Recommendations were written to BigQuery or  Google Cloud Storage (GCS), then some were loaded into Datastore. Instead, we could load all of our recommendations from BigQuery and GCS into Bigtable. The release of the  BigQuery Storage API made pulling massive volumes of data from BigQuery fast. Our fixed schema for recommendations kept the scope manageable.\n    When thinking about improving performance, many times the answer is to implement caching. In our case, this isn \u2019t a good solution because a recipient \u2019s recommendations data is most likely only read once before it is invalidated. Cache-miss means that we would read from the source, costing us latency, money, or both as in our previous system diagram. Bigtable, however, performs well when hit hard. Even with only three instances handling 5,000 requests, per second, we saw latency of 15  ...\n  Although we improved our recommendation part of our pipeline, we are still lacking with products. Datastore is still burning a hole in our wallet, and we are still failing our on-site latency requirements.\n   Let\u2019s talk about latency. Our products are ~2KB of data (they contain information about various attributes like green, shirt, short-sleeved, etc.). Datastore latencies are 46.5 ms + 4.2 ms/key. This isn\u2019t great, but not disqualifying. Memorystore latencies are 0.09 ms + 0.033 ms/key. This is outstanding! Memorystore takes home the belt.\n   Unlike recommendations, the same products are used thousands of times in a single batch of emails, so caching is a good fit \u2014 we will read the same product many times before it is invalidated. To handle this, we created a GKE-based service, written in Go, called the product update listener.\n  Product catalogs are maintained by our GAE application. Two updates for the same product may come in simultaneously, with the last write to Datastore winning. That makes cache invalidation a challenge. We could have had a short time-to-live (TTL) on cached items, but that would have cost a lot of runtime efficiency unless we had some kind of gate to keep all the recommendation service nodes from trying to fetch from Datastore at the same time. Instead, the product update listener receives  ...\n  Our cache holds objects in Datastore transmitted as  protobuf. While products across partners have different schemas, within a single retailer there is a lot of consistency and repetition. That made products, which average 2KB, a prime candidate for compression. However, most compression schemes do not do well on small files. The authors of  Zstandard recognized this problem and added features specifically to improve performance on  small files. The chart below shows that popular compression  ...\n   Utilizing GCP tools has improved our performance tremendously. Recommendations now come from Bigtable, giving us back literally seconds of latency. Our product cache hit rates are usually above 99.9% because of the long TTL enabled by the proactive refresh from the product update listener. We also improved performance by adding a small  LRU cache with a short TTL, keeping the Memorystore traffic down to a dull roar. So, finally,  YES! It is as powerful as necessary.\n   Let\u2019s prove that we meet our goals. We deployed our service to a GKE cluster, cloned and anonymized data, created attacker clients in Go, and collected metrics for the results. Thanks to the power of GKE, we were able to scale both the service and the attacking clients with a single command. The entire run, including rescaling the components was scripted and hands-off.\n    The main takeaway from this graph is that we were able to handle well above our bandwidth goal of 20 kHz. Woo hoo!\n  The process of creating a recommendation service that meets our goals shows the importance of knowing the strengths of the tools that your service or application is using. GCPs breadth of offerings enabled us to build an incredible service with just a handful of engineers. Here is an overview we use GCP tools in the recommendation service:", "posttime": "2020-05-03 04:19:05", "tags": "\u63a5\u6536,gcp,\u63a8\u8350,recommendations", "title": "\u4f7f\u7528GCP\u4e3a\u6bcf\u79d220K\u4e2a\u6027\u5316\u63a5\u6536\u63d0\u4f9b\u670d\u52a1", "title_en": "Using GCP to Serve 20K Personalized Recs per Second", "transed": 1, "url": "https://medium.com/bluecore-engineering/using-google-cloud-to-serve-10-000s-of-personalized-recs-per-second-d86b7cf6b6da", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u63a5\u6536", "gcp", "\u63a8\u8350"]}, {"category": "", "categoryclass": "", "imagename": "", "infoid": 1000402, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u6211\u7684\u804c\u4e1a\u751f\u6daf\u4e00\u76f4\u662f\u5173\u4e8e\u8bbe\u8ba1\u7f16\u7a0b\u8bed\u8a00\u548c\u4e3a\u5b83\u4eec\u7f16\u5199\u7f16\u8bd1\u5668\u3002\u8fd9\u5bf9\u6211\u6765\u8bf4\u662f\u4e00\u79cd\u5de8\u5927\u7684\u5feb\u4e50\u548c\u6ee1\u8db3\u611f\uff0c\u5982\u679c\u60a8\u51b3\u5b9a\u8bbe\u8ba1\u548c\u5b9e\u73b0\u4e00\u79cd\u4e13\u4e1a\u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u4e5f\u8bb8\u6211\u53ef\u4ee5\u5e2e\u52a9\u5176\u4ed6\u4eba\u89c2\u5bdf\u4e00\u4e0b\u60a8\u7684\u9700\u6c42\u3002\u5f53\u7136\uff0c\u8fd9\u662f\u4e00\u4e2a\u5168\u4e66\u7bc7\u5e45\u7684\u4e3b\u9898\uff0c\u6240\u4ee5\u6211\u5728\u8fd9\u91cc\u53ea\u4f1a\u987a\u5176\u81ea\u7136\u5730\u8c08\u51e0\u4e2a\u8981\u70b9\uff0c\u800c\u907f\u5f00\u5728\u5176\u4ed6\u5730\u65b9\u5df2\u7ecf\u5f88\u597d\u5730\u8ba8\u8bba\u8fc7\u7684\u8bdd\u9898\u3002\n\u9996\u5148\uff0c\u4f60\u6709\u5f88\u591a\u5de5\u4f5c\u8981\u505a\u3002\u591a\u5e74\u7684\u5de5\u4f5c\uff0c\u5176\u4e2d\u5927\u90e8\u5206\u5c06\u5728\u6c99\u6f20\u4e2d\u6e38\u8361\u3002\u6210\u529f\u7684\u673a\u4f1a\u5bf9\u4f60\u4e0d\u5229\u3002\u5982\u679c\u4f60\u6ca1\u6709\u5f3a\u70c8\u7684\u81ea\u6211\u6fc0\u52b1\u53bb\u505a\u8fd9\u4ef6\u4e8b\uff0c\u5b83\u662f\u4e0d\u4f1a\u53d1\u751f\u7684\u3002\u5982\u679c\u4f60\u9700\u8981\u522b\u4eba\u7684\u8ba4\u53ef\u548c\u9f13\u52b1\uff0c\u8fd9\u662f\u4e0d\u4f1a\u53d1\u751f\u7684\u3002\n\u5e78\u8fd0\u7684\u662f\uff0c\u505a\u8fd9\u6837\u4e00\u4e2a\u9879\u76ee\u4e0d\u662f\u4e00\u5927\u7b14\u94b1\u7684\u6295\u8d44\uff0c\u5373\u4f7f\u4f60\u5931\u8d25\u4e86\uff0c\u5b83\u4e5f\u4e0d\u4f1a\u8ba9\u4f60\u5d29\u6e83\u3002\u5373\u4f7f\u4f60\u771f\u7684\u5931\u8d25\u4e86\uff0c\u53d6\u51b3\u4e8e\u9879\u76ee\u8fdb\u5c55\u5230\u4ec0\u4e48\u7a0b\u5ea6\uff0c\u5b83\u5728\u4f60\u7684\u7b80\u5386\u4e0a\u770b\u8d77\u6765\u4e5f\u4f1a\u76f8\u5f53\u4e0d\u9519\uff0c\u5bf9\u4f60\u7684\u804c\u4e1a\u751f\u6daf\u4e5f\u6709\u597d\u5904\u3002\n\u6709\u4e00\u4ef6\u4e8b\u975e\u5e38\u6e05\u695a\uff0c\u90a3\u5c31\u662f\u8bed\u6cd5\u5f88\u91cd\u8981\u3002\u8fd9\u975e\u5e38\u91cd\u8981\u3002\u8fd9\u5c31\u50cf\u6c7d\u8f66\u4e0a\u7684\u9020\u578b-\u5982\u679c\u9020\u578b\u4e0d\u5438\u5f15\u4eba\uff0c\u90a3\u4e48\u8868\u6f14\u518d\u706b\u7206\u4e5f\u65e0\u5173\u7d27\u8981\u3002\u8bed\u6cd5\u5fc5\u987b\u662f\u60a8\u7684\u76ee\u6807\u53d7\u4f17\u559c\u6b22\u7684\u5185\u5bb9\u3002\n\u5c1d\u8bd5\u4f7f\u7528\u4ed6\u4eec\u4ee5\u524d\u4ece\u672a\u89c1\u8fc7\u7684\u4e1c\u897f\uff0c\u5c06\u4f7f\u8bed\u8a00\u91c7\u7528\u53d8\u5f97\u66f4\u96be\u63a8\u9500\u3002\n\u6211\u559c\u6b22\u628a\u719f\u6089\u7684\u53e5\u6cd5\u548c\u7f8e\u611f\u7ed3\u5408\u5728\u4e00\u8d77\u3002\u5b83\u5fc5\u987b\u5728\u5c4f\u5e55\u4e0a\u770b\u8d77\u6765\u5f88\u597d\u770b\u3002\u6bd5\u7adf\uff0c\u60a8\u5c06\u82b1\u8d39\u5927\u91cf\u65f6\u95f4\u6765\u7814\u7a76\u5b83\u3002\u5982\u679c\u5b83\u770b\u8d77\u6765\u7b28\u62d9\u3001\u7b28\u62d9\u6216\u96be\u770b\uff0c\u90a3\u4e48\u5b83\u5c31\u4f1a\u73b7\u6c61\u8bed\u8a00\u3002\n\u4e5f\u8bb8\u4ee4\u4eba\u60ca\u8bb6\u7684\u662f\uff0c\u6211\u5efa\u8bae\u7684\u51e0\u4ef6\u4e8b\u4e0d\u5e94\u8be5\u662f\u8003\u8651\u56e0\u7d20\u3002\u8fd9\u4e9b\u90fd\u662f\u865a\u5047\u7684\u795e\uff1a\n\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u51fb\u952e\u3002\u5f53\u7a0b\u5e8f\u5458\u4f7f\u7528\u7eb8\u5e26\u65f6\uff0c\u8fd9\u53ef\u80fd\u5f88\u91cd\u8981\uff0c\u800c\u4e14\u5bf9\u4e8ebash\u6216awk\u8fd9\u6837\u7684\u5c0f\u578b\u8bed\u8a00\u4e5f\u5f88\u91cd\u8981\u3002\u5bf9\u4e8e\u8f83\u5927\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u7f16\u7a0b\u65f6\u95f4\u82b1\u5728\u8bfb\u5199\u4e0a\u7684\u65f6\u95f4\u8981\u6bd4\u5199\u591a\u5f97\u591a\uff0c\u56e0\u6b64\u51cf\u5c11\u51fb\u952e\u672c\u8eab\u4e0d\u5e94\u8be5\u662f\u4e00\u4e2a\u76ee\u6807\u3002\u5f53\u7136\uff0c\u6211\u5e76\u4e0d\u662f\u8bf4\u5927\u91cf\u7684\u6837\u677f\u6587\u4ef6\u662f\u4e2a\u597d\u4e3b\u610f\u3002\n\u6613\u4e8e\u89e3\u6790\u3002\u7f16\u5199\u5177\u6709\u4efb\u610f\u5148\u884c\u529f\u80fd\u7684\u89e3\u6790\u5668\u5e76\u4e0d\u96be\u3002\u4e0d\u5e94\u8be5\u4e3a\u4e86\u5728\u89e3\u6790\u5668\u4e2d\u8282\u7701\u51e0\u884c\u4ee3\u7801\u800c\u5f71\u54cd\u8bed\u8a00\u7684\u5916\u89c2\u3002\u8bf7\u8bb0\u4f4f\uff0c\u60a8\u5c06\u82b1\u8d39\u5927\u91cf\u65f6\u95f4\u76ef\u7740\u4ee3\u7801\u3002\u8fd9\u662f\u7b2c\u4e00\u4f4d\u7684\u3002\u5982\u4e0b\u6240\u8ff0\uff0c\u5b83\u4ecd\u7136\u5e94\u8be5\u662f\u4e0a\u4e0b\u6587\u65e0\u5173\u6587\u6cd5\u3002\n\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u5173\u952e\u5b57\u7684\u6570\u91cf\u3002\u8fd9\u4e2a\u6307\u6807\u5f88\u611a\u8822\uff0c\u4f46\u6211\u770b\u5230\u5b83\u53cd\u590d\u51fa\u73b0\u3002\u82f1\u8bed\u6709\u4e00\u767e\u4e07\u4e2a\u5355\u8bcd\uff0c\u6211\u4e0d\u8ba4\u4e3a\u6709\u4efb\u4f55\u8feb\u5728\u7709\u776b\u7684\u77ed\u7f3a\u3002\u53ea\u8981\u7528\u4f60\u6b63\u786e\u7684\u5224\u65ad\u529b\u5c31\u884c\u4e86\u3002\n\u4e0a\u4e0b\u6587\u65e0\u5173\u6587\u6cd5\u3002\u8fd9\u5b9e\u9645\u4e0a\u610f\u5473\u7740\u4ee3\u7801\u5e94\u8be5\u662f\u53ef\u89e3\u6790\u7684\uff0c\u800c\u4e0d\u5fc5\u5728\u7b26\u53f7\u8868\u4e2d\u67e5\u627e\u3002\u4f17\u6240\u5468\u77e5\uff0cC++\u4e0d\u662f\u4e0a\u4e0b\u6587\u65e0\u5173\u7684\u8bed\u6cd5\u3002\u4e0a\u4e0b\u6587\u65e0\u5173\u7684\u8bed\u6cd5\uff0c\u9664\u4e86\u4f7f\u4e8b\u60c5\u53d8\u5f97\u7b80\u5355\u4e4b\u5916\uff0c\u8fd8\u610f\u5473\u7740IDE\u53ef\u4ee5\u5728\u4e0d\u96c6\u6210\u5230\u5927\u591a\u6570\u7f16\u8bd1\u5668\u524d\u7aef\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u8bed\u6cd5\u7a81\u51fa\u663e\u793a\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u7b2c\u4e09\u65b9\u5de5\u5177\u53d8\u5f97\u66f4\u6709\u53ef\u80fd\u5b58\u5728\u3002\n\u5197\u4f59\u3002\u662f\u7684\uff0c\u8bed\u6cd5\u5e94\u8be5\u662f\u591a\u4f59\u7684\u3002\u4f60\u4eec\u90fd\u542c\u4eba\u8bf4\u8fc7\uff0c\u8bed\u53e5\u7ec8\u6b62\u662f\u4e0d\u5fc5\u8981\u7684\uff0c\u56e0\u4e3a\u7f16\u8bd1\u5668\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u8fd9\u662f\u771f\u7684-\u4f46\u8fd9\u79cd\u975e\u5197\u4f59\u4f1a\u5bfc\u81f4\u65e0\u6cd5\u7406\u89e3\u7684\u9519\u8bef\u6d88\u606f\u3002\u8003\u8651\u4e00\u79cd\u6ca1\u6709\u5197\u4f59\u7684\u8bed\u6cd5\u3002\u7136\u540e\uff0c\u4efb\u4f55\u968f\u673a\u7684\u5b57\u7b26\u5e8f\u5217\u90fd\u5c06\u662f\u6709\u6548\u7684\u7a0b\u5e8f\u3002\u751a\u81f3\u4e0d\u53ef\u80fd\u51fa\u73b0\u9519\u8bef\u6d88\u606f\u3002\u826f\u597d\u7684\u8bed\u6cd5\u9700\u8981\u5197\u4f59\uff0c\u4ee5\u4fbf\u8bca\u65ad\u9519\u8bef\u5e76\u63d0\u4f9b\u6b63\u786e\u7684\u9519\u8bef\u6d88\u606f\u3002\n\u4e45\u7ecf\u8003\u9a8c\uff0c\u5343\u771f\u4e07\u786e\u3002\u5982\u679c\u6ca1\u6709\u975e\u5e38\u6709\u529b\u7684\u7406\u7531\uff0c\u5bf9\u4e8e\u719f\u6089\u7684\u7ed3\u6784\uff0c\u6700\u597d\u575a\u6301\u4f7f\u7528\u4e45\u7ecf\u8003\u9a8c\u7684\u771f\u5b9e\u8bed\u6cd5\u5f62\u5f0f\u3002\u5b83\u786e\u5b9e\u7f29\u77ed\u4e86\u8be5\u8bed\u8a00\u7684\u5b66\u4e60\u66f2\u7ebf\uff0c\u5e76\u5c06\u63d0\u9ad8\u91c7\u7528\u7387\u3002\u60f3\u60f3\u770b\uff0c\u5982\u679c\u8fd9\u79cd\u8bed\u8a00\u4ea4\u6362\u4e86+\u548c*\u7684\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\uff0c\u4eba\u4eec\u4f1a\u591a\u4e48\u8ba8\u538c\u5b83\u3002\u5c06\u5206\u6b673\u4fdd\u5b58\u4e3a\u4ee5\u524d\u672a\u89c1\u7684\u7279\u5f81\uff0c\u8fd9\u4e5f\u5411\u7528\u6237\u53d1\u51fa\u8fd9\u662f\u65b0\u7684\u4fe1\u53f7\u3002\n\u4e00\u5982\u65e2\u5f80\uff0c\u8fd9\u4e9b\u539f\u5219\u4e0d\u5e94\u88ab\u89c6\u4e3a\u53e3\u5934\u7985\u3002\u8981\u6709\u6b63\u786e\u7684\u5224\u65ad\u529b\u3002\u4efb\u4f55\u76f2\u76ee\u9075\u5faa\u7684\u8bed\u8a00\u8bbe\u8ba1\u539f\u5219\u90fd\u4f1a\u5bfc\u81f4\u707e\u96be\u3002\u8fd9\u4e9b\u539f\u5219\u5f88\u5c11\u662f\u6b63\u4ea4\u7684\uff0c\u800c\u4e14\u7ecf\u5e38\u53d1\u751f\u51b2\u7a81\u3002\u8fd9\u5f88\u50cf\u8bbe\u8ba1\u4e00\u5ea7\u623f\u5b50--\u628a\u4e3b\u8863\u6a71\u505a\u5f97\u66f4\u5927\uff0c\u610f\u5473\u7740\u4e3b\u5367\u5ba4\u4f1a\u53d8\u5c0f\u3002\u8fd9\u4e00\u5207\u90fd\u662f\u4e3a\u4e86\u627e\u5230\u5408\u9002\u7684\u5e73\u8861\u3002\n\u629b\u5f00\u8bed\u6cd5\u4e0d\u8c08\uff0c\u8bed\u8a00\u7684\u6838\u5fc3\u5c06\u662f\u8bed\u4e49\u5904\u7406\uff0c\u4e5f\u5c31\u662f\u5c06\u610f\u4e49\u8d4b\u4e88\u53e5\u6cd5\u7ed3\u6784\u3002\u8fd9\u662f\u60a8\u5c06\u82b1\u8d39\u5927\u91cf\u8bbe\u8ba1\u548c\u5b9e\u73b0\u7684\u5730\u65b9\u3002\u8fd9\u5f88\u50cf\u4f60\u4f53\u5185\u7684\u5668\u5b98--\u5b83\u4eec\u662f\u770b\u4e0d\u89c1\u7684\uff0c\u9664\u975e\u5b83\u4eec\u51fa\u4e86\u95ee\u9898\uff0c\u5426\u5219\u6211\u4eec\u4e0d\u4f1a\u53bb\u60f3\u5b83\u4eec\u3002\u8bed\u4e49\u5de5\u4f5c\u4e0d\u4f1a\u6709\u592a\u591a\u8363\u8000\uff0c\u4f46\u5b83\u5c06\u662f\u8bed\u8a00\u7684\u5168\u90e8\u610f\u4e49\u6240\u5728\u3002\n\u4e00\u65e6\u901a\u8fc7\u8bed\u4e49\u9636\u6bb5\uff0c\u7f16\u8bd1\u5668\u5c31\u4f1a\u8fdb\u884c\u4f18\u5316\uff0c\u7136\u540e\u751f\u6210\u4ee3\u7801\uff0c\u7edf\u79f0\u4e3a\u540e\u7aef\u3002\u8fd9\u4e24\u4e2a\u5173\u90fd\u5f88\u6709\u6311\u6218\u6027\uff0c\u4e5f\u5f88\u590d\u6742\u3002\u6211\uff0c\u6211\u559c\u6b22\u548c\u8fd9\u4e9b\u4e1c\u897f\u6253\u4ea4\u9053\uff0c\u62b1\u6028\u8bf4\u6211\u4e0d\u5f97\u4e0d\u628a\u65f6\u95f4\u82b1\u5728\u5176\u4ed6\u95ee\u9898\u4e0a\u3002\u4f46\u9664\u975e\u4f60\u771f\u7684\u559c\u6b22\u5b83\uff0c\u800c\u4e14\u5b83\u9700\u8981\u4e00\u4e2a\u76f8\u5f53\u7cbe\u795e\u9519\u4e71\u7684\u4eba", "note_en": "My career has been all about designing programming languages and writing compilers for them.\rThis has been a great joy and source of satisfaction to me, and perhaps I can\rhelp others with some observations about what you\u2019re in for if you decide to\rdesign and implement a professional programming language.\rOf course, this is a book length topic, so I\u2019ll just hit on a few highlights here,\rand avoid topics well covered elsewhere.\n    First off, you\u2019re in for a lot of work. Years of work, most of which will be\rwandering in the desert. The odds of success are heavily stacked against you.\rIf you are not strongly self-motivated to do this, it isn\u2019t going to happen.\rIf you need validation and encouragement from others, it isn\u2019t going to happen.\n  Fortunately, doing such a project is not major dollar investment, it won\u2019t break\ryou if you fail. Even if you do fail, depending on how far the project got, it\rcan look pretty good on your resume and be good for your career.\n    One thing abundantly clear is that syntax matters. It matters an awful lot. It\u2019s\rlike the styling on a car \u2014 if the styling is not appealing, it simply doesn\u2019t\rmatter how hot the performance is. The syntax needs to be something your\rtarget audience would like.\n  Trying to go with something they\u2019ve not seen before will make language adoption\ra much tougher sell.\n  I like to go with a mix of familiar syntax and aesthetic beauty. It\u2019s got to look\rgood on the screen. After all, you\u2019re going to spend plenty of time looking at it.\rIf it looks awkward, clumsy, or ugly, so will it taint the language.\n  A couple things I, perhaps surprisingly, suggest should not be considerations. These\rare false gods:\n  Minimizing keystrokes. Maybe this mattered when programmers used paper tape, and it\rmatters for small languages like bash or awk. For larger applications, programming\rtime is spent reading much more than writing so reducing keystrokes shouldn\u2019t be a goal in itself.\rOf course, I\u2019m not suggesting that large amounts of boilerplate is a good idea.\n  Easy parsing. It isn\u2019t hard to write parsers with arbitrary lookahead. The looks\rof the language shouldn\u2019t be compromised to save a few lines of code in the parser.\rRemember, you\u2019ll spend a lot of time staring at the code. That comes first.\rAs mentioned below, it still should be a context free grammar.\n  Minimizing the number of keywords. This metric is just silly, but I see it cropping\rup repeatedly. There are a million words in the english language, I don\u2019t think there\ris any looming shortage. Just use your good judgement.\n    Context free grammars. What this really means is the code should be parseable\rwithout having to look things up in a symbol table. C++ is famously not a context free\rgrammar. A context free grammar, besides making things a lot simpler, means that\rIDEs can do syntax highlighting without integrating in most of a compiler front end,\ri.e. third party tools become much more likely to exist.\n  Redundancy. Yes, the grammar should be redundant. You\u2019ve all heard people say that\rstatement terminating ; are not necessary because the compiler can figure it out. That\u2019s\rtrue \u2014 but such non-redundancy makes for incomprehensible error messages. Consider a\rsyntax with no redundancy. Any random sequence of characters would then be a valid program.\rNo error messages are even possible. A good syntax needs redundancy in order to diagnose\rerrors and give good error messages.\n  Tried and true. Absent a very strong reason, it\u2019s best to stick with tried and true\rgrammatical forms for familiar constructs. It really cuts the learning curve for the language,\rand will increase adoption rates. Think of how people will hate the language if it\rswaps the operator precedence of + and *. Save the divergance3 for features not generally seen\rbefore, such also signals the user that this is new.\n  As always, these principles should not be taken as dicta. Use good judgement.\rAny language design principle blindly followed leads to disaster. The principles\rare rarely orthogonal, and frequently conflict. It\u2019s a lot like designing a house -\rmaking the master closet bigger means the master bedroom gets smaller. It\u2019s all about\rfinding the right balance.\n  Getting past the syntax, the meat of the language will be the semantic processing, which\ris when meaning is assigned to the syntactical constructs. This is where you\u2019ll be spending\rthe vast bulk of design and implementation. It\u2019s a lot like the organs in your body \u2014 they are sight\runseen and we don\u2019t think about them unless they are going wrong. There won\u2019t be a lot of\rglory in the semantic work, but in it will be the whole point of the language.\n  Once through the semantic phase, the compiler does optimizations, and then code generation, collectively called the back end. These two passes are very challenging and complicated. Me, I love working with this stuff, and grumble that I \u2019ve got to spend time on other issues instead. But unless you really like it, and it takes a fairly unhinged programmer to delight in the arcana of such things, I recommend taking the common sense approach and use an existing back end,  ...\n    How best to implement it? I hope I can at least set you off in the right direction.\rThe first tool beginning compiler writers often reach for is regex. Regex is just the wrong\rtool for lexing and parsing. Rob Pike\r explains why\rreasonably well.\rI\u2019ll close that with the famous quote from Jamie Zawinski:\n  Some people, when confronted with a problem, think \r\u201cI know, I\u2019ll use regular expressions.\u201d Now they have two problems.\n  Somewhat more controversial, I wouldn \u2019t bother wasting time with lexer or parser generators and other so-called compiler compilers. They \u2019re a waste of time. Writing a lexer and parser is a tiny percentage of the job of writing a compiler. Using a generator will take up about as much time as writing one by hand, and it will marry you to the generator (which matters when porting the compiler to a new platform). Generators also have the unfortunate reputation of  ...\n  Now that I mentioned it, error messages are a big factor in the quality of implementation of\rthe language. It\u2019s what the user sees, after all. If you\u2019re tempted to put out error messages\rlike \u201cbad syntax\u201d, perhaps you should consider taking up a career as a chartered accountant\rinstead. Good error messages are surprisingly hard to write, and often you won\u2019t discover\rhow bad the error messages are until you work the tech support emails.\n    Print the first message and quit. This is of course the simplest approach, and works\rsurprisingly well. Most compilers\u2019 follow on messages are so bad that the practical programmer\rignores all but the first one anyway. The holy grail is to find all the actual errors in one\rcompile pass, leading to:\n  Guess at what the programmer intended, repair the syntax trees, and continue.\rThis is an ever-popular approach. I\u2019ve tried it\rindefatigably for decades, and it\u2019s just been a miserable failure. The compiler seems to always\rguess wrong, and subsequent messages with the \u201cfixed\u201d syntax trees are just ludicrously wrong.\n  The poisoning approach. This is much like how floating point NaNs are handled. Any operation with a NaN operand silently results in a NaN. Applying this to error recovery, and any constructs that have a leaf for which an error occurred is itself considered erroneous (but no additional error messages are emitted for it). Hence the compiler is able to detect multiple errors as long as the errors are in sections of code with no dependency between them. This  ...\n  What else does the user care about in the hidden part of the compiler? Speed. I hear it over\rand over \u2014 compiler speed matters a lot. In fact, compile speed is often the first thing I\rhear when I ask a company what tipped the balance for choosing D. The reality is, most\rcompilers are pigs. To blow people away with your language, show them that it compiles as\rfast as hitting the return key on the compile command.\n  Wanna know the secret of making your compiler fast? I mean screaming, blinding, lightning fast?\rSend me $$$ in an SASE and I\u2019ll tell you! Ok, ok, I\u2019ll set my naked greed aside and let you\rin on it.\n    Sounds too easy, right? Trite, even. But raise your hands if you routinely use a profiler.\rBe honest, everyone says they do but that profiler manual remains in its pristine shrink wrap.\rI\u2019m just astonished at the programmers who never use profilers. But it\u2019s great for me, as\ra competitive advantage that never ceases to pay dividends.\n    valgrind. I suspect valgrind has almost single-handedly saved C and C++ from oblivion. I\rcan\u2019t heap enough praise on this tool. It has saved my error-prone sorry ass untold numbers of\rfrustrating hours.\n  git and github. Not many tools are transformative, but these are. Not only do they provide\ran automated backup, but they enable collaborative work on the project by people all over the\rworld. They also provide a complete history of where and from whom every line of code came from,\rin case there\u2019s a legal issue.\n  Automated testing framework. Compilers are enormously complicated beasts. Without constant\rtesting of revisions, the project will reach a point where it cannot advance, as more bugs than\rimprovements will be added. Add to this a coverage analyzer, which will show if the test suite\ris exercising all the code or not.\n  Automated documentation generator. The D project of course built our own (Ddoc), and it too\rwas transformative. Before Ddoc, the documentation had only a random correlation with the code,\rand too often they had nothing to do with each other.\rAfter Ddoc, the two were brought in sync.\n  Bugzilla. This is an automated bug tracking tool. This was a great leap forward from my\rpathetic older scheme of emails and folders, a system that simply cannot scale. Programmers\rare far less tolerant of buggy compilers than they used to be, this has to be addressed\raggressively head on.\n    One semantic technique that is obvious in hindsight but it took Andrei Alexandrescu to point out to me is called \u2019lowering \u2019. It consists of, internally, rewriting more complex semantic constructs in terms of simpler ones. For example, while loops and foreach loops can be rewritten in terms of for loops. Then, the rest of the code only has to deal with for loops. This turned out to uncover a couple of latent bugs in how while loops were implemented,  ...\n  If it turns out that there are some special case rules in the language that prevent this\rrewriting, it might be a good idea to go back and revisit the language design.\n  Any time you can find commonality in the handling of semantic constructs, it\u2019s an opportunity\rto reduce implementation effort and bugs.\n    Rarely mentioned, but critical, is you\u2019ll need write a runtime library. This is a major project.\rIt\u2019ll serve as a demonstration of how the language features work, so it had better be good.\rSome critical things to get right:\n  I/O performance. Most programs spend a lot of time in I/O. Slow I/O will make the whole\rlanguage look bad. The benchmark is C stdio. If the language has elegant, lovely I/O APIs but\rruns at only half the speed of C I/O, then it just isn\u2019t going to be attractive.\n  Memory allocation. A high percentage of time in most programs is spent doing mundane\rmemory allocation. Get this wrong at your peril.\n  Transcendental functions. Ok, I lied. Nobody cares about the accuracy of transcendental functions, they only care about the speed of them. My proof comes from trying to port the D runtime library to different platforms, and discovering that the underlying C transcendental functions often fail the accuracy tests in the D library test suite. C library functions also often do a poor job handling the arcana of the IEEE floating point  ...\n  A common trap people fall into with standard libraries is filling them up with trivia.\rTrivia is sand clogging the gears and just dead weight that has to be carried around forever.\rMy general rule is if the explanation for what the function does is more lines than the\rimplementation code, then the function is likely trivia and should be booted out.\n    You \u2019ve done it, you \u2019ve got a great prototype of the new language. Now what? Next comes the hardest part. This is where most new languages fail. You \u2019ll be doing what every nascent rock band does \u2014play shopping malls, high school dances, dive bars, etc., slowly building up an audience. For languages, this means preparing presentations, articles, tutorials, and books on the language. Then, going to programmer meetings, conferences,  ...\n  There\u2019s one huge thing in your favor. With the global reach of the internet, there\u2019s an\rinstantly reachable global audience. Another favorable thing is that programmer meetings,\rconferences, etc., all are looking for great content. They love talks about new languages,\rnew programming ideas, etc. My experience with the audiences is they are friendly and\rwill give you lots of constructive feedback.\n  Of course, then you\u2019ll almost certainly be forced to reevaluate some cherished features of the\rlanguage and reengineer them.", "posttime": "2020-05-03 03:57:09", "tags": "\u7f16\u7a0b,programming language,\u7f16\u5199,truth,\u8bed\u8a00", "title": "\u5173\u4e8e\u7f16\u5199\u7f16\u7a0b\u8bed\u8a00\u7684\u8d64\u88f8\u88f8\u7684\u771f\u76f8", "title_en": "The Naked Truth About Writing a Programming Language", "transed": 1, "url": "https://www.digitalmars.com/articles/b90.html", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u7f16\u7a0b", "language", "\u7f16\u5199", "truth", "\u8bed\u8a00"]}, {"category": "", "categoryclass": "", "imagename": "249446622459809052f700ba44b3d3ba.jpg", "infoid": 1000401, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u534e\u76db\u987f\u5dde\u5e03\u83b1\u6069\u3002-\u5728\u4ed6\u51e0\u5341\u5e74\u7684\u517b\u8702\u751f\u6daf\u4e2d\uff0c\u6cf0\u5fb7\u00b7\u9ea6\u514b\u798f\u5c14(Ted McFall)\u4ece\u672a\u89c1\u8fc7\u8fd9\u6837\u7684\u4e8b\u60c5\u3002\n11\u6708\uff0c\u5f53\u4ed6\u628a\u5361\u8f66\u505c\u5728\u534e\u76db\u987f\u5dde\u5361\u65af\u7279\u9644\u8fd1\u68c0\u67e5\u4e00\u7fa4\u8702\u7bb1\u65f6\uff0c\u4ed6\u53ef\u4ee5\u4ece\u7a97\u6237\u770b\u5230\u5730\u4e0a\u4e00\u56e2\u7cdf\u7684\u871c\u8702\u8eab\u4f53\u3002\u5f53\u4ed6\u4ed4\u7ec6\u89c2\u5bdf\u65f6\uff0c\u4ed6\u770b\u5230\u8702\u5de2\u524d\u6709\u4e00\u5806\u6b7b\u53bb\u7684\u6210\u5458\uff0c\u91cc\u9762\u8fd8\u6709\u66f4\u591a\u7684\u5c60\u6740-\u6210\u5343\u4e0a\u4e07\u7684\u871c\u8702\u4ece\u8eab\u4f53\u4e0a\u6495\u4e0b\u4e86\u5934\uff0c\u6ca1\u6709\u7f6a\u72af\u7684\u8ff9\u8c61\u3002\n\u9ea6\u514b\u798f\u5c14\u8bf4\uff0c\u201c\u6211\u65e0\u6cd5\u7406\u89e3\u5230\u5e95\u662f\u4ec0\u4e48\u9020\u6210\u4e86\u8fd9\u6837\u7684\u540e\u679c\u3002\u201d\n\u76f4\u5230\u540e\u6765\uff0c\u4ed6\u624d\u5f00\u59cb\u6000\u7591\u51f6\u624b\u5c31\u662f\u4e00\u4e9b\u7814\u7a76\u4eba\u5458\u7b80\u5355\u5730\u79f0\u4e4b\u4e3a\u201c\u8c0b\u6740\u5927\u9ec4\u8702\u201d\u7684\u90a3\u4e2a\u4eba\u3002\n\u6709\u4e86\u53ef\u4ee5\u957f\u5230\u4e24\u82f1\u5bf8\u957f\u7684\u8702\u738b\uff0c\u4e9a\u6d32\u5de8\u578b\u9ec4\u8702\u53ef\u4ee5\u7528\u957f\u5f97\u50cf\u5c16\u523a\u7684\u9ca8\u9c7c\u9ccd\u90a3\u6837\u7684\u4e0b\u989a\uff0c\u5728\u51e0\u4e2a\u5c0f\u65f6\u5185\u6d88\u706d\u871c\u8702\u8702\u5de2\uff0c\u65a9\u9996\u871c\u8702\uff0c\u5e26\u7740\u80f8\u7532\u98de\u8d70\uff0c\u5582\u517b\u5b83\u4eec\u7684\u5e7c\u5d3d\u3002\u5bf9\u4e8e\u8f83\u5927\u7684\u76ee\u6807\uff0c\u9ec4\u8702\u5f3a\u5927\u7684\u6bd2\u6db2\u548c\u6bd2\u523a-\u8db3\u591f\u523a\u7a7f\u4e00\u5957\u517b\u8702\u670d-\u6784\u6210\u4e86\u4e00\u79cd\u4ee4\u4eba\u75db\u82e6\u7684\u7ec4\u5408\uff0c\u53d7\u5bb3\u8005\u5c06\u5176\u6bd4\u4f5c\u6eda\u70eb\u7684\u91d1\u5c5e\u523a\u8fdb\u4ed6\u4eec\u7684\u76ae\u80a4\u3002\n\u5728\u65e5\u672c\uff0c\u9ec4\u8702\u6bcf\u5e74\u6740\u6b7b\u591a\u8fbe50\u4eba\u3002\u73b0\u5728\uff0c\u4ed6\u4eec\u7b2c\u4e00\u6b21\u62b5\u8fbe\u7f8e\u56fd\u3002\n\u9ea6\u514b\u798f\u5c14\u4ecd\u7136\u4e0d\u786e\u5b9a\u4e9a\u6d32\u5de8\u578b\u9ec4\u8702\u662f\u4e0d\u662f\u4ed6\u7684\u8702\u5de2\u88ab\u63a0\u593a\u7684\u7f6a\u9b41\u7978\u9996\u3002\u4f46\u5176\u4e2d\u4e24\u79cd\u6355\u98df\u6027\u6606\u866b\u662f\u53bb\u5e74\u79cb\u5929\u5728\u534e\u76db\u987f\u5dde\u897f\u5317\u89d2\u53d1\u73b0\u7684\uff0c\u5c31\u5728\u4ed6\u7684\u623f\u4ea7\u4ee5\u5317\u51e0\u82f1\u91cc\u5904-\u8fd9\u662f\u7f8e\u56fd\u9996\u6b21\u53d1\u73b0\u8fd9\u79cd\u6606\u866b\u3002\n\u81ea\u90a3\u4ee5\u540e\uff0c\u79d1\u5b66\u5bb6\u4eec\u5f00\u59cb\u4e86\u5bf9\u9ec4\u8702\u7684\u5168\u9762\u8ffd\u6355\uff0c\u4ed6\u4eec\u62c5\u5fc3\u5165\u4fb5\u8005\u53ef\u80fd\u4f1a\u5728\u7f8e\u56fd\u5927\u91cf\u6d88\u706d\u871c\u8702\uff0c\u5e76\u5efa\u7acb\u5982\u6b64\u6df1\u5165\u7684\u5b58\u5728\uff0c\u4ee5\u81f3\u4e8e\u53ef\u80fd\u4f1a\u5931\u53bb\u6839\u9664\u7684\u6240\u6709\u5e0c\u671b\u3002\n\u534e\u76db\u987f\u5dde\u519c\u4e1a\u90e8\u7684\u6606\u866b\u5b66\u5bb6\u514b\u91cc\u65af\u00b7\u9c81\u5c3c(Chris Looney)\u8bf4\uff0c\u201c\u8fd9\u662f\u6211\u4eec\u963b\u6b62\u5b83\u5efa\u7acb\u7684\u7a97\u53e3\u3002\u201d\u201c\u5982\u679c\u6211\u4eec\u5728\u672a\u6765\u51e0\u5e74\u505a\u4e0d\u5230\uff0c\u5f88\u53ef\u80fd\u4e5f\u505a\u4e0d\u5230.\u201d\n12\u6708\u521d\u4e00\u4e2a\u5bd2\u51b7\u7684\u65e9\u6668\uff0c\u5728\u9ea6\u514b\u798f\u5c14\u623f\u4ea7\u4ee5\u53172.5\u82f1\u91cc\u5904\uff0c\u6770\u592b\u00b7\u79d1\u5185\u5229\u65af(Jeff Kornelis)\u5e26\u7740\u4ed6\u7684\u6df7\u8840\u72d7\u8e0f\u4e0a\u4e86\u4ed6\u5bb6\u7684\u524d\u5eca\u3002\u4ed6\u4f4e\u5934\u770b\u7740\u4e00\u5e45\u523a\u8033\u7684\u666f\u8c61\uff1a\u201c\u8fd9\u662f\u6211\u89c1\u8fc7\u7684\u6700\u5927\u7684\u9ec4\u8702\u3002\u201d\n\u8fd9\u53ea\u6606\u866b\u6b7b\u4e86\uff0c\u79d1\u5185\u5229\u65af\u5728\u68c0\u67e5\u8fc7\u5b83\u4e4b\u540e\uff0c\u6709\u4e00\u79cd\u9884\u611f\uff0c\u5b83\u53ef\u80fd\u662f\u4e00\u53ea\u4e9a\u6d32\u5de8\u578b\u5927\u9ec4\u8702\u3002\u8003\u8651\u5230\u4ed6\u5728\u4e16\u754c\u4e0a\u7684\u4f4d\u7f6e\uff0c\u8fd9\u6ca1\u6709\u591a\u5927\u610f\u4e49\uff0c\u4f46\u4ed6\u770b\u8fc7YouTube\u540d\u4eba\u90ca\u72fc\u5f7c\u5f97\u68ee(Coyote Peterson)\u88ab\u5176\u4e2d\u4e00\u53ea\u5927\u9ec4\u8702\u72e0\u72e0\u5730\u53ee\u4e86\u4e00\u53e3\u7684\u4e00\u96c6\u3002\n\u9664\u4e86\u5b83\u7684\u5927\u5c0f\uff0c\u5927\u9ec4\u8702\u8fd8\u6709\u4e00\u4e2a\u72ec\u7279\u7684\u5916\u89c2\uff0c\u4e00\u5f20\u5361\u901a\u822c\u7684\u51f6\u731b\u7684\u8138\uff0c\u6709\u7740\u8718\u86db\u4fa0\u90a3\u6837\u7684\u6cea\u773c\uff0c\u50cf\u8001\u864e\u4e00\u6837\u5ef6\u4f38\u5230\u8eab\u4f53\u4e0b\u9762\u7684\u6a59\u8272\u548c\u9ed1\u8272\u6761\u7eb9\uff0c\u4ee5\u53ca\u50cf\u5c0f\u873b\u8713\u4e00\u6837\u5bbd\u5927\u800c\u7ea4\u7ec6\u7684\u7fc5\u8180\u3002\n\u79d1\u5185\u5229\u65af\u8054\u7cfb\u4e86\u56fd\u5bb6\uff0c\u540e\u8005\u51fa\u6765\u786e\u8ba4\u8fd9\u786e\u5b9e\u662f\u4e00\u53ea\u4e9a\u6d32\u5de8\u578b\u5927\u9ec4\u8702\u3002\u4e0d\u4e45\u4e4b\u540e\uff0c\u4ed6\u4eec\u5f97\u77e5\u8be5\u5730\u533a\u7684\u4e00\u540d\u5f53\u5730\u517b\u8702\u4eba\u4e5f\u53d1\u73b0\u4e86\u5176\u4e2d\u4e00\u53ea\u9ec4\u8702\u3002\n\u9c81\u5c3c\u535a\u58eb\u8bf4\uff0c\u5f88\u660e\u663e\uff0c\u8be5\u5dde\u9762\u4e34\u7740\u4e00\u4e2a\u4e25\u91cd\u7684\u95ee\u9898\uff0c\u4f46\u7531\u4e8e\u624b\u4e2d\u53ea\u6709\u4e24\u53ea\u6606\u866b\uff0c\u800c\u4e14\u51ac\u5929\u5373\u5c06\u5230\u6765\uff0c\u51e0\u4e4e\u4e0d\u53ef\u80fd\u786e\u5b9a\u5927\u9ec4\u8702\u5df2\u7ecf\u5728\u5bb6\u91cc\u8d5a\u4e86\u591a\u5c11\u94b1\u3002\n\u6574\u4e2a\u51ac\u5929\uff0c\u5dde\u519c\u4e1a\u751f\u7269\u5b66\u5bb6\u548c\u5f53\u5730\u517b\u8702\u4eba\u5f00\u59cb\u5de5\u4f5c\uff0c\u4e3a\u5373\u5c06\u5230\u6765\u7684\u5b63\u8282\u505a\u51c6\u5907\u3002\u5e2e\u52a9\u7ec4\u7ec7\u540c\u9f84\u4eba\u5bf9\u6297\u9ec4\u8702\u7684\u517b\u8702\u4eba\u9732\u4e1d\u00b7\u4e39\u5c3c\u5c14\u68ee(Ruthie Danielsen)\u5728\u5979\u7684\u6c7d\u8f66\u5f15\u64ce\u76d6\u4e0a\u5c55\u5f00\u4e86\u4e00\u5f20\u5730\u56fe\uff0c\u6307\u51fa\u4e86Whatcom\u53bf\u5404\u5730\u517b\u8702\u4eba\u653e\u7f6e\u9677\u9631\u7684\u5730\u65b9\u3002\n\u4e39\u5c3c\u5c14\u68ee\u8bf4\uff0c\u201c\u5927\u591a\u6570\u4eba\u90fd\u5bb3\u6015\u88ab\u5b83\u4eec\u53ee\u5230\u3002\u201d\u201c\u6211\u4eec\u5bb3\u6015\u4ed6\u4eec\u4f1a\u5f7b\u5e95\u6467\u6bc1\u6211\u4eec\u7684\u8702\u5de2\u3002\u201d\n\u5728\u52a0\u62ff\u5927\u8fb9\u5883\u53e6\u4e00\u8fb9\u53d1\u73b0\u4e86\u4e00\u4e9b\u4e9a\u6d32\u5de8\u578b\u5927\u9ec4\u8702\uff0c\u8fd9\u589e\u52a0\u4e86\u4e0d\u786e\u5b9a\u6027\u548c\u795e\u79d8\u6027\u3002\n\u53bb\u5e7411\u6708\uff0c\u5728\u4e0d\u5217\u98a0\u54e5\u4f26\u6bd4\u4e9a\u7701\u7684\u6000\u7279\u7f57\u514b(White Rock)\u53d1\u73b0\u4e86\u4e00\u53ea\u9ec4\u8702\uff0c\u8ddd\u79bb\u534e\u76db\u987f\u5dde\u7684\u53d1\u73b0\u53ef\u80fd\u670910\u82f1\u91cc\u8fdc-\u5bf9\u4e8e\u9ec4\u8702\u6765\u8bf4\uff0c\u5f88\u53ef\u80fd\u592a\u8fdc\u4e86\uff0c\u4e0d\u53ef\u80fd\u662f\u540c\u4e00\u6b96\u6c11\u5730\u7684\u4e00\u90e8\u5206\u3002\u751a\u81f3\u5728\u66f4\u65e9\u7684\u65f6\u5019\uff0c\u5728\u6e29\u54e5\u534e\u5c9b\u4e0a\u53d1\u73b0\u4e86\u4e00\u4e2a\u8702\u5de2\uff0c\u6a2a\u8de8\u4e00\u6761\u6d77\u5ce1\uff0c\u5bf9\u4e8e\u4e00\u53ea\u5927\u9ec4\u8702\u6765\u8bf4\uff0c\u53ef\u80fd\u592a\u5bbd\u4e86\uff0c\u4e0d\u53ef\u80fd\u4ece\u5927\u9646\u7a7f\u8d8a\u8fc7\u6765\u3002\n\u5de5\u4f5c\u4eba\u5458\u80fd\u591f\u8ffd\u8e2a\u5230\u6e29\u54e5\u534e\u5c9b\u4e0a\u7684\u6bcd\u8230\u3002\u5eb7\u62c9\u5fb7\u00b7\u8d1d\u9c81\u8d1d\u662f\u7eb3\u5948\u83ab\u9547\u7684\u517b\u8702\u4eba\u548c\u6606\u866b\u5b66\u5bb6\uff0c\u4ed6\u88ab\u6307\u6d3e\u53bb\u6d88\u706d\u5b83\u3002\n\u4ed6\u5728\u665a\u4e0a\u51fa\u53d1\uff0c\u90a3\u65f6\u9ec4\u8702\u6b63\u5728\u5b83\u4eec\u7684\u5de2\u7a74\u91cc\u3002\u4ed6\u7a7f\u4e0a\u77ed\u88e4\u548c\u539a\u8fd0\u52a8\u88e4\uff0c\u7136\u540e\u7a7f\u4e0a\u8702\u670d\u3002\u4ed6\u5728\u811a\u8e1d\u548c\u624b\u8155\u4e0a\u6234\u4e0a\u4e86\u51ef\u592b\u62c9\u80cc\u5e26\u3002\n\u4f46\u5f53\u4ed6\u8d70\u8fd1\u8702\u5de2\u65f6\uff0c\u4ed6\u8bf4\uff0c\u5237\u5b50\u7684\u6c99\u6c99\u58f0\u548c\u624b\u7535\u7b52\u7684\u5149\u8292\u5524\u9192\u4e86\u8702\u7fa4\u3002\u8fd8\u6ca1\u6765\u5f97\u53ca\u5f80\u5de2\u91cc\u6d47\u4e8c\u6c27\u5316\u78b3\uff0c\u4ed6\u5c31\u611f\u89c9\u5230\u817f\u90e8\u7b2c\u4e00\u6b21\u88ab\u707c\u70ed\u7684\u523a\u4f24--\u7a7f\u8fc7\u8702\u670d\u548c\u5e95\u5c42\u7684\u8fd0\u52a8\u88e4\u3002\n\u4ed6\u8bf4\uff1a\u201c\u8fd9\u5c31\u50cf\u662f\u628a\u6eda\u70eb\u7684\u56fe\u9489\u523a\u8fdb\u4e86\u6211\u7684\u8089\u91cc\u3002\u201d\u4ed6\u6700\u7ec8\u88ab\u8707\u4e86\u81f3\u5c11\u4e03\u6b21\uff0c\u5176\u4e2d\u4e00\u4e9b\u53ee\u54ac\u6d41\u4e86\u8840\u3002\n\u65e5\u672c\u4eac\u90fd\u5c1a\u7ea6\u5927\u5b66\u7684\u7814\u7a76\u5458\u9ad8\u6865\u4fca\u4e00(Jun-ichi Takahashi)\u8bf4\uff0c\u8fd9\u4e2a\u7269\u79cd\u5728\u90a3\u91cc\u8d62\u5f97\u4e86\u201c\u8c0b\u6740\u5927\u9ec4\u8702\u201d\u7684\u7ef0\u53f7\uff0c\u56e0\u4e3a\u5b83\u5484\u5484\u903c\u4eba", "note_en": "BLAINE, Wash. \u2014 In his decades of beekeeping, Ted McFall had never seen anything like it.\n As he pulled his truck up to check on a group of hives near Custer, Wash., in November, he could spot from the window a mess of bee carcasses on the ground. As he looked closer, he saw a pile of dead members of the colony in front of a hive and more carnage inside \u2014 thousands and thousands of bees with their heads torn from their bodies and no sign of a culprit.\n \u201cI couldn\u2019t wrap my head around what could have done that,\u201d Mr. McFall said.\n Only later did he come to suspect that the killer was what some researchers simply call the \u201cmurder hornet.\u201d\n With queens that can grow to two inches long, Asian giant hornets can use mandibles shaped like spiked shark fins to wipe out a honeybee hive in a matter of hours, decapitating the bees and flying away with the thoraxes to feed their young. For larger targets, the hornet\u2019s potent venom and stinger \u2014 long enough to puncture a beekeeping suit \u2014 make for an excruciating combination that victims have likened to hot metal driving into their skin.\n In Japan, the hornets kill up to 50 people a year. Now, for the first time, they have arrived in the United States.\n Mr. McFall still is not certain that  Asian giant hornets were responsible for the plunder of his hive. But two of the predatory insects were discovered last fall in the northwest corner of Washington State, a few miles north of his property \u2014 the first sightings in the United States.\n Scientists have since embarked on a full-scale hunt for the hornets, worried that the invaders could decimate bee populations in the United States and establish such a deep presence that all hope for eradication could be lost.\n \u201cThis is our window to keep it from establishing,\u201d said Chris Looney, an entomologist at the Washington State Department of Agriculture. \u201cIf we can\u2019t do it in the next couple of years, it probably can\u2019t be done.\u201d\n  On a cold morning in early December, two and a half miles to the north of Mr. McFall\u2019s property, Jeff Kornelis stepped on his front porch with his terrier-mix dog. He looked down to a jarring sight: \u201cIt was the biggest hornet I\u2019d ever seen.\u201d\n The insect was dead, and after inspecting it, Mr. Kornelis had a hunch that it might be an Asian giant hornet. It did not make much sense, given his location in the world, but he had seen an episode of the YouTube personality Coyote Peterson  getting a brutal sting from one of the hornets.\n  Beyond its size, the hornet has a distinctive look, with a cartoonishly fierce face featuring teardrop eyes like Spider-Man, orange and black stripes that extend down its body like a tiger, and broad, wispy wings like a small dragonfly.\n Mr. Kornelis contacted the state, which came out to confirm that it was indeed an Asian giant hornet. Soon after, they learned that a local beekeeper in the area had also found one of the hornets.\n Dr. Looney said it was immediately clear that the state faced a serious problem, but with only two insects in hand and winter coming on, it was nearly impossible to determine how much the hornet had already made itself at home.\n Over the winter, state agriculture biologists and local beekeepers got to work, preparing for the coming season. Ruthie Danielsen, a beekeeper who has helped organize her peers to combat the hornet, unfurled a map across the hood of her vehicle, noting the places across Whatcom County where beekeepers have placed traps.\n \u201cMost people are scared to get stung by them,\u201d Ms. Danielsen said. \u201cWe\u2019re scared that they are going to totally destroy our hives.\u201d\n  Adding to the uncertainty \u2014 and mystery \u2014 were some other discoveries of the Asian giant hornet across the border in Canada.\n In November, a single hornet was seen in White Rock, British Columbia, perhaps 10 miles away from the discoveries in Washington State \u2014 likely too far for the hornets to be part of the same colony. Even earlier, there had been a hive discovered on Vancouver Island, across a strait that probably was too wide for a hornet to have crossed from the mainland.\n Crews were able to track down the hive on Vancouver Island. Conrad B\u00e9rub\u00e9, a beekeeper and entomologist in the town of Nanaimo, was assigned to exterminate it.\n He set out at night, when the hornets would be in their nest. He put on shorts and thick sweatpants, then his bee suit. He donned Kevlar braces on his ankles and wrists.\n But as he approached the hive, he said, the rustling of the brush and the shine of his flashlight awakened the colony. Before he had a chance to douse the nest with carbon dioxide, he felt the first searing stabs in his leg \u2014 through the bee suit and underlying sweatpants.\n \u201cIt was like having red-hot thumbtacks being driven into my flesh,\u201d he said. He ended up getting stung at least seven times, some of the stings drawing blood.\n Jun-ichi Takahashi, a researcher at Kyoto Sangyo University in Japan, said the species had earned the \u201cmurder hornet\u201d nickname there because its aggressive group attacks can expose victims to doses of toxic venom equivalent to that of a venomous snake; a series of stings can be fatal.\n The night he got stung, Mr. B\u00e9rub\u00e9 still managed to eliminate the nest and collect samples, but the next day, his legs were aching, as if he had the flu. Of the thousands of times he has been stung in his lifetime of work, he said, the Asian giant hornet stings were the most painful.\n  After collecting the hornet in the Blaine area, state officials took off part of a leg and shipped it to an expert in Japan. A sample from the Nanaimo nest was sent as well.\n A genetic examination, concluded over the past few weeks, determined that the nest in Nanaimo and the hornet near Blaine were not connected, said Telissa Wilson, a state pest biologist, meaning there had probably been at least two different introductions in the region.\n Dr. Looney went out on a recent day in Blaine, carrying clear jugs that had been made into makeshift traps; typical wasp and bee traps available for purchase have holes too small for the Asian giant hornet. He filled some with orange juice mixed with rice wine, others had kefir mixed with water, and a third batch was filled with some experimental lures \u2014 all with the hope of catching a queen emerging to look for a place to build a nest.\n In a region with extensive wooded habitats for hornets to establish homes, the task of finding and eliminating them is daunting. How to find dens that may be hidden underground? And where to look, given that one of the queens can fly many miles a day, at speeds of up to 20 miles per hour?\n The miles of wooded landscapes and mild, wet climate of western Washington State make it an ideal location for the hornets to spread.\n In the coming months, Dr. Looney said, he and others plan to place hundreds more traps that could catch worker hornets that would start becoming active over the summer. State officials have mapped out the plan in a grid, starting in Blaine and moving outward.\n  The buzz of activity inside a nest of Asian giant hornets can keep the inside temperature up to 86 degrees, so the trackers are also exploring using thermal imaging to examine the forest floors. Later, they may also try other advanced tools that could track the signature hum the hornets make in flight.\n If a hornet does get caught in a trap, Dr. Looney said, there are plans to possibly use radio-frequency identification tags to monitor where it goes \u2014 or simply attach a small streamer and then follow the hornet as it returns to its nest.\n While most bees would be unable to fly with a disruptive marker attached, that is not the case with the Asian giant hornet. It is big enough to handle the extra load.", "posttime": "2020-05-03 03:56:49", "tags": "\u8c0b\u6740,murder,\u9ec4\u8702,hornet", "title": "\u4e9a\u6d32\u8c0b\u6740\u5927\u9ec4\u8702\u5df2\u7ecf\u62b5\u8fbe\u5317\u7f8e", "title_en": "Asian Murder Hornets Have Arrived in North America", "transed": 1, "url": "https://www.nytimes.com/2020/05/02/us/asian-giant-hornet-washington.html", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u8c0b\u6740", "murder", "\u9ec4\u8702", "hornet"]}, {"category": "", "categoryclass": "", "imagename": "24e61a8175af932d24d6bfab5f86fc71.png", "infoid": 1000400, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u4e5f\u8bb8\u6709\u4e00\u5929\u8fd9\u4f1a\u662f\u4e2a\u66f4\u597d\u7684\u4e3b\u610f\uff0c\u4f46\u90a3\u4e00\u5929\u8fd8\u6ca1\u6709\u5230\u6765\u3002\u811a\u8e1d\u624b\u956f\u5c31\u50cf\u4efb\u4f55\u5176\u4ed6\u7535\u5b50\u8bbe\u5907\u4e00\u6837\uff0c\u5bb9\u6613\u51fa\u73b0\u610f\u60f3\u4e0d\u5230\u7684\u6545\u969c\u3002\u5047\u9634\u6027--\u63d0\u9192\u5047\u91ca\u8005\u4e0d\u5728\u5bb6--\u4ece\u957f\u8fdc\u6765\u770b\u5e76\u4e0d\u6bd4\u5047\u9633\u6027\u597d\u591a\u5c11\uff0c\u5c3d\u7ba1\u524d\u8005\u662f\u552f\u4e00\u80fd\u5265\u593a\u67d0\u4eba\u81ea\u7531\u7684\u4eba\u3002\n\u811a\u8e1d\u624b\u956f\u7684\u8d39\u7528\u7531\u5047\u91ca\u72af\u627f\u62c5\u3002\u667a\u80fd\u624b\u673a\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u7a0d\u5fae\u4fbf\u5b9c\u4e00\u4e9b\uff0c\u2026\u3002\u4f46\u524d\u63d0\u662f\u4f60\u4e0d\u8003\u8651\u667a\u80fd\u624b\u673a\u6216\u5e94\u7528\u7a0b\u5e8f\u672c\u8eab\u7684\u6210\u672c\u3002\u667a\u80fd\u624b\u673a\u5bf9\u4e8e\u5047\u91ca\u72af\u6765\u8bf4\u5e76\u4e0d\u5bb9\u6613\u83b7\u5f97\u3002\u8865\u8d34\u624b\u673a\u548c\u5e94\u7528\u7a0b\u5e8f\u7684\u6708\u8d39\u6240\u9700\u7684\u5de5\u4f5c\u4e5f\u4e0d\u591a\u3002\n\u90a3\u4e9b\u6709\u5e78\u4e70\u5230\u667a\u80fd\u624b\u673a\u7684\u4eba\u53d1\u73b0\uff0c\u65b0\u7684\u89e3\u51b3\u65b9\u6848\u548c\u5b83\u7684\u524d\u8eab\u4e00\u6837\u5bb9\u6613\u51fa\u9519\u3002\n\u5728\u83b1\u62c9\u51fa\u72f1\u56de\u5230\u4f50\u6cbb\u4e9a\u5dde\u5bb6\u4e2d\u7684\u90a3\u5929\uff0c\u5979\u88ab\u544a\u77e5\u9700\u8981\u8d2d\u4e70\u4e00\u90e8\u667a\u80fd\u624b\u673a-\u5bf9\u4e8e\u4e00\u4e2a\u521a\u521a\u670d\u5211\u7ed3\u675f\u7684\u4eba\u6765\u8bf4\uff0c\u8fd9\u4e0d\u662f\u4e00\u4e2a\u65e0\u5173\u7d27\u8981\u7684\u4efb\u52a1\uff0c\u4f46\u83b1\u62c9\u5f88\u5e78\u8fd0\u6709\u4e00\u4e2a\u670b\u53cb\u53ef\u4ee5\u7ed9\u5979\u4e70\u4e00\u90e8\u3002\u5979\u8bf4\uff0c\u51e0\u5929\u540e\uff0c\u5979\u5728\u5bb6\u7761\u89c9\u65f6\uff0c\u6839\u636e\u5979\u7684\u91ca\u653e\u6761\u6b3e\uff0c\u5979\u88ab\u8981\u6c42\u5b89\u88c5\u7684\u5e94\u7528\u7a0b\u5e8f\u51fa\u4eba\u610f\u6599\u5730\u54cd\u8d77\uff0c\u9ad8\u97f3\u7684\u8b66\u544a\u8b66\u62a5\u54cd\u8d77\uff0c\u56e0\u4e3a\u5b83\u5411\u5979\u7684\u5047\u91ca\u5b98\u53d1\u9001\u4e86\u4e00\u4efd\u901a\u77e5\uff0c\u544a\u8bc9.\u3002\n\u60ca\u614c\u5931\u63aa\u7684\u83b1\u62c9\u62cd\u4e86\u4e00\u5f20\u81ea\u5df1\u7684\u7167\u7247\uff0c\u628a\u81ea\u5df1\u7684\u4f4d\u7f6e\u53d1\u7ed9\u4ed6\uff0c\u8bd5\u56fe\u7ea0\u6b63\u8fd9\u6b3e\u5e94\u7528\u7684\u9519\u8bef\u3002\u5979\u8bf4\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4f1a\u65e0\u60c5\u5730\u91cd\u590d\uff0c\u6bcf\u9694\u534a\u4e2a\u5c0f\u65f6\u5c31\u4f1a\u5728\u591c\u95f4\u53eb\u9192\u5979\u3002\u201c\u6211\u4f1a\u54ed\u7740\u9192\u6765\uff0c\u201d\u5979\u8bf4\u3002\u6709\u65f6\uff0c\u5f53\u5979\u8bd5\u56fe\u9a8c\u8bc1\u81ea\u5df1\u7684\u4f4d\u7f6e\u6216\u7b7e\u5230\u65f6\uff0c\u5e94\u7528\u7a0b\u5e8f\u4f1a\u544a\u8bc9\u5979\uff0c\u5b83\u65e0\u6cd5\u8bc6\u522b\u5979\u7684\u58f0\u97f3\u3002\u201c\u6211\u4f1a\u89c9\u5f97\u5f88\u7d2f\u7684\uff0c\u6211\u60f3\u5982\u679c\u6211\u4e0d\u56de\u7b54\uff0c\u6211\u4f1a\u56de\u5230\u76d1\u72f1\u7684\u3002\u201d\u5f88\u5feb\uff0c\u5979\u8bf4\uff0c\u5979\u201c\u4e5e\u6c42\u6211\u7684\u5047\u91ca\u5b98\u2026\u2026\u201d\n\u201c\u5b88\u62a4\u8005\u201d\u662f\u4e00\u6b3e\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u4e00\u4e9b\u5047\u91ca\u72af\u8981\u6c42\u6062\u590d\u5230\u4ee5\u524d\u7248\u672c\u7684\u5047\u91ca\u72af\u76d1\u63a7\u529f\u80fd\uff1a\u811a\u8e1d\u624b\u956f\u3002\u6839\u636e\u201c\u536b\u62a5\u201d\u7684\u6570\u636e\uff0c\u201c\u536b\u62a5\u201d\u62e5\u6709\u8fd15\u4e07\u540d\u7528\u6237\uff0c\u800c\u83b1\u62c9\u5e76\u4e0d\u662f\u552f\u4e00\u6709\u53ef\u80fd\u88ab\u8fd9\u6b3e\u51fa\u6545\u969c\u7684\u5e94\u7528\u7a0b\u5e8f\u4fb5\u72af\u56de\u76d1\u72f1\u7684\u5047\u91ca\u72af\u3002Gizmodo\u91c7\u8bbf\u7684\u5176\u4ed6\u5047\u91ca\u72af\u4e5f\u62a5\u544a\u4e86\u540c\u6837\u7684\u95ee\u9898\u3002\u4ed6\u4eec\u8bf4\uff0c\u8fd9\u6b3e\u5e94\u7528\u7a0b\u5e8f\u51e0\u4e4e\u65e0\u6cd5\u4f7f\u7528\uff0c\u56e0\u4e3a\u5b83\u65e0\u6cd5\u51c6\u786e\u5730\u62a5\u544a\u2026\u2026\u3002\n\u4e0d\u51fa\u6240\u6599\uff0c\u8fd9\u6b3e\u5e94\u7528\u7a0b\u5e8f\u7684\u6240\u6709\u8005\u662fTelmate\uff0c\u4e5f\u5c31\u662f\u8fd0\u8425Global Tele*Link\u7684\u540c\u4e00\u5bb6\u516c\u53f8\u3002Global Tele*Link\u7684\u4e1a\u52a1\u662f\u5411\u56da\u72af\u51fa\u552e\u901a\u5f80\u5916\u90e8\u4e16\u754c\u7684\u901a\u9053\u3002\u5b83\u8fd0\u8425\u7740\u8bb8\u591a\u76d1\u72f1\u901a\u4fe1\u7f51\u7edc\uff0c\u8fd9\u4e9b\u7f51\u7edc\u4ee5\u5bf9\u4ece\u76d1\u72f1\u6253\u6765\u7684\u7535\u8bdd\u6bcf\u5206\u949f\u6536\u53d6\u8fc7\u9ad8\u7684\u8d39\u7528\u800c\u95fb\u540d\uff0c\u5e76\u63a7\u5236\u7740\u56da\u72af\u53c2\u4e0e\u7684\u51e0\u4e4e\u6240\u6709\u5176\u4ed6\u6570\u5b57\u4e92\u52a8\u7684\u5a31\u4e50\u8bbe\u5907(\u5982\u5e73\u677f\u7535\u8111\u548cMP3\u64ad\u653e\u5668)\u3002\u5b83\u4f1a\u91ca\u653e\u4e00\u4e2a\u7f16\u7801\u8349\u7387\u7684..\u3002\n\u8fd9\u6b3e\u5e94\u7528\u7a0b\u5e8f\u5177\u6709\u4fb5\u5165\u6027--\u751a\u81f3\u6bd4\u5047\u91ca\u5b98\u672a\u7ecf\u5ba3\u5e03\u7684\u5bb6\u8bbf\u66f4\u5177\u4fb5\u5165\u6027\u3002\u8fd9\u6b3e\u5e94\u7528\u505a\u4e86\u60e9\u6212\u4eba\u5458\u5728\u8eab\u4f53\u4e0a\u505a\u4e0d\u5230\u7684\u4e8b\u60c5\uff1a\u8981\u6c42\u6bcf\u5929\u51e0\u5341\u6b21\u7b7e\u5230\u3002\n\u201cGuardian\u8ba9\u6211\u4e22\u6389\u4e86\u5de5\u4f5c\uff0c\u201d\u53e6\u4e00\u4e2a\u88ab\u76d1\u7981\u4e86\u5341\u591a\u5e74\u7684\u4eba\u8bf4\uff0c\u4ed6\u4f7f\u7528\u4e86\u8fd9\u6b3e\u5e94\u7528\uff0c\u5e76\u8bb0\u5f97\u5b83\u8981\u6c42\u4ed6\u6bcf\u5c0f\u65f6\u7b7e\u5230\u8d85\u8fc710\u6b21\u3002\u201c\u665a\u4e0a\u6211\u7761\u4e0d\u7740\u89c9\uff0c\u7136\u540e\u5728\u5de5\u4f5c\u65f6\uff0c\u6211\u4e0d\u5f97\u4e0d\u4e00\u76f4\u638f\u51fa\u624b\u673a\u3002\u201d\u4ed6\u8bf4\uff0c\u6709\u4e00\u534a\u7684\u65f6\u95f4\uff0c\u5b83\u65e0\u6cd5\u51c6\u786e\u8bc6\u522b\u4ed6\u7684\u8138\u6216\u58f0\u97f3\u3002\n\u536b\u62a5\u8981\u6c42\u66f4\u591a\uff0c\u4f46\u505a\u5f97\u66f4\u5c11\u3002\u5f53\u4e0e\u67d0\u4eba\u9762\u5bf9\u9762\u4f1a\u9762\u65f6\uff0c\u90ae\u5c40\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u6838\u5b9e\u4ed6\u4eec\u7684\u8eab\u4efd\u3002\u53d6\u4ee3\u4ed6\u4eec\u4f4d\u7f6e\u7684\u5e94\u7528\u7a0b\u5e8f\u663e\u7136\u65e0\u6cd5\u53ef\u9760\u5730\u505a\u5230\u8fd9\u4e00\u70b9\u3002\u5728\u8fd9\u9879\u7b80\u5355\u7684\u4efb\u52a1\u4e0a\uff0c\u5b83\u65e5\u590d\u4e00\u65e5\u5730\u5728\u4e00\u5c0f\u65f6\u5185\u591a\u6b21\u5931\u8d25\u3002\u4e00\u6b3e\u65e0\u6cd5\u5e73\u8861\u8eab\u4efd\u8bc1\u8d26\u7c3f\u7684\u5e94\u7528\u7a0b\u5e8f\u4e0d\u4f1a\u5e2e\u52a9\u4efb\u4f55\u4eba\u5728\u507f\u8fd8\u4e86\u6b20\u793e\u4f1a\u7684\u503a\u52a1\u540e\u6062\u590d\u6b63\u5e38\u751f\u6d3b\u3002\n\u5feb\u901f\u7684\u6210\u672c\u6548\u76ca\u5206\u6790\u5f88\u5927\u7a0b\u5ea6\u4e0a\u7ad9\u5728\u4e86\u6210\u672c\u7684\u4e00\u8fb9\u3002\u8fd9\u6b3e\u5e94\u7528\u7a0b\u5e8f\u7684\u6708\u8d39\u4e3a90\u7f8e\u5143\uff0c\u800c\u4e14\u4e0d\u80fd\u6b63\u5e38\u5de5\u4f5c\u3002\u5b83\u6240\u505a\u7684\u5c31\u662f\u8ba9\u987a\u4ece\u7684\u5047\u91ca\u72af\u9762\u4e34\u518d\u6b21\u5165\u72f1\u7684\u98ce\u9669\u3002\u5373\u4f7f\u5b83\u5de5\u4f5c\u5f97\u6709\u70b9\u6b63\u5e38\uff0c\u5b83\u4e5f\u662f\u4e2a\u95ee\u9898\u3002\n\u6b63\u5982\u6211\u4eec\u5728\u8bc4\u8bba\u4e2d\u53d1\u73b0\u7684\u90a3\u6837\uff0cGuardian\u6bcf\u5206\u949f\u90fd\u4f1a\u5411Telmate\u7684\u670d\u52a1\u5668\u7b7e\u5230\uff0c\u5982\u679c\u624b\u673a\u5904\u4e8e\u7761\u7720\u72b6\u6001\uff0c\u5b83\u4f1a\u5524\u9192\u624b\u673a\uff0c\u5e76\u5ffd\u7565\u64cd\u4f5c\u7cfb\u7edf\u4f18\u5316\u7535\u6c60\u7684\u8bf7\u6c42\u3002\u8003\u8651\u5230Guardian\u7684\u7528\u9014\uff0c\u53ef\u4ee5\u9884\u89c1\u7684\u662f\uff0c\u8fd9\u6b3e\u5e94\u7528\u7a0b\u5e8f\u4f9d\u8d56\u4e8e\u7528\u6237\u6388\u4e88\u5b83\u5bf9\u8bbe\u5907\u4e0a\u4e00\u4e9b\u6f5c\u5728\u4fb5\u72af\u9690\u79c1\u7684\u4f20\u611f\u5668\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u5305\u62ecWiFi\u3001\u84dd\u7259\u3001\u97f3\u9891\u8bbe\u7f6e\u548c\u6444\u50cf\u5934\u8bbf\u95ee\u3002\n\u4e00\u6574\u5929\uff0c\u6bcf\u5929\u7684\u76d1\u89c6\u5047\u91ca\u72af\u90fd\u9700\u8981\u652f\u4ed8\u8d39\u7528\u3002\u5373\u4f7f\u4ed6\u4eec\u9075\u5b88\u4e86\u89c4\u5219\uff0c\u8fd9\u6b3e\u5e94\u7528\u7a0b\u5e8f\u4e5f\u4f1a\u8bf4\u4ed6\u4eec\u4e0d\u662f\u3002\u4ee3\u7801\u4e2d\u8fd8\u5305\u62ec\u7528\u4e8e\u79d8\u5bc6\u5f55\u97f3\u7684\u6302\u94a9--\u9690\u85cf\u8fdb\u5165\u8bbe\u5907\u7684\u9ea6\u514b\u98ce\uff0c\u53ef\u4ee5\u5728\u5f85\u673a\u6216\u7761\u7720\u6a21\u5f0f\u4e0b\u89e6\u53d1\u3002\u5f53\u5e94\u7528\u7a0b\u5e8f\u6bcf\u969460\u79d2\u7ed9\u5bb6\u91cc\u6253\u4e00\u6b21\u7535\u8bdd\u65f6\uff0c\u7761\u7720\u6a21\u5f0f\u5e76\u4e0d\u610f\u5473\u7740\u4ec0\u4e48\u3002\n\u5047\u91ca\u56da\u72af\u7684\u9690\u79c1\u6743\u671f\u671b\u503c\u5f88\u4f4e\u3002\u4f46\u5b83\u5e76\u4e0d\u662f\u4e0d\u5b58\u5728\u7684\u3002\u8fd9\u6b3e\u6602\u8d35\u7684\u5e94\u7528\u7a0b\u5e8f\u79fb\u9664\u4e86\u5269\u4e0b\u7684\u6240\u6709\u5185\u5bb9\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u4fb5\u5165\u5f0f\u7b7e\u5230", "note_en": "Maybe it will be a better idea someday, but that day isn&#39;t here yet. Ankle bracelets are prone to unexpected failure, just like any other electronic device. False negatives -- alerts saying a parolee isn&#39;t at home -- are no better than false positives in the long run, although the former is the only one that can take away someone&#39;s freedom.\n The costs of ankle bracelets are borne by the parolee. Smartphone apps may be slightly cheaper\u2026 but only if you don&#39;t factor in the cost of a smartphone or the app itself. Smartphones aren&#39;t easy for parolees to obtain. Neither are the jobs needed to subsidize both the phone and the app&#39;s monthly charge.\n Those lucky enough to secure a smartphone are discovering the new solution  is just as prone to error as its predecessor.\n On the day Layla got out of prison and back to her home in Georgia, she was told she would need to purchase a smartphone \u2014not an insignificant task for someone who \u2019d just completed a sentence, but Layla was lucky to have a friend who could buy one for her. She says she was at home in bed a few days later when the app she had been mandated to install under the terms of her release went off unexpectedly, the high-pitched warning alarm blaring as it sent a notification to her parole officers telling  ...\n Panicked, Layla took a picture of herself and sent him her location, trying to correct the app \u2019s mistake. The process would repeat relentlessly, she says, waking her up every half hour during the night. \u201cI \u2019d wake up crying, \u201dshe says. Sometimes, when she tried to authenticate her location or check in the app would tell her it didn \u2019t recognize her voice. \u201cI \u2019d feel so tired, and I thought if I didn \u2019t answer, I was going to go back to prison. \u201dSoon, she says, she was \u201cbegging my parole officer  ...\n Guardian is the app that&#39;s so unable to do its job properly some parolees are asking to be rolled back to the previous version of parolee monitoring: ankle bracelets. Guardian has almost 50,000 &#34;users,&#34; according to its data, and Layla isn&#39;t the only parolee in danger of being violated back into prison by the malfunctioning app. Other parolees spoken to by Gizmodo are reporting the same issues. They say the app is almost &#34;unusable&#34; due to its inability to accurately report  ...\n Unsurprisingly, the app is owned by Telmate, the same company that operates Global Tel*Link. Global Tel*Link is in the business of selling prisoners access to the outside world. It runs a number of prison communication networks -- ones known for  charging exorbitant per-minute fees for phone calls originating from prisons, as well as controlling  the entertainment devices(like tablets and mp3 players) of nearly every other digital interaction engaged in by inmates. That it would release a sloppily-coded  ...\n The app is intrusive -- even more intrusive than unannounced in-home visits by parole officers. The app does what corrections officers physically can&#39;t do: demand dozens of check-ins a day.\n \u201cGuardian cost me my job,\u201d says another person who had been incarcerated for more than a decade who used the app and remembers it asking him to check in more than 10 times an hour. \u201cAt night I couldn\u2019t sleep, and then at work I\u2019d have to pull my phone out all the time.\u201d Half the time, he says, it wouldn\u2019t accurately recognize his face or his voice.\n Guardian demands more but does less. A P.O. could easily verify a person&#39;s identity when meeting them in person. The app taking their place is apparently unable to reliably do this. It fails at this simple task multiple times an hour, day after day. An app unable to balance its ID books isn&#39;t going to help anyone return to a normal life after repaying their debt to society.\n A quick cost-benefit analysis sides heavily with costs. The app costs $90/month and doesn&#39;t work correctly. What it does do is put compliant parolees at risk of being incarcerated again. Even when it&#39;s working somewhat correctly, it&#39;s a problem.\n As we found in the review, Guardian checks in with Telmate\u2019s servers every single minute, waking up a phone if it\u2019s asleep and ignoring the operating system\u2019s requests to optimize the battery. Given what Guardian is used for, the app predictably relies on the user granting it access to a number of potentially privacy-invasive sensors on their device, including wifi, Bluetooth, audio settings, and camera access.\n All day, everyday surveillance parolees are expected to pay for. And even when they follow the rules, the app says they aren&#39;t. Also included in the code are hooks for surreptitious recording -- hidden access to devices&#39; microphones that can be triggered in standby or sleep mode. Not that sleep mode means anything when the app is phoning home every sixty seconds.\n The expectation of privacy for paroled prisoners is low. But it&#39;s not nonexistent. This expensive app removes everything that&#39;s left and replaces it with intrusive check-ins that are so badly implemented they may as well be a malfunctioning ankle bracelet for all the good it&#39;s doing for parolees. But this is likely the best prisoners are ever going to get. Very few people who matter -- those with the power to change things -- care what happens to ex-criminals. Every sentence  ...", "posttime": "2020-05-03 03:56:39", "tags": "\u7a0b\u5e8f,app,\u624b\u673a,\u4e0d\u8d77\u4f5c\u7528,replace", "title": "\u76d1\u72f1\u7528\u4e0d\u8d77\u4f5c\u7528\u7684\u667a\u80fd\u624b\u673a\u5e94\u7528\u7a0b\u5e8f\u66f4\u6362\u811a\u8e1d\u624b\u956f", "title_en": "Prisons Replace Ankle Bracelets with Smartphone App That Doesn't Work", "transed": 1, "url": "https://www.techdirt.com/articles/20200429/10182144405/prisons-replace-ankle-bracelets-with-expensive-smartphone-app-that-doesnt-work.shtml", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u7a0b\u5e8f", "app", "\u624b\u673a", "\u4e0d\u8d77\u4f5c\u7528", "replace"]}, {"category": "", "categoryclass": "", "imagename": "", "infoid": 1000399, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u73b0\u5728\u662f\u5f00\u53d1\u65b0\u4ea7\u54c1\u7684\u65f6\u5019\u4e86\uff01\u6211\u51b3\u5b9a\u5206\u4eab\u6211\u6784\u5efaSaaS\u4ea7\u54c1\u4e4b\u65c5\u4e2d\u7684\u6bcf\u4e00\u6b65\uff0c\u4ee5\u4fdd\u6301\u5bf9\u81ea\u5df1\u7684\u8d23\u4efb\u611f\u3002\u6211\u82b1\u51e0\u5929/\u51e0\u5468/\u51e0\u4e2a\u6708\u7684\u65f6\u95f4\u7f16\u5199\u4ee3\u7801\uff0c\u5728ProductHunt\u6216IndieHacker\u4e0a\u5206\u4eab\u7684\u65e5\u5b50\u5df2\u7ecf\u4e00\u53bb\u4e0d\u590d\u8fd4\u4e86\uff0c\u6ca1\u6709\u4efb\u4f55\u5f62\u5f0f\u7684\u5438\u5f15\u529b\u3002\u73b0\u5728\u6211\u4eec\u7684\u505a\u6cd5\u662f\u6b63\u786e\u7684\uff01\n\u4ec0\u4e48\u662f\u6b63\u786e\u7684\u65b9\u5f0f\uff1f\u6211\u8fd8\u4e0d\u5b8c\u5168\u77e5\u9053\uff0c\u4f46\u6211\u8fc7\u53bb\u7684\u7ecf\u9a8c\u544a\u8bc9\u6211\uff0c\u5728\u5efa\u7acb\u6211\u7684MVP\u4e4b\u524d\uff0c\u6211\u9700\u8981\u4e13\u6ce8\u4e8e\u51e0\u4ef6\u4e8b\uff1a\n\u627e\u5230\u9047\u5230\u8be5\u95ee\u9898\u7684\u4eba\uff0c\u5e76\u8be2\u95ee\u4ed6\u4eec\u662f\u5982\u4f55\u89e3\u51b3\u8be5\u95ee\u9898\u7684(\u5ba2\u6237\u91c7\u8bbf)\u3002\n\u8bd5\u7740\u5efa\u7acb\u4e00\u4e2a\u65e9\u671f\u7528\u6237\u7684\u521d\u59cb\u5217\u8868\uff0c\u4ece\u4ed6\u4eec\u90a3\u91cc\u83b7\u5f97\u53cd\u9988\uff0c\u5e76\u6539\u8fdb\u6211\u7684MVP\u3002\n\u73b0\u6709\u7684\u4e66\u7b7e\u89e3\u51b3\u65b9\u6848\u5141\u8bb8\u6211\u5c06\u94fe\u63a5\u4fdd\u5b58\u5728\u6587\u4ef6\u5939\u3001\u6807\u7b7e\u7b49\u4e2d\uff0c\u4f46\u6709\u4e00\u4e2a\u95ee\u9898\u662f\u8981\u8bb0\u5f97\u8fd4\u56de\u5e94\u7528\u7a0b\u5e8f\u5e76\u6253\u5f00\u94fe\u63a5\u3002\u6211\u9047\u5230\u7684\u53e6\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u5f53\u6211\u5728\u7f51\u4e0a\u9605\u8bfb\u6587\u7ae0\u3001\u89c2\u770b\u89c6\u9891\u6216\u67e5\u627e\u6709\u8da3\u7684\u5185\u5bb9\u65f6\uff0c\u6211\u60f3\u505a\u7b14\u8bb0\u5e76\u4fdd\u5b58\u7247\u6bb5\u4ee5\u5907\u5feb\u901f\u53c2\u8003\u3002\n\u6211\u8fd9\u6b21\u5b9e\u9645\u4e0a\u505a\u4e86\u4e00\u4e9b\u5ba2\u6237\u8c03\u67e5\uff0c\u6d1e\u5bdf\u4e86\u4eba\u4eec\u76ee\u524d\u662f\u5982\u4f55\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\uff1a\n\u4eba\u4eec\u6b63\u5728\u4f7f\u7528\u57fa\u672c\u7684\u7b14\u8bb0\u5e94\u7528\u7a0b\u5e8f\u4f5c\u4e3a\u4e66\u7b7e\u7ba1\u7406\u5668\uff1a\u8fd9\u4e2a\u89e3\u51b3\u65b9\u6848\u7684\u95ee\u9898\u662f\uff0c\u4f60\u5fc5\u987b\u56f4\u7ed5\u7b14\u8bb0\u5e94\u7528\u7a0b\u5e8f\u5efa\u7acb\u4e00\u4e2a\u7cfb\u7edf\u6765\u4fdd\u6301\u4e00\u5207\u4e95\u7136\u6709\u5e8f\u3002\u4eba\u4eec\u4f7f\u7528\u7684\u5e94\u7528\u7a0b\u5e8f\u6709Google Keep\u548cApple Notes\u3001Bear\u3001Concept\u7b49\u3002\n\u4eba\u4eec\u6b63\u5728\u4f7f\u7528\u73b0\u6709\u7684\u4e66\u7b7e\u5e94\u7528\u7a0b\u5e8f\uff1aRaindrop\u3001Pocket\u548cInstapaper\u7b49\u5e94\u7528\u7a0b\u5e8f\u3002\u5982\u679c\u60a8\u8981\u4fdd\u5b58\u94fe\u63a5\u5e76\u5c06\u5176\u7ec4\u7ec7\u5728\u6587\u4ef6\u5939\u4e2d\u6216\u6309\u6807\u7b7e\u8fdb\u884c\u7ec4\u7ec7\uff0c\u4f46\u5b83\u4eec\u4e0d\u80fd\u5e2e\u52a9\u60a8\u7a0d\u540e\u8fd4\u56de\u5230\u94fe\u63a5\uff0c\u5219\u6b64\u89e3\u51b3\u65b9\u6848\u6709\u6548\u3002\n\u5f00\u53d1\u4eba\u5458\u6b63\u5728\u6784\u5efa\u81ea\u5df1\u7684\u5e94\u7528\u7a0b\u5e8f\uff1a\u5728\u5f00\u53d1\u4eba\u5458\u8bba\u575b\u4e0a\uff0c\u6211\u53d1\u73b0\u5176\u4ed6\u5f00\u53d1\u4eba\u5458\u8bd5\u56fe\u901a\u8fc7\u6784\u5efa\u5b9a\u5236\u89e3\u51b3\u65b9\u6848\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u7136\u800c\uff0c\u5e76\u4e0d\u662f\u6bcf\u4e2a\u4eba\u90fd\u80fd\u7f16\u7801\u3002\n\u6211\u7684\u4e66\u7b7e\u5e94\u7528\u7a0b\u5e8f\u5c06\u5728\u540c\u4e00\u5c4b\u6a90\u4e0b\u63d0\u4f9b\u6240\u6709\u8fd9\u4e09\u6837\u4e1c\u897f\uff1a\u7ec4\u7ec7\u3001\u7b14\u8bb0\u548c\u63d0\u9192\u3002\n\u901a\u7528\u5e94\u7528\u7a0b\u5e8f\uff1aBear\u3001Concept\u3001RoamResearch\uff1a\u4fdd\u5b58\u94fe\u63a5\u548c\u7b14\u8bb0\uff0c\u4f46\u9700\u8981\u6784\u5efa\u81ea\u5df1\u7684\u7cfb\u7edf\u624d\u80fd\u8fd0\u884c\u3002\n\u9605\u8bfb\u6e05\u5355\u63d0\u9192\u5e94\u7528\u7a0b\u5e8f\uff1aMailist.app(\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u8fd9\u662f\u6211\u627e\u5230\u7684\u552f\u4e00\u4e00\u4e2a)\uff1a\u63d0\u9192\u4f60\u9605\u8bfb\u94fe\u63a5\uff0c\u4f46\u4e0d\u63d0\u4f9b\u7ec4\u7ec7\u529f\u80fd\u3002\nExcel\u548cAirtable\uff1a\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u5728\u8fd9\u4e24\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4e2d\u505a\u4efb\u4f55\u4e8b\u60c5\uff0c\u4f46\u662f\u4f60\u9700\u8981\u627e\u5230\u65f6\u95f4\u6765\u6784\u5efa\u4e00\u4e2a\u9002\u5408\u4f60\u7684\u7cfb\u7edf\u3002\u8fd9\u53ef\u80fd\u4f1a\u5f88\u9ebb\u70e6\u3002\n\u901a\u8fc7\u5728\u8bba\u575b\u3001Twitter\u3001IndieHacker\u3001HackerNews\u4e0a\u5efa\u7acb\u53d7\u4f17\uff0c\u6211\u6b63\u5728\u8be2\u95ee\u4eba\u4eec\u4ed6\u4eec\u662f\u5982\u4f55\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u7684\uff0c\u5e76\u8bd5\u56fe\u83b7\u5f97\u4e00\u4e9b\u89c1\u89e3\u3002\u7136\u540e\u6211\u8bd5\u7740\u8054\u7cfb\u4e00\u4e9b\u56de\u7b54\u7684\u4eba\uff0c\u5efa\u7acb\u4e00\u4efd\u65e9\u671f\u91c7\u7528\u8005\u7684\u540d\u5355\u3002\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u8fd9\u8fd8\u4e0d\u662f\u5f88\u6210\u529f\uff1a\u4e0d\u662f\u6bcf\u4e2a\u4eba\u90fd\u56de\u7b54\u8bf4\u3002\n\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u8fd9\u79cd\u89c2\u4f17\u81f3\u4e0a\u7684\u65b9\u6cd5\u5e76\u4e0d\u987a\u5229\u3002\u6211\u5728Twitter\u548c\u5176\u4ed6\u5e73\u53f0\u4e0a\u6ca1\u6709\u8ffd\u968f\u8005\uff0c\u6240\u4ee5\u6211\u5c1d\u8bd5\u4e86\u4e00\u79cd\u4ee4\u4eba\u6bdb\u9aa8\u609a\u7136\u7684\u65b9\u5f0f\uff0c\u76f4\u63a5\u8054\u7cfb\u4eba\u4eec\u3002\u8fd9\u5bf9\u6211\u4e0d\u8d77\u4f5c\u7528\uff0c\u56e0\u4e3a\u9996\u5148\uff0c\u8fd9\u4e9b\u4eba\u4e0d\u4e86\u89e3\u6211\uff0c\u5176\u6b21\uff0c\u4ed6\u4eec\u4e0d\u5728\u4e4e\u6211\u8981\u8bf4\u4ec0\u4e48\u3002\u6211\u5728\u7f51\u4e0a\u5230\u5904\u770b\u5230\uff0c\u5728\u5f00\u53d1\u4ea7\u54c1\u4e4b\u524d\uff0c\u4f60\u5fc5\u987b\u5148\u5efa\u7acb\u4e00\u4e2a\u53d7\u4f17\uff0c\u4f46\u8981\u5efa\u7acb\u4e00\u4e2a\u53d7\u4f17\uff0c\u4f60\u81f3\u5c11\u9700\u8981\u6709\u613f\u610f\u542c\u4f60\u8bf4\u8bdd\u7684\u4eba\u3002\n\u6211\u8fd8\u521b\u5efa\u4e86\u4e00\u4e2a\u5e26\u6709\u7535\u5b50\u90ae\u4ef6\u8868\u5355\u7684\u767b\u5f55\u9875\u9762\uff0c\u6211\u5c06\u5728Twitter\u548c\u5176\u4ed6\u5730\u65b9\u5206\u4eab\uff0c\u8bd5\u56fe\u83b7\u5f97\u4e00\u4e9b\u65e9\u671f\u7528\u6237\u3002\u7136\u800c\uff0c\u5728\u793e\u4ea4\u5a92\u4f53\u4e0a\u6ca1\u6709\u8ffd\u968f\u8005\u7684\u60c5\u51b5\u4e0b\uff0c\u5f88\u96be\u83b7\u5f97\u5438\u5f15\u529b\u3002\n\u6211\u5df2\u7ecf\u5728Adobe XD\u4e0a\u6784\u5efa\u4e86\u4e00\u4e2a\u6211\u8ba4\u4e3a\u8fd9\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4f1a\u662f\u4ec0\u4e48\u6837\u5b50\u7684\u8bbe\u8ba1\u539f\u578b\u3002\u7136\u800c\uff0c\u6211\u8ba4\u4e3a\u6211\u8bbe\u8ba1\u8fc7\u5ea6\u4e86\uff0c\u6211\u4e0d\u559c\u6b22\u8fd9\u6837\uff0c\u6240\u4ee5\u6211\u9700\u8981\u4ece\u5934\u5f00\u59cb\u3002", "note_en": "It is time build a new product! I have decided to share every step on my journey of building SaaS products to keep myself accountable. Long gone are the days where I would spend days/weeks/months coding something, sharing it on ProductHunt or IndieHackers and have no form of traction. Now we are doing it the right way!\n What is the right way? I don&#39;t fully know yet but my past experiences showed me that I need to focus on a few things before building my MVP:\n Find the people experiencing that problem and ask them how they are solving it (customer interviews)\n Try to build an initial list of early users, get feedback from them and refine my MVP\n       Existing bookmark solutions allow me to save links in folders, tags etc but one issue is to remember to come back to the application and open the links. The other problem I have is that when I read articles, watch videos or find interesting content online I want to take notes and save snippets for quick reference.\n  I have actually done some customer research this time and got some insight on how people are solving this problem at the moment:\n People are using basic note apps as a bookmark manager: The problem with this solution is that you have to build a system around the note app to keep everything organized. Example of apps people use for that are Google Keep and Apple Notes, Bear, Notion etc\n People are using existing bookmark apps: Apps like Raindrop, Pocket and Instapaper. This solution works if you want to save your links and organize them in folders or by tags but they don&#39;t help you come back to your links later\n Developers are building their own apps: On developer forums I found that other developers tried to solve this by building a custom solution. However not everyone can code.\n  My bookmark app will offer all those 3 things under the same roof: organization, notes and reminders.\n  General purpose apps: Bear, Notion, RoamResearch: Save links and notes but need to build your own system to make it work\n Reading list reminder apps: Mailist.app (so far it&#39;s the only one that I found): Reminds you to read links but offer no organization capabilities\n Excel and Airtable: Anybody can do anything in those 2 apps but you need to find time to build a system that works for you. It can be cumbersome.\n  Building an audience by going on forums, Twitter, IndieHackers, HackerNews, I am asking people how they are solving these problems and trying to get some insights. I then try to contact some of the people that answer to build a list of early adopters. So far this have not been very successful: not everybody replies\n  This audience-first approach is not going well so far. I have no following on Twitter and other platforms so I have tried the creepy way by contacting people directly. This is not working for me because first, these people don&#39;t know me and second, they don&#39;t care about what I have to say. I see everywhere online that you have to build an audience before building a product but to build an audience you need at least people that want to listen to you\n     I have also created a  landing page with an email form that I will share on Twitter and other places to try to get some early users. However with no following on social media it will be hard to get traction\n I have built a  design prototype on Adobe XD of what I think the app would look like. However I think I over engineered and don&#39;t like it this so I need to go back to the drawing board", "posttime": "2020-05-03 03:34:42", "tags": "\u7a0b\u5e8f,app,saas,\u5e94\u7528\u7a0b\u5e8f,people", "title": "\u516c\u5f00\u6784\u5efaSaaS\uff1a\u4e66\u7b7e\u5e94\u7528\u7a0b\u5e8f-\u7b2c1\u5929(ISH)", "title_en": "Building a SaaS in Public: Bookmark App \u2013 Day 1(ish)", "transed": 1, "url": "https://charlesthecoder.dev/building-saas-in-public-bookmark-app-day-1/", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u7a0b\u5e8f", "app", "saas", "\u5e94\u7528\u7a0b\u5e8f", "people"]}, {"category": "", "categoryclass": "", "imagename": "027e951625cc3fe89626ad395687d766.png", "infoid": 1000398, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "2020\u5e745\u67081\u65e5-\u5982\u679c\u4f60\u548c\u6211\u4e00\u6837\uff0c\u9694\u79bb\u8ba9\u4f60\u60f3\u8981\u91cd\u64ad\u4f60\u591a\u5e74\u6ca1\u6709\u78b0\u8fc7\u7684\u6e38\u620f\u3002\u5982\u679c\u4f60\u66f4\u50cf\u6211\uff0c\u4f60\u53ef\u80fd\u4f1a\u5728\u67d0\u4e2a\u5730\u65b9\u50a8\u5b58\u4e00\u4efd\u201c\u5e1d\u56fd\u7eaa\u51433\u201d\u3002\u4f60\u53ef\u80fd\u5728Mac\u4e0a\u73a9\uff0c\u4f60\u53ef\u80fd\u8fd8\u6ca1\u6709\u5347\u7ea7\u5230Catalina\uff0c\u4f60\u53ef\u80fd\u6e34\u671b\u4e00\u4e9b\u6469\u6839\u00b7\u5e03\u83b1\u514b\u7684\u52a8\u4f5c\u3002\n\u6240\u4ee5\u4f60\u5f15\u5bfc\u6e38\u620f\uff0c\u4f60\u767b\u9646\u5230\u4e3b\u83dc\u5355\uff0c\u4f60\u7acb\u523b\u6ce8\u610f\u5230\u2026\u51fa\u4e86\u70b9\u95ee\u9898\u3002\u770b\u8d77\u6765\u50cf\u70ed\u5783\u573e\u3002\n\u6240\u4ee5\uff0c\u4f60\u8df3\u5230\u9009\u9879\u4e0a\uff0c\u63d0\u5347\u6240\u6709\u7684\u4e1c\u897f\uff0c\u2026\u3002\u2026\u3002\u5b83\u4ecd\u7136\u5f88\u96be\u770b\u3002\n\u4ee4\u4eba\u6000\u7591\u7684\u662f\uff0c\u60a8\u4f1a\u6ce8\u610f\u5230\uff0c\u201c\u7740\u8272\u5668\u8d28\u91cf\u201d\u9009\u9879\u88ab\u9501\u5b9a\u4e3a\u201c\u4f4e\u201d\u3002\n\u6b64\u65f6\uff0c\u60a8\u5c06\u5728\u6587\u6863\u4e2d\u7684\u67d0\u4e2a\u4f4d\u7f6e\u67e5\u627e\u6e38\u620f\u9884\u671f\u521b\u5efa\u7684\u6587\u4ef6\u5939\uff0c\u56e0\u4e3a\u8fd9\u662f2005\u5e74\uff0c\u800c\u8fd9\u6b63\u662f\u6e38\u620f\u6240\u505a\u7684\u3002\n\u4f60\u4f1a\u95ee\uff0c\u4f60\u5728\u627e\u4ec0\u4e48\uff1f\u5f53\u7136\u662f\u5b58\u50a8\u8bbe\u7f6e\u7684\u6587\u4ef6\u3002\u754c\u9762\u53ef\u4ee5\u628a\u4f60\u9501\u5728\u95e8\u5916\uff0c\u4f46\u4f60\u662f\u4e2a\u8282\u4fed\u7684\u4eba\uff0c\u4e0d\u662f\u5417\uff1f\u56e0\u6b64\uff0c\u60a8\u627e\u5230\u4e86\u60a8\u8981\u67e5\u627e\u7684XML\uff0c\u56e0\u4e3a\u5b83\u662f2005\u5e74\u7684\uff0c\u5f53\u7136\u662fXML\uff0c\u5e76\u4e14\u5076\u7136\u53d1\u73b0\u4e86\u4e00\u4e2a\u201coptiongrfxshaderquality\u201d\u9009\u9879\u8bbe\u7f6e\u4e3a0\u3002\u4f60\u8ba4\u4e3a\u8fd9\u770b\u8d77\u6765\u5f88\u5bf9\uff0c\u6240\u4ee5\u4f60\u628a\u5b83\u63d0\u9ad8\u5230100\uff0c\u56e0\u4e3a\u8d28\u91cf\u592a\u9ad8\u6c38\u8fdc\u4e0d\u4f1a\u51fa\u9519\u3002\u6211\u4eec\u610f\u89c1\u4e00\u81f4\u3002\n\u5185\u5bb9\uff0c\u4f60\u542f\u52a8\u6e38\u620f\u3002\u7136\u800c\uff0c\u5e15\u5854\u7279\u62c9(\u8fd9\u662f\u6cd5\u56fd\u7684\uff0c\u67e5\u4e00\u4e0b\u8fd9\u4e2a)\uff0c\u4ec0\u4e48\u90fd\u6ca1\u6709\u6539\u53d8\u3002\u5f53\u60a8\u67e5\u770bol\u2018XML\u6587\u4ef6\u65f6\uff0c\u8bbe\u7f6e\u8fd4\u56de\u52300\u3002\u5408\u594f\u5de5\u4f5c\u5ba4(RIP)\u5df2\u7ecf\u770b\u5230\u4e86\u4f60\u7684\u6280\u827a\uff0c\u5e76\u628a\u5b83\u5f04\u5f97\u4e00\u584c\u7cca\u6d82\u3002\n\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u4f60\u53ef\u80fd\u4f1a\u653e\u5f03\u3002\u8fd9\u662f\u4e00\u4e2aMac\u7cfb\u7edf\uff0c\u4f60\u4e0d\u592a\u53ef\u80fd\u627e\u5230\u7528\u6237\u8865\u4e01(\u597d\u5427\uff0c\u6211\u770b\u4e86\u4e00\u4e0b\u3002\u5230\u5904\u90fd\u6709\u4e00\u4e9b\u53ef\u7591\u7684\u4e1c\u897f\u3002\u53ef\u80fd\u4f1a\u594f\u6548\u3002)\u3002\u8fd9\u53ea\u662f\u56fe\u5f62\u800c\u5df2\u3002\u4fee\u7406\u8d77\u6765\u542c\u8d77\u6765\u5f88\u70e6\u4eba\u3002\n\u4f46\u4f60\u4e0d\u4f1a\u8fd9\u4e48\u505a\u7684\u3002\u56e0\u4e3a\u4f60\u8bb0\u5f973\u5c81\u65f6\u5e94\u8be5\u662f\u4ec0\u4e48\u6837\u5b50\u3002\u4f60\u8fd8\u8bb0\u5f97\u770b\u7740\u90a3\u7f8e\u4e3d\u7684\u6ce2\u6d9b\u6c79\u6d8c\u7684\u6c34\u3002\u90a3\u4e9b\u7c92\u5b50\u6548\u679c\u3002\u5728\u90a3\u4e9b\u4ed6\u5988\u7684\u6846\u67b6\u91cc\u6839\u672c\u653e\u4e0d\u4e0b\u7684\u5927\u8239\u4e0a\u3002\u5929\u54ea\uff0c\u6444\u50cf\u673a\u88ab\u653e\u5927\u4e86\u3002\u4ed6\u4eec\u5728\u60f3\u4ec0\u4e48\u5462\u3002\n\u5728\u60a8\u7684\u6587\u6863\u4e2d\uff0c\u8be5\u6587\u4ef6\u5939\u7684\u9876\u90e8\u6709\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\u3002\u8fd9\u6b3e\u6e38\u620f\u663e\u793a\u4e86\u4e00\u5f20\u663e\u5361\uff0c\u5e76\u8bf4\u5b83\u9009\u62e9\u4e86\u201c\u901a\u7528DX7\u201d\u8bbe\u7f6e\u3002\u8fd9\u662f\u8bf4\u4f60\u6709\u4e00\u53f0\u82f1\u7279\u5c14GMA 950\uff0c\u4f60\u4ee5\u524d\u7684\u7535\u8111\u786e\u5b9e\u6709\u8fc7\u3002\u4e0d\u8fc7\uff0c\u8fd9\u4e00\u6b3e\u914d\u5907\u4e86Intel Iris Graphics 6100\u3002\u786e\u5b9e\u6709\u4e9b\u4e0d\u5bf9\u52b2\u3002\u4f60\u80e1\u4e71\u731c\u6d4b\u6e38\u620f\u662f\u901a\u8fc7\u5c06\u8ba1\u7b97\u673a\u7684\u56fe\u5f62\u80fd\u529b\u4e0e\u663e\u5361\u6570\u636e\u5e93\u8fdb\u884c\u5339\u914d\u6765\u786e\u5b9a\u8ba1\u7b97\u673a\u7684\u56fe\u5f62\u80fd\u529b\uff0c\u800c\u4e0d\u662f\u505a\u6b63\u786e\u7684\u4e8b\u60c5\u5e76\u68c0\u67e5\u8fd9\u4e9b\u529f\u80fd\u2026\u2026\u3002\n\u987a\u4fbf\u8bf4\u4e00\u53e5\uff0c\u4f60\u53d1\u73b0\u4e86\u65e7\u7684\u8865\u4e01\u7b14\u8bb0\u3002\u8fd9\u4e9b\u90fd\u8bc1\u5b9e\u4e86\u4f60\u7684\u6050\u60e7\u3002\u60a8\u53ef\u4ee5\u67e5\u770bGameData\u6587\u4ef6\u5939\u4e2d\u7684\u4e00\u4e9b\u6587\u4ef6\uff0c\u4f46\u5b83\u4eec\u90fd\u662f.bar\u548c.xmb\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5927\u591a\u65e0\u6cd5\u8bfb\u53d6\u3002\u60a8\u662f\u201cIntel\u201d\u7684grep\uff0c\u662f\u201cDX7\u201d\u7684grep\u3002\u4ec0\u4e48\u90fd\u6ca1\u53d1\u751f\u3002\u4f60\u5220\u9664\u4e86\u4e00\u4e9b\u6587\u4ef6\u2026\u3002\u4ec0\u4e48\u90fd\u6ca1\u53d1\u751f\u3002\u55ef\uff0c\u4f60\u77e5\u9053AAA\u6e38\u620f\u53ef\u80fd\u60f3\u628a\u4e00\u4e9b\u8d44\u6e90\u6346\u7ed1\u5728\u5947\u602a\u7684\u5730\u65b9\uff0c\u8fd9\u662f\u4e00\u4e2aWindows\u6e38\u620f\u7684Mac\u7aef\u53e3\uff0c\u6240\u4ee5\u4f60\u77e5\u9053\uff0c\u4e5f\u8bb8\u4e8b\u60c5\u5f88\u5947\u602a\u3002\n\u5c3d\u7ba1\u5982\u6b64\uff0c\u60a8\u6700\u7ec8\u8fd8\u662f\u627e\u5230\u4e86\u4e00\u4e2a\u201crender.bar\u201d\u6587\u4ef6\uff0c\u5e76\u5728\u542f\u52a8\u65f6\u79fb\u52a8\u8be5\u6587\u4ef6\u65f6\u5d29\u6e83\u3002\u90a3\u8fd8\u4e0d\u7b97\u592a\u597d\u3002\u60a8\u53ef\u4ee5\u5728\u5341\u516d\u8fdb\u5236\u6076\u9b54\u4e2d\u6253\u5f00\u8be5\u6587\u4ef6\uff0c\u56e0\u4e3a\u8fd9\u901a\u5e38\u53ef\u4ee5\u544a\u8bc9\u60a8\u4e00\u4e9b\u6709\u5173\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u4fe1\u606f\u3002\u662f\u7684\uff0c\u786e\u5b9e\u5982\u6b64\u3002\u5176\u4e2d\u4e00\u4e9b\u6570\u636e\u662f\u53ef\u8bfb\u6587\u672c\u3002\u5176\u4e2d\u4e00\u4e9b\u662f\u7740\u8272\u5668\u3002\u4f46\u5947\u602a\u7684\u662f\uff0c\u5b83\u7684\u5927\u90e8\u5206\u7531\u7a7a\u683c\u2026\u5206\u9694\u3002\n\u201c\u5f88\u660e\u663e\uff0c\u90a3\u662fUTF-16\u201d\uff0c\u4f60\u60ca\u547c\u9053\uff01\u8fd9\u672c\u6765\u662f\u4e00\u6b3eWindows\u6e38\u620f\uff0c\u4ed6\u4eec\u7528UTF-16\u5b58\u50a8\u6587\u672c\u975e\u5e38\u6709\u610f\u4e49\uff0c\u57fa\u672c\u4e0a\u6d6a\u8d39\u4e8630Mb\u6570\u636e\u6587\u4ef6\u7684\u4e00\u534a\u7a7a\u95f4\u3002\u6bd5\u7adf\uff0cWindows\u559c\u6b22UTF-16(\u5c3d\u7ba1\u5b83\u4e0d\u5e94\u8be5)\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u5728\u540c\u4e00\u6587\u4ef6\u4e2d\u4f7f\u7528\u8be5\u7740\u8272\u5668\u548cASCII\u7740\u8272\u5668\u3002\u975e\u5e38\u660e\u667a\u7684\u4e3b\u610f\uff01(\u672a\u663e\u793a\uff1a\u6211\u82b1\u4e86\u4e00\u5929\u65f6\u95f4\u624d\u610f\u8bc6\u5230)\u3002\n\u4e0d\u7ba1\u600e\u4e48\u8bf4\u3002\u5341\u516d\u8fdb\u5236Fiend\u5b9e\u9645\u4e0a\u6709\u4e00\u4e2a\u5c06\u5b57\u8282\u89e3\u6790\u4e3aUTF-16\u7684\u9009\u9879\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u4e3aDX7\u6267\u884cgrep\u3002\u8fd9\u4f1a\u7ed9\u4f60\u5e26\u6765\u4e00\u4e9b\u6253\u51fb\u3002\u60a8\u53ef\u4ee5\u7528DX9\u66ff\u6362\u6240\u6709\u8fd9\u4e9b\u6570\u636e\uff0cDX9\u5076\u5c14\u4e5f\u4f1a\u51fa\u73b0\u5728\u8fd9\u4e9b\u6570\u636e\u4e2d\uff0c\u60a8\u53ef\u4ee5\u4fdd\u5b58\u5e76\u5f15\u5bfc\u6e38\u620f\u3002\u97e6\u5c14\u666e\u3002\u65e5\u5fd7\u4e0a\u751a\u81f3\u6ca1\u6709\u5199\u201cDX9\u201d\u3002\u8fd9\u53ef\u80fd\u662f\u5728\u522b\u5904\u5b9a\u4e49\u7684\u3002\n\u6211\u4eec\u8bd5\u8bd5\u522b\u7684\u5427\u3002\u5047\u8bbe\u6e38\u620f\u6b63\u5728\u68c0\u6d4b\u663e\u5361\uff0c\u5e76\u4e14\u65e5\u5fd7\u4e2d\u6709\u5341\u516d\u8fdb\u5236\u6807\u8bc6\u7b26(\u5728\u6211\u7684\u4f8b\u5b50\u4e2d\uff0c\u662f0x8086-Intel\u548c0x2773)\u3002\u683c\u96f7\u683c\u5728\u201c\u9b54\u6cd5\u6076\u9b54\u201d\u4e2d\u7684\u201c8086\u201d\u5728\u67d0\u4e2a\u5730\u65b9\u5927\u53d7\u6b22\u8fce\uff0c\u5176\u4e2d\u4e00\u4e9b\u6587\u672c\u770b\u8d77\u6765\u5f88\u9f13\u821e\u4eba\u5fc3\u3002\u82f1\u7279\u5c149\u7cfb\u5217\u662fGMA 950\u7cfb\u5217\uff0c\u5b83\u53ef\u80fd\u8fd0\u884c\u5f97\u4e0d\u662f\u5f88\u597d\u3002\n\u90a3\u91cc\u7684\u4e00\u4e9b\u6570\u5b57\u770b\u8d77\u6765\u50cf\u5361\u7247\u7684\u6807\u8bc6\u7b26(2582\uff0c2592)\uff0c\u6240\u4ee5\u66f4\u6539\u8fd9\u4e9b\u6570\u5b57\u53ef\u80fd\u4f1a\u6709\u6240\u5e2e\u52a9\u3002\u4e0d\u7ba1\u600e\u4e48\u8bf4\uff0c\u4f60\u5df2\u7ecf\u590d\u5236\u4e86\u4e00\u4efd\u6587\u4ef6\uff0c\u6240\u4ee5\u8bd5\u4e00\u8bd5\u4e5f\u6ca1\u4ec0\u4e48\u574f\u5904\u3002\n\u53ef\u60b2\u7684\u662f\uff0c\u8fd9\u4e5f\u662f\u4e00\u6761\u6b7b\u80e1\u540c\u3002\u4e8b\u5b9e\u662f\uff0c\u4f60\u770b\u9519\u6587\u4ef6\u4e86\u3002\u8c22\u5929\u8c22\u5730\uff0c\u6211\u53ef\u4ee5\u544a\u8bc9\u4f60\u8fd9\u4e00\u70b9\uff0c\u56e0\u4e3a\u6211\u5728\u8fd9\u4e0a\u9762\u82b1\u4e86\u592a\u591a\u7684\u65f6\u95f4\uff0c\u5c1d\u8bd5\u4e86\u592a\u591a\u7684\u4e1c\u897f\u3002\u8fd9\u8be5\u6b7b\u7684\u4e1c\u897f\u82b1\u4e8620\u591a\u4e2a\u5c0f\u65f6\u3002\u8fd9\u8fd8\u4e0d\u7b97\u62cd\u6444\u6240\u6709\u8fd9\u4e9b\u5c4f\u5e55\u622a\u56fe\u7684\u65f6\u95f4\uff0c\u2026\u3002\n\u65e0\u8bba\u5982\u4f55\uff0c\u6b63\u786e\u7684\u6587\u4ef6\u662f\u201cDataP.bar\u201d\uff0c\u5982\u679c\u60a8\u5de7\u5999\u5730\u66ff\u6362ID\uff0c\u65e5\u5fd7\u5c06\u663e\u793a\u4e00\u4e9b\u5168\u65b0\u7684\u5185\u5bb9\uff1a\n\u5f53\u7136\uff0c\u5728\u6e38\u620f\u4e2d\uff0c\u4f60\u4ecd\u7136\u505c\u7559\u5728\u201c\u4f4e\u201d\u8bbe\u7f6e\u4e0a\uff0c\u6240\u4ee5\u65e5\u5fd7\u6ca1\u6709\u8bf4\u8c0e\u3002\u4f60\u53ef\u80fd\u5e0c\u671b\u662f\u201c\u4e2d\u7b49\u201d\u7684\uff0c\u4f46\u662f\uff0c\u5509\uff0c\u4e0d\u662f\u3002\n\u8fd9", "note_en": "May 1st 2020 \u2014 if you\u2019re like me, quarantine is making you want to replay games you haven\u2019t touched in years. If you\u2019re further like me, you might have a copy of Age of Empires 3 stored somewhere. You might be playing on a Mac, you might not yet have upgraded to Catalina, and you might be eager for some of that Morgan Black action.\n So you boot the game, you land on the Main Menu, and you immediately notice something is wrong\u2026 It looks like  hot  garbage.\n   So, you hop over to the options, boost everything up\u2026 \u2026And it\u2019s still ugly.\n Suspiciously, you notice, the \u201c Shader Quality\u201d options is locked to \u201c Low\u201d.\n  At this point, you\u2019ll look for the folder the game has expectedly created somewhere in your Documents, because it\u2019s 2005 and that\u2019s what games do.\n What are you looking for, you ask? The file where settings are stored, of course. The interface can lock you out, but you\u2019re a thrifty man, aren\u2019t ya. So you find the XML you\u2019re looking for, because it\u2019s 2005 and of course it\u2019s XML, and stumble upon a \u201c optiongrfxshaderquality\u201d option set to 0. That looks right, you think, and so you bump that to 100 because one can never go wrong with too much quality. We are in agreement.\n  Content, you boot the game up. However,  patatras (it\u2019s French, look this up), nothing changed. And as you look at the ol\u2019 XML file, the setting is back to 0. Ensemble Studios (RIP) has looked at your craftiness and crapped all over it.\n At this point, you  might give up. This is a Mac system and you\u2019re unlikely to find a user-patch (well \u2014 I\u2019ve looked around a bit. There\u2019s some shady stuff here and there. Might work.) It\u2019s just graphics. It sounds annoying to fix.\n But you\u2019re not going to. Because you remember how Age 3 should look like. You remember looking at that beautiful wavy water. At those particle effects. At those huge ships that simply wouldn\u2019t fit in the goddamn  fucking frame. Jesus that camera is zoomed in. What were they thinking.\n  At the top of that Folder in your Documents, there is a log file. The game shows a graphic card, and says it\u2019s picking the \u201cgeneric dx7\u201d setting. It\u2019s saying you\u2019ve got an Intel GMA 950, which your previous computer indeed had. This one, though, has an Intel Iris Graphics 6100. Something is indeed wrong. You take a wild guess that the game is determining your computer \u2019s graphics capabilities by matching it against a database of graphics cards, instead of doing the right thing and checking the capabilities  ...\n  Incidentally, you find old  patch notes. Those confirm your fears. You look around at some files in the GameData folder, but it\u2019s all  .bar and  .xmb files, and those are mostly unreadable. You grep for \u201c Intel\u201d, for \u201c dx7\u201d. Nothing happens. You delete some files\u2026 Nothing happens. Well, you know that AAA games might want to bundle some resources in weird places, and this is a Mac port of a Windows game, so you know, maybe things are odd.\n Still, you end up finding a \u201crender.bar\u201d file, and moving that one crashes at startup. That\u2019s vaguely good. You open that file in  Hex Fiend, because that usually can tell you a few things about binary files. And well, it does. Some of that data is readable text. Some of it is shaders. But most of it is oddly separated by empty spaces\u2026\n  \u201cObviously, that\u2019s UTF-16\u201d, you exclaim ! This is originally a Windows game, it makes perfect sense they\u2019d store text in UTF-16, wasting basically half the space of the 30Mb data file. After all, Windows loved UTF-16 (though it  shouldn\u2019t), and why not use that and ASCII shaders in the same file. Perfectly sensible idea!  (Not shown: this took me like a day to realise)\n Anyways. Hex Fiend actually has an option to parse bytes as UTF-16, so you grep for dx7. That gives you a few hits. You replace all of that with dx9, which also shows up in that data occasionally, you save and you boot up the game. Welp. The logs don\u2019t even say \u201cdx9\u201d. That\u2019s probably defined elsewhere.\n  Let\u2019s try something else. You assume the game is detecting graphic cards, and you have Hexadecimal identifiers in the logs (in my case, 0x8086 \u2014 Intel, and 0x2773). Grepping for \u201c8086\u201d in Hex Fiend hits somewhere, and some of that text looks encouraging. Intel 9 Series is the GMA 950 series, and it probably didn\u2019t run Age 3 very well.\n  Some numbers there look like identifiers of cards (2582, 2592), so maybe changing those will do something. You\u2019ve made a copy of the file anyways, so it can\u2019t hurt to try.\n Sadly, that too is a dead end. Truth is, you\u2019re looking at the wrong file. Thankfully, I can tell you that because I\u2019ve spent too much time on this and tried  way too many things. This bloody thing took upwards of 20 hours. And that\u2019s not counting the time to take all those screenshots\u2026\n Anyways, the correct file is \u201cDataP.bar\u201d, and if you replace IDs smartly, the logs will show something completely new:\n  Of course, in-game, you\u2019re still stuck on the \u201cLow\u201d setting, so the logs aren\u2019t lying. You might have hoped for \u201cMedium\u201d, but  alas, no.\n This seems to be as much as you can do from hacking the data. Time to bring out the big gun.\n  So, with all else failing, we\u2019ve only got one last thing to do: change the executable itself (aka \u201ccracking\u201d back in 2005). Nowadays, I suppose we\u2019d just call it hacking, but the word has stuck in the game piracy sphere (not that I\u2019ve  ever been anywhere near that, of course).\n It\u2019s time for the actually interesting part of this article (yeah we\u2019re over a thousand words in already, but are you not entertained?).\n  Our tool of choice for this step will be a disassembler: an application that takes the binary code of the executable and turns it into readable (haha) assembly code. The most famous one is IDA Pro, but it\u2019s crazy expensive and I\u2019m not sure it runs on a Mac, so I\u2019ll go with  Hopper. It\u2019s not free (it\u2019s actually 90$), but you can freely use it for 30 minutes at a time with mostly all required functionality. I won\u2019t go into too many details about how the interface looks, as the  Hopper tutorial  ...\n First, a note: this took me like 5 days to get right, and many unsuccessful attempts were made. I\u2019ll mostly only show the successful path, so it might look kind of magic. But this is  hard. Don\u2019t worry if you\u2019re struggling.\n And another note: \u201ccracking\u201d is generally illegal and/or done for illegal purposes. This is a rare example of a rather legitimate use case which is also fairly \u201cwhite hat\u201d, so that\u2019s nice. I do believe it\u2019s technically illegal / against the EULA, but this a obviously a  force majeure case. Anyways, please pay for things you enjoy, and only those because anti-consumerism is cool.\n  This can, perhaps surprisingly, be the most tricky part. You have all of the disassembled code, and no idea where to look. True, some games ship with some level of debug symbols, making function names readable, but this one doesn\u2019t. Hopper gives you \u201csub_a8cbb6\u201d and you\u2019ll have to make do with that.\n Thankfully, we do have a head start: our  log file. It\u2019s quite likely that writing to the log uses  string literals, which basically means it\u2019s ASCII hardcoded in the executable. That\u2019s something you can grep for, because no amount of compiling will delete it (code obfuscation might hide it though. Thankfully, this isn\u2019t the case here). Grepping for string literals is usually the first thing you\u2019ll do when disassembling something. So let \u2019s go ahead and type \u201cfound vendor \u201din the Hopper search, and  ...\n  On its own, this really wouldn\u2019t move you forward too much. But since the adress of this \u201cliteral string\u201d is hardcoded, you can actually find references to it. Hopper does that for you in the green bits on the right : \u201cDATA XREF=sub_1d5908+1252\u201d. Double-clicking on that will take you to the  sub_1d5908 procedure, our hero of the day.\n  There we find assembly code. Unlike what you may think, assembly code is very easy to read. The hard part is understanding it.\n Hopper uses \u2018Intel Syntax\u2019 by default, which means the first operand is the destination, and the second one is the source. On the highlighted line, you see  mov dword [esp+0x1DC8+var_1DC4], aXmlRenderConfi. Let\u2019s unpack that.\n  mov is the MOV instruction, famously  turing-complete on x86. It moves (well, it copies) data from A to B, which basically means it reads A and writes it at B. Given what I\u2019ve told you above,  aXmlRenderConfi is A, and  dword [esp+0x1DC8+var_1DC4] is B, the destination. Let\u2019s unpack that further.\n aXmlRenderConfi is actually Hopper helping us. The truth is, this is an alias for the memory address of the string literal we clicked on a few seconds ago. If you split the window and look at things in Hex-mode (the  preferred hacker mode anyways), you\u2019ll see  88 18 83 00 on the right there.\n  If you \u2018reverse\u2019 that in just the right way, it\u2019s 0x00831888, the memory address of the string literal (it\u2019s even highlighted in yellow in one of the above screenshots). So that\u2019s one mystery solved: we\u2019re MOV-ing, i.e. writing, the address 0x00831888.\n Why is it spelled  88 18 83 00 and not  00 83 18 88 ? Well, this is because of  Endianness, a rather arcane topic which usually has little impact. It\u2019s just one of those things that make people go \u201cyou know, computers don\u2019t work\u201d (I\u2019ve looked for a citation for this, and failed, but I know it\u2019s out there). What it means for us is that all numbers we\u2019ll look at today have this problem.\n You might have noticed that I\u2019ve said we wrote the address, and this is right: we don\u2019t actually care about the content, which happens to be a NULL-terminated string literal. We\u2019re writing the address because code down the line will refer to that address. It\u2019s a pointer.\n What about  dword [esp+0x1DC8+var_1DC4] then? This one is trickier.   dword technically means we are operating on \u201cdouble-words\u201d, aka 16*2 bits. Which means we\u2019re copying 32 bits. Recall: our memory address is  0x00831888, which is 8 hexadecimal characters, and each hexadecimal character can take 16 values, which is 4 bits of data. So that \u2019s 8*4 = 32. By the way, that \u2019s where \u201c32 bits \u201din computer systems comes from. If we were using 64 bits, our memory address would be written 0x001122334455667788,  ...\n Now, what\u2019s that bracketed bit? The brackets mean we\u2019ll compute whatever is inside, and treat it like a pointer. Our MOV will thus write at whatever memory address this evaluates to. Again, let\u2019s break it down (and don\u2019t worry, once this is done, you\u2019ll basically know how to read assembly code in Intel Syntax).\n esp is a  Register, which is the closest equivalent of a variable in assembly. The x86 architecture has plenty, they\u2019re somewhat distinct in their usage, but we generally won\u2019t care much. You can find details  here. Just know that there are special registers for floating point, and we also have \u201cflags\u201d which are used for comparisons and such. The rest is simply numbers written as hexadecimals, and Hopper has reprocessed them somewhat to help.  var_1DC4 is  -0x1DC4, you can see that at the  ...\n So, to recap, we\u2019re writing the address of our string literal to \u201cesp+4\u201d. This is correct information, but extremely useless. What does it mean?\n This is the tricky bit when reading Assembly code: figuring out what this is supposed to be doing. Here, we have a head start: we know that this is probably logging something. So we can expect a function call that logs stuff. Let\u2019s look around.\n  There are several similar calls above, and the a  call instruction, which calls a procedure. Hopper would usually say it (not sure why it doesn\u2019t here), but what is happening is basically that we\u2019re setting up the arguments for our function call. If you click around the different sub-calls, you\u2019ll see stuff named imp___jump_table___Z22StringVPrintfExWorkerAPcmmPS_PmmPKcS_. This is a  name-mangledfunction name, and \u201cPrintf \u201dis enough to now that this indeed prints things. Don \u2019t care  ...\n  At this point, you\u2019ve completely lost track of what you were doing: trying to make the game acknowledge that your 2015 graphics card is indeed powerful enough to run a 2005 game. Let\u2019s recap. We\u2019ve found the place where logging takes place. If we\u2019re lucky, this is also the place where the code that checks our settings and our graphics cards capabilities is. And, thankfully, we are lucky (there\u2019s a pretty good chance I couldn\u2019t write this article otherwise).\n To get the bigger picture, we\u2019ll use Hopper\u2019s Control Flow Graph feature, which breaks down code in little blocks and draws arrows to represent the various jumps. This is much easier to grok than the actual assembly which is often terribly out of order.\n  Our logging call is in the middle of a terribly long function, because again, that\u2019s what AAA games do. This is the point where one would look around for other string literals and Hopper \u201chints\u201d, hoping to find something. I\u2019ll give you some pointers (eh). You\u2019ll see at the top of the procedure the rest of the logging, and down below some interesting bits about \u201cforcing dx7\u201d or \u201cVery High\u201d settings and a pixel shader version issue\u2026  Which we have.\n The log of our \u201chacked\u201d data said we had pixel shader version 0.0 which was incompatible with the \u201cHigh\u201d setting. That code lives in the bottom-left of our function, and if you squint you\u2019ll see something peculiar (highlighted in terrible style by yours truly): this is just 4 times the same code, for each of \u201cVery High\u201d, \u201cHigh\u201d, \u201cMedium\u201d and \u201cLow\u201d. And yes, this took me hours to see.\n  The only differences are that we are writing \u201c0x0\u201d, \u201c0x1\u201d, \u201c0x2\u201d and \u201c0x3\u201d in a bunch of places. This looks suspiciously similar to our Settings file from earlier and the  optiongrfxshaderquality setting (well, you might not know that yet. But it does, believe me).\n At this point, we could try several things, and indeed I did. But to cut this short \u2014 he says, now almost 3000 words in \u2014 we\u2019ll do the right thing: figure out why our pixel-shader check fails. Let\u2019s look for a branch. The logging block is linear, so it must be before.\n  Indeed, right above that is a  jb instruction, a jump instruction (think \u201cgoto\u201d). This is a \u201c conditional jump\u201d, and the condition is \u201c if below\u201d. The way Assembly \u2018ifs\u2019 work is through the  register flags I briefly mentioned before. Just know that usually you simply have to look at the instruction above: that one probably sets the flag. That instruction is often  cmp or  test , but here it\u2019s  ucomiss . That\u2019s barbarian. It\u2019s also easy to Google:  ucomiss. It \u2019s a compare instruction  ...\n Now how do we fix this? Well, this compare instruction compares with the value in  xmm0 , which is set in the line above:  movss xmm0, dword [eax+0xA2A8] . MOVSS is a special \u201cmove\u201d instruction for floating-point registers, and we\u2019re writing 32 bits from whatever eax+0xA2A8 evalutes to.\n   We\u2019re finally ready to l33t our way in the game\u2019s High setting. What we want is to take the \u201cred\u201d path in the CFG above, and skip this \u201cwrong pixel shader version\u201d logic. We can achieve that by making the comparison succeed, by reversing the jump condition, but we have one more trick: the code is setup such that deleting the jump will make us take the \u201cred\u201d path. Let\u2019s simply replace the jump with a  nop, an operation that does nothing (you can \u2019t simply delete \u2014or add \u2014data  ...\n I recommend switching out of CFG for this, as Hopper kinda freaks out otherwise. If you do it right, you\u2019ll see some red bits in the Hex window.\n  Those red bits are the changes we\u2019ve made. At this point, if you\u2019ve paid for Hopper, you can simply save the file. But I haven\u2019t, so I\u2019ll open the executable in Hex Fiend, find the proper region (by copying a section from Hopper in the Find tab of Hex Fiend), and modify it manually. Be careful here, you can break everything, so I\u2019d recommend copying the original executable somewhere.\n With that done, start the game, hop on to the settings\u2026 And Hurray, you can choose \u201cHigh\u201d. Can\u2019t choose \u201cmedium\u201d though. And you can\u2019t use the high shadow settings. But still, progress !\n   Truth is, there is a better way to fix this. Our solution worked somewhat, but we can do better by making the condition succeed in the proper way: by actually making the game think our graphic card has 2.0 capability.\n If you recall, the game loaded up the value at  eax+0xA2A8 . We can use Hopper to figure out what is originally written there. What we\u2019re looking for is an instruction where 0xA2A8 appears in the \u2018destination\u2019 operand (I use 0xA2A8 because it looks quite specific and we can\u2019t be sure the same register will be used elsewhere). Hopper highlighting is very useful here, as we can simply click on 0xA2A8 and look for yellow bits in the CFG.\n  Victory is found a fair bit above: we are writing the value of some floating-point register, as expected. I confess I don\u2019t really understand what is happening right before that (best guess: the game checks for texture compression capabilities), but that\u2019s not really important. Let\u2019s write \u201c2.0\u201d and be on our way.\n To do that, we\u2019ll use Hopper\u2019s \u201cAssemble instruction\u201d, and then do the same hex-fiend manipulation.\n  You\u2019ll notice that something weird happened: we\u2019ve \u201ceaten\u201d the  jb instruction. That\u2019s because our new instruction takes up more bytes than the one before, and as said above we can\u2019t add or delete data from an executable to preserve offsets. So Hopper had no choice but to destroy the  jbinstruction. This could be a problem, and we might fix it by actually moving the instruction above (we no longer need to set up xmm3 after all). Here, it \u2019ll work anyways because we \u2019re taking the branch we wanted  ...\n If you start things up\u2026 Well, nothing\u2019s really changed. My best guess is that the Intel 9 series is not fast enough and the game complains. It\u2019s no biggie, because what we really want is that \u201cVery High\u201d goodness.\n What was the most powerful card around 2004? The NVIDIA GeforceFX 6800. Let\u2019s trick the game into believing that\u2019s what we have.\n   What we know is that the game uses Hex codes to identify graphics card, and it\u2019s fetching stuff from data files. We know that this must take place in the function we\u2019ve been looking at (or at least it\u2019d be really weird if it didn\u2019t). So we should be able to find the code doing it. Still, this might be tricky, since we don\u2019t really know what to look for.\n We do have one hint: the options are acting weird, with this \u201cLow/High but no Medium\u201d business. So perhaps there is other code handling this \u201cVery High\u201d, \u201cHigh\u201d, \u201cMedium\u201d, \u201cLow\u201d thing. And indeed, there is, in this very function. It\u2019s much earlier in the CFG, and it looks interesting.\n  We can assume that the raw data is some form of XML, because that\u2019s quite likely given there\u2019s several other data files that are XML. And XML is basically a bunch of pointers, and attributes. So this code here is likely checking for some XML attributes (indeed below there is a \u201cexpected one of ID, Very High \u2026\u201d which looks a lot like a file sanity-check). We can kind of imagine an XML structure like that, with booleans for the shader qualities:\n  The very interesting bit is on the left of the CFG (well, it could be on the right for you, but it\u2019s on the left in the above screenshot): we see the same  var_CC which is used by the code that logs the device ID. So  ebp+var_CCprobably refers to our device ID, 0x2773. The weird thing is the first \u201ccheck \u201ddoesn \u2019t show a string literal, but that \u2019s a Hopper bug: the adress 0x0089da8e contains Hex Data 69006400, which is UTF-16 for \u201cid \u201d(the fact it \u2019s UTF16 is probably why Hopper cannot grasp  ...\n You know what? Let\u2019s start a debugger and check it out for real.\n  Open a terminal window, and start lldb (just type lldb and enter). First we need to tell LLDB to target Age 3, then we can run the game by calling  run . So far, so good. The game runs, nothing useful is gained.\n  What we need to do is add a breakpoint: we want to stop the execution when we reach the code above to check our assumptions. We don\u2019t have source code, but that doesn\u2019t matter: we can set breakpoints at a memory address. And we do have the address of the code. Let\u2019s break at the MOV call that fetches \u201cid\u201d, its address is 0x001d5e68. Setting up the breakpoint is as easy as  br set -a 001D5E68. When we run, the game stops there and LLDB shows the disassembly (in AT&amp;T syntax, not Intel,  ...\n  To move further, let\u2019s \u201cstep instruction\u201d. The shortcut is  ni . After a few times, you\u2019ll notice you\u2019re back where you were. This is a loop! It makes perfect sense: we\u2019re probably iterating over some XML. Hopper was in fact showing this, if you follow the CFG you\u2019ll see a (possible) loop.\n  Its exit condition is that  ebp+var_1D84 must be non-null. And we see some code setting that right where I highlighted the interesting  var_CC stuff.\n  We\u2019ll look at registers with  reg r , and our memory value with  mem read $ebp-0x28 .  eax indeed contains 0x2773, and the value in memory is now 0x00A0. If you  thread c a few times, you\u2019ll see that we\u2019re iterating different IDs, checking for a match. At some point it matches, exits the loop, and the game starts. So now we know how to control this.\n Remember the log file: it found both device and vendor. So there\u2019s probably a similar loop for the vendor somewhere else. Indeed, it\u2019s quite similar and right above in the CFG. The loop is slightly simpler, and we\u2019re looking for \u201cvendor\u201d.\n This time the comparison is with  var_D0 . This is indeed used by the logger for the vendor ID. If we put a breakpoint there and check things out, we see our familiar 0x8086 in  eaxand we\u2019re comparing against 0x10DE at the moment. Let\u2019s write that into  eax and see what happens.\n  So 0x10DE is NVIDIA. In fact, looking at the data file would have hinted at that\u2026 But that\u2019s just not fun. Now the question is: what\u2019s the identifier of the GeforceFX 6800? We could also use LLDB and just try every identifier, but that\u2019ll take some time (as there are many, I\u2019ve tried for a while). So let\u2019s look into render.bar this time.\n  Well, this is a bit of a messy file. But after the Geforce FX 6800 tags, you can see a bunch of identifiers. One of those is probably a match. Let\u2019s try 00F1.\n The simplest way to test this is through LLDB by setting the appropriate breakpoints \u2014 I\u2019m skipping, but 00F1 works (thankfully).\n At this point, the question becomes \u201cHow do we make this permanent?\u201d It seems like a simple way would be to change the  var_CC and  var_D0 values to 0X00F1 and 0X10DE, respectively. We just need to get some code-space to do that.\n One simple solution is to NOP one of the logging calls, for example the subsystem call. It\u2019ll free up a few dozen bytes, more than needed. Let\u2019s select it all, and NOP it. Then we simply need to MOV some things in our variables: Assemble  mov dword [ebp+var_CC], 0xF1 and  mov dword [ebp+var_D0], 0x10DE .\n  Let\u2019s start up the game. Now we\u2019re getting somewhere: you can pick from Low, Medium or High, and you can activate High shadows.\n  But we still can\u2019t get Very High, and that makes Afroman unhappy. What\u2019s going on?\n  Right. As it turns out, the Geforce FX 6800 is supposed to support pixel shader version 3.0, and we\u2019ve configured ourselves for 2.0. This is a simple fix at this point: we just need to write float 3.0 in  ebp+0xA2A8 . That\u2019s 0x40400000.\n  And that\u2019s the end of the road. Thank FUCK, and thanks for reading.\n As a freebie, since every resource I\u2019ve found online is broken, terrible quality or incomplete, here\u2019s what the settings actually look like in-game.\n Medium is acceptable, but the lack of shadows hurts. From what I can tell, Very High mostly adds a completely different LUT (good explanation at \u201cColor Grading\u201d  here), distance fog, perhaps even a different lighting model altogether? It looks quite different, which is somewhat strange.\n  The blog I\u2019ve linked just above is excellent at breaking down modern rendering pipelines:  http://www.adriancourreges.com/blog/\n Have a look at 0 A.D., an open-source (the libre kind, not the Docker kind) RTS games in the same genre:  https://play0ad.com . It needs devs.\n If you want to know more about the XMB format, you can look at  0 A.D.\u2019s code for it. I haven\u2019t actually checked, but I\u2019m pretty sure it\u2019s the same format, because the guy who wrote the  XMB decoder for Age 3 on Age of Empires heaven (that takes me back, though I was more active on RoN back then) is the same guy who committed those files in 2004 in the 0 A.D. source code. So that\u2019s a fun bit of code paleontology. Thanks for all your work Ykkrosh.\n I also distinctly remember reading a great tutorial on how to use Hopper, but I couldn\u2019t find the link again. If somebody knows what I\u2019m talking about\u2026\n Finally, I\u2019d like to plug the Cosmic Frontier project: a remake of the classic Escape Velocity series (Override specifically, but Nova-compatible). It\u2019s such a great game, and it\u2019s such a shame it\u2019s not more well known. They\u2019ve got a  kickstarter running, and the lead dev has a very interesting  dev blog where they use Hex Fiend to reverse-engineer the data formats of the original game. It\u2019s a great read. If you think  this was crazy, in one article they:\n Start up an emulator for Classic Mac to be able to use long-deprecated APIs to read the encrypted data file.\n Yeah. There are truly dedicated people out there, and I do wish this project succeeds, because EV Nova is perhaps my favourite game of all time.", "posttime": "2020-05-03 03:34:22", "tags": "\u7834\u89e3,iii,age,\u6e38\u620f,game", "title": "\u5e1d\u56fdIII\u5728\u7740\u8272\u5668\u8d28\u91cf\u8bbe\u7f6e\u4e0a\u7684\u7834\u89e3\u65f6\u4ee3", "title_en": "Cracking Age of Empires III over shader quality settings", "transed": 1, "url": "https://medium.com/@lancelot.deferriere/cracking-age-of-empires-iii-over-shader-quality-settings-7f729528cf1d", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u7834\u89e3", "iii", "age", "\u6e38\u620f", "game"]}, {"category": "", "categoryclass": "", "imagename": "421e964119b476daab1c1514b735f7c3.jpeg", "infoid": 1000397, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u8fd9\u573a\u5927\u6d41\u884c\u5bf9\u7ec4\u7ec7\u7684\u751f\u5b58\u662f\u4e00\u4e2a\u771f\u6b63\u7684\u8bc1\u660e\u3002\u867d\u7136\u8bb8\u591a\u7ec4\u7ec7\u90fd\u5c48\u670d\u4e8e\u51a0\u72b6\u75c5\u6bd2\u9020\u6210\u7684\u7ecf\u6d4e\u5f71\u54cd\uff0c\u4f46\u4e5f\u6709\u5c11\u6570\u7ec4\u7ec7\u5728\u9006\u5883\u4e2d\u83b7\u5f97\u4e86\u5de8\u5927\u6536\u76ca\u3002\u4f8b\u5982\uff0cZoom\u548cCitrix\u7b49\u54c1\u724c\u62a5\u544a\u79f0\uff0c\u968f\u7740\u4e16\u754c\u9009\u62e9\u8fdc\u7a0b\u8fde\u63a5\uff0c\u6536\u5165\u548c\u5b63\u5ea6\u6536\u76ca\u90fd\u6709\u6240\u589e\u52a0\u3002\u540c\u6837\uff0c\u50cfGilead\u8fd9\u6837\u7684\u5236\u836f\u516c\u53f8\u4e5f\u8d70\u4e0a\u4e86\u76c8\u5229\u7684\u9053\u8def\u3002\n\u201c\u53cd\u8106\u5f31\u201d\u8fd9\u4e2a\u8bcd\u662f\u7531\u7eb3\u897f\u59c6\u00b7\u5854\u52d2\u5e03\u9996\u521b\u7684\uff0c\u7b80\u800c\u8a00\u4e4b\uff0c\u5b83\u7684\u610f\u601d\u662f\u201c\u4ece\u6df7\u4e71\u4e2d\u83b7\u76ca\u7684\u4e1c\u897f\u201d\uff0c\u6b63\u5982\u4ed6\u7684\u4e66\u201c\u53cd\u8106\u5f31\u201d\u4e2d\u6240\u63cf\u8ff0\u7684\u90a3\u6837\u3002\u73b0\u5728\u53cd\u8106\u5f31\u7684\u516c\u53f8\u53ef\u80fd\u4e0d\u662f\u6545\u610f\u8bbe\u8ba1\u6216\u5efa\u9020\u6210\u8fd9\u6837\u7684\uff0c\u4f46\u5b83\u4eec\u5728\u6b63\u786e\u7684\u65f6\u95f4\u62e5\u6709\u6b63\u786e\u7684\u4ea7\u54c1\u548c\u670d\u52a1\u3002\u5176\u4ed6\u7ec4\u7ec7\uff0c\u5982\u5fae\u8f6f\u548c\u4e9a\u9a6c\u900a\uff0c\u90e8\u5206\u662f\u53cd\u8106\u5f31\u7684\uff0c\u5bf9\u8fdc\u7a0b\u8fde\u63a5\u7684\u9700\u6c42\u589e\u52a0\uff0c\u4e91\u57fa\u7840\u8bbe\u65bd\u7684\u5347\u7ea7\u548cEssential.\u3002\n\u4e8b\u5b9e\u8bc1\u660e\uff0c\u62e5\u6709\u4e00\u79cd\u6216\u591a\u79cd\u5728\u5927\u6d41\u884c\u65f6\u671f\u5177\u6709\u6297\u8106\u6027\u7684\u4ea7\u54c1\u662f\u6709\u76ca\u7684\u3002\u5373\u4f7f\u6709\u5341\u79cd\u6613\u788e\u4ea7\u54c1\u53d7\u5230\u51b2\u51fb\uff0c\u4e00\u79cd\u6216\u51e0\u79cd\u9632\u8106\u4ea7\u54c1\u4e5f\u53ef\u4ee5\u5f25\u8865\u635f\u5931\u3002\u7136\u800c\uff0c\u8fd9\u79cd\u6536\u76ca\u53ef\u80fd\u662f\u6682\u65f6\u7684\uff0c\u56e0\u4e3a\u968f\u7740\u5927\u6d41\u884c\u7684\u5e73\u606f\uff0c\u9700\u6c42\u4f1a\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u800c\u4e0b\u964d\u3002\n\u53cd\u8106\u5f31\u6027\u5e76\u4e0d\u5c40\u9650\u4e8e\u5f53\u524d\u6240\u9700\u7684\u6210\u529f\u4ea7\u54c1\u548c\u670d\u52a1\u3002\u63d0\u524d\u601d\u8003\uff0c\u5e76\u5236\u5b9a\u5f3a\u6709\u529b\u7684\u5e94\u6025\u8ba1\u5212\uff0c\u53ef\u80fd\u6709\u52a9\u4e8e\u5c06\u7ecf\u6d4e\u5d29\u6e83\u7684\u6124\u6012\u964d\u81f3\u6700\u4f4e\u3002\u6e29\u5e03\u5c14\u767b\u4e5f\u8bb8\u662f\u62e5\u6709\u5f3a\u5927\u5e94\u6025\u8ba1\u5212\u7684\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u3002\u5728\u8fc7\u53bb\u768417\u5e74\u91cc\uff0c\u4f5c\u4e3a\u201c\u4e0d\u53ef\u6297\u529b\u201d\u6761\u6b3e\u7684\u4e00\u90e8\u5206\uff0c\u6e29\u5e03\u5c14\u767b\u6bcf\u5e74\u652f\u4ed8200\u4e07\u7f8e\u5143\u7684\u5927\u6d41\u884c\u4fdd\u9669\uff0c\u5e76\u5c06\u83b7\u5f971.41\u4ebf\u7f8e\u5143\u7684\u8d54\u4ed8\u3002\u6e29\u5e03\u5c14\u767b\u53ef\u80fd\u4e0d\u4f1a\u4ece\u652f\u51fa\u4e2d\u83b7\u76ca\u3002\n\u54c1\u724c\u5e94\u8be5\u4ece\u522b\u4eba\u7684\u9519\u8bef\u548c\u4ed6\u4eec\u4e3a\u9632\u6b62\u672a\u6765\u540e\u679c\u800c\u91c7\u53d6\u7684\u884c\u52a8\u4e2d\u5438\u53d6\u6559\u8bad\u3002\u6e29\u5e03\u5c14\u767b\u57282003\u5e74SARS\u51a0\u72b6\u75c5\u6bd2\u75ab\u60c5\u540e\u75db\u82e6\u5730\u5438\u53d6\u4e86\u6559\u8bad\u3002\u5176\u4ed6\u4f53\u80b2\u548c\u5927\u578b\u5e74\u5ea6\u8d5b\u4e8b\u53ef\u4ee5\u901a\u8fc7\u826f\u597d\u7684\u5e94\u6025\u8ba1\u5212\u5f00\u59cb\u4fdd\u969c\u81ea\u5df1\u7684\u672a\u6765\u3002\n\u5c31\u4e2a\u4eba\u800c\u8a00\uff0c\u51a0\u72b6\u75c5\u6bd2\u5927\u6d41\u884c\u7684\u542f\u793a\u662f\uff0c\u62e5\u6709\u4e00\u79cd\u6216\u591a\u79cd\u53cd\u8106\u5f31\u7684\u4ea7\u54c1\u3001\u670d\u52a1\u3001\u89c4\u5212\u548c\u60f3\u6cd5\u53ef\u4ee5\u5e2e\u52a9\u5728\u9006\u5883\u4e2d\u53d8\u5f97\u66f4\u5f3a\u5927\u3002\u5bf9\u4e8e\u4e2a\u4eba\u6765\u8bf4\uff0c\u62e5\u6709\u591a\u79cd\u6280\u80fd\u548c/\u6216\u654f\u6377\u6027\u6765\u5b66\u4e60\u548c\u9002\u5e94\u8fdb\u6b65\u53ef\u80fd\u6709\u52a9\u4e8e\u53d8\u5f97\u6297\u51fb\u8106\u5f31\u3002", "note_en": "The pandemic is a real testament to organizations for their survival. While many are succumbing to the economic impact caused by the COVID-19, there are a handful number of organizations that are making a substantial gain out of the adversity. For example, brands such as Zoom and Citrix have reported an increase in revenue and quarterly earnings as the world chooses to stay connected remotely. Similarly, pharmaceutical companies such as Gilead is on a path to make profit.\n The word antifragility was coined by Nassim Taleb and in simple words, it means \u201cthings that gain from disorder \u201das described in his book, Antifragile. The companies that are antifragile now were perhaps not intentionally designed or built to be one, but they possess the right products and services at the right time. Other organizations such as Microsoft and Amazon are partially-antifragile with an increase in demand for remote connectivity, upscaling the cloud infrastructure and sales of essential  ...\n Having one or more products that are antifragile in times such as pandemic is proving to be beneficial. Even if ten fragile products take the hit, one or more antifragile products can compensate for the losses. However, the gain could be momentary as demands decline over time as the pandemic settles.\n Antifragility is not limited to successful products and services that are need of the hour. Thinking ahead-in-time and having a strong contingency planning could help minimize the wrath of a collapsing economy. Wimbledon is perhaps a good example of having a strong contingency plan. For the last 17 years, Wimbledon paid $2 million dollars per year in pandemic insurance as part of the \u201cforce majeure \u201dclause and will be receiving $141 million as a payout. Wimbledon might not gain from the payout  ...\n Brands should learn from the mistakes of others and the actions taken by them to prevent future consequences. Wimbledon learnt the lesson the hard way after the 2003 SARS-CoV epidemic. Other sporting and large annual events could start securing their future with good contingency plans.\n Personally, the takeaway from the coronavirus pandemic is that having one or more antifragile products, services, planning and ideas could help emerge out stronger in adverse times. In individuals, having multiple skills and/or agility to learn and adapt to advancements could help being antifragile.", "posttime": "2020-05-03 03:34:11", "tags": "\u66b4\u9732,exposed,\u4ea7\u54c1,antifragile", "title": "\u8fd9\u573a\u5927\u6d41\u884c\u66b4\u9732\u4e86\u53cd\u8106\u5f31\u6027\u3002", "title_en": "The pandemic has exposed antifragility", "transed": 1, "url": "https://medium.com/@santhoshsundar/the-pandemic-has-exposed-antifragility-c37dc7ae4855", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u66b4\u9732", "exposed", "\u4ea7\u54c1"]}, {"category": "", "categoryclass": "", "imagename": "b784fdd044b45744e9e7f4ab7fa86ef3.png", "infoid": 1000396, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u9759\u6001\u7ad9\u70b9\u662f\u6700\u597d\u7684\u3002\u5b83\u4eec\u662f\u6700\u5b89\u5168\u3001\u6700\u5feb\u7684\u7f51\u7ad9\u3002\u5b83\u4eec\u975e\u5e38\u9002\u5408\u533f\u540d\u7528\u6237\uff0c\u4f60\u4f1a\u5e0c\u671b\u5185\u5bb9\u7f16\u8f91\u6709\u4e00\u4e2a\u5b89\u5168\u548c\u9690\u85cf\u7684\u540e\u7aef\uff0c\u4ed6\u4eec\u53ef\u4ee5\u5728\u90a3\u91cc\u7ba1\u7406\u5185\u5bb9-\u4f46\u5185\u5bb9\u53ef\u4ee5\u5728\u5176\u4ed6\u5730\u65b9\u63d0\u4f9b\u3002\n\u5728\u6b64\u57fa\u7840\u4e0a\u8fdb\u884c\u641c\u7d22\u53ef\u80fd\u4f1a\u66f4\u5177\u6311\u6218\u6027\u3002\u5bf9\u4e8e\u50cflunr.js\u8fd9\u6837\u7684\u672c\u5730\u641c\u7d22(\u4ee5\u53ca\u4e0e\u4e4b\u96c6\u6210\u7684Drupal\u6a21\u5757)\uff0c\u6709\u4e0d\u540c\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u4f46\u8fd9\u662f\u76f8\u5f53\u6709\u9650\u7684\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u5c06\u521b\u5efa\u4e00\u4e2a\u672c\u5730\u7d22\u5f15\uff0c\u5728\u90a3\u91cc\u60a8\u53ef\u4ee5\u8ba9\u4e00\u4e9bJS\u6765\u67e5\u770b\u5b83\uff0c\u4f46\u8fd9\u65e0\u6cd5\u4e0e\u6210\u719f\u7684\u641c\u7d22\u5f15\u64ce(\u5982Elasticsearch)\u76f8\u5339\u654c\u3002\n\u5728\u8fd9\u7bc7\u535a\u5ba2\u6587\u7ae0\u4e2d\uff0c\u6211\u5c06\u4e0e\u5927\u5bb6\u5206\u4eab\u6211\u4eec\u5efa\u7acb\u7684\u4e00\u4e2a\u6f14\u793a\u7f51\u7ad9\uff0c\u4f5c\u4e3a\u4e00\u4e2a\u5927\u5f97\u591a\u7684\u7f51\u7ad9\u7684\u6982\u5ff5\u8bc1\u660e\u3002\u6211\u4e0d\u6253\u7b97\u8be6\u8ff0\u9759\u6001\u7ad9\u70b9\u7684\u4f18\u52bf\uff0c\u800c\u662f\u8981\u4e0e\u5927\u5bb6\u5206\u4eab\u6307\u5bfc\u6211\u4eec\u7684\u9ad8\u7ea7\u6982\u5ff5\uff0c\u4ee5\u53ca\u4e00\u4e9b\u6280\u672f\u63d0\u793a\u3002\u867d\u7136\u5177\u4f53\u7684\u7ec6\u8282\u4e0eDrupal\u65e0\u5173--\u6211\u4eec\u7684\u5ba2\u6237\u7ad9\u70b9\u5728Drupal\u4e2d\uff0c\u56e0\u6b64\u56f4\u7ed5\u5b83\u8fdb\u884c\u6784\u5efa\u975e\u5e38\u65b9\u4fbf\u3002\u4f46\u662f\u4f60\u771f\u7684\u53ef\u4ee5\u7528\u4efb\u4f55\u4e00\u79cd\u8bed\u8a00\u505a\u5230\u8fd9\u4e00\u70b9\u3002\n\u4f7f\u7528\u9759\u6001\u7ad9\u70b9\uff0c\u90e8\u7f72\u548c\u6062\u590d\u90e8\u7f72\u5f88\u5bb9\u6613\u3002\u5982\u679c\u51fa\u4e86\u4ec0\u4e48\u5dee\u9519\uff0c\u8fd9\u4e0d\u8fc7\u662fgit\u63a8\u9001\u6216git\u6062\u590d\u800c\u5df2\u3002\u4f46\u662f\u641c\u7d22\u600e\u4e48\u529e\u5462\uff1f\u6b63\u5982\u6211\u4eec\u5df2\u7ecf\u63d0\u5230\u7684\uff0c\u6211\u4eec\u5e0c\u671b\u7ee7\u7eed\u4f7f\u7528Elasticsearch\u6765\u641c\u7d22\u805a\u5408(\u4e5f\u5c31\u662f\u3002\u65b9\u9762)\u3001\u62fc\u5199\u68c0\u67e5\u7b49\u3002\u4f46\u662f\uff0c\u6211\u4eec\u5982\u4f55\u652f\u6301\uff0c\u4f8b\u5982\uff0c\u5728\u90e8\u7f72\u4e2d\u56de\u6eda-\u786e\u4fdd\u641c\u7d22\u59cb\u7ec8\u53ea\u901a\u8fc7\u90e8\u7f72\u7684\u9759\u6001\u7ad9\u70b9\u4e2d\u5b58\u5728\u7684\u5185\u5bb9\u8fdb\u884c\u641c\u7d22\u3002\u8c22\u5929\u8c22\u5730\uff0cElasticsearch\u652f\u6301\u7d22\u5f15\u514b\u9686\uff0c\u6240\u4ee5\u6211\u4eec.\u3002\n\u9ed8\u8ba4\u7d22\u5f15\u662fDrupal\u5c06\u8fde\u63a5\u5230\u7684\u7d22\u5f15\uff0c\u5b83\u5c06\u662faread\u548cwrite\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u60a8\u53ef\u4ee5\u5c06\u5176\u89c6\u4e3a\u4e00\u4e2a\u201c\u4e3b\u201d\u7d22\u5f15\uff0c\u5c06\u4ece\u8be5\u7d22\u5f15\u4e2d\u83b7\u53d6\u5feb\u7167\u3002\n\u5f53\u6211\u4eec\u60f3\u8981\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9759\u6001\u7ad9\u70b9\u65f6\uff0c\u6211\u4eec\u8fd8\u4f1a\u521b\u5efa\u9ed8\u8ba4\u7d22\u5f15\u7684\u514b\u9686\u3002\u8fd9\u5c06\u662f\u4e00\u4e2a\u53ea\u8bfb\u7d22\u5f15\u3002\n\u6211\u4eec\u8d1f\u8d23\u8c03\u7528Elasticsearch\u7684JS\u5e94\u7528\u7a0b\u5e8f\u5e94\u8be5\u77e5\u9053\u53ea\u8bfb\u7d22\u5f15\u7684\u540d\u79f0\u3002\u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u5c06\u90e8\u7f72\u56de\u6eda\u5230\u4ee5\u524d\u7684\u7248\u672c\uff0cJS\u4ee3\u7801\u5c06\u8fde\u63a5\u5230\u6b63\u786e\u7684\u7d22\u5f15\u3002\n\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0bElasticsearch\u5b9e\u4f8b\u53ca\u5176\u5bf9\u5916\u516c\u5f00\u60c5\u51b5\u3002\u5c31\u50cf\u6211\u4eec\u5c06Drupal\u653e\u5728\u540e\u7aef\uff0c\u8fdc\u79bb\u516c\u4f17\u89c6\u7ebf\u4e00\u6837\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528Elasticsearch\u505a\u540c\u6837\u7684\u4e8b\u60c5\u3002\u4f8b\u5982\uff0c\u5f53\u6211\u4eec\u5728Google Cloud\u4e0a\u6258\u7ba1Elasticsearch\u5b9e\u4f8b\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u5668\u6765\u63d0\u4f9b\u4e00\u4e2a\u9762\u5411\u516c\u4f17\u7684SSLed URL-\u53cd\u8fc7\u6765\uff0c\u5b83\u5c06\u4f7f\u7528\u6240\u9700\u7684\u4efb\u4f55\u7c7b\u578b\u7684\u9632\u706b\u5899\u89c4\u5219\u8c03\u7528Elasticsearch\uff0c\u4f8b\u5982\u9632\u6b62\u4efb\u4f55\u7ba1\u7406\u5458\u7c7b\u578b\u7684\u8bf7\u6c42\u8bbf\u95ee\u8be5\u5b9e\u4f8b\uff0c\u6216\u8005\u963b\u6b62\u4efb\u4f55\u8bf7\u6c42.\u3002\n\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u5f00\u59cb\u7814\u7a76Tome\uff0c\u8fd9\u662f\u4e00\u4e2a\u5141\u8bb8\u5c06Drupal\u7ad9\u70b9\u5bfc\u5165\u9759\u6001\u7ad9\u70b9\u7684Drupal\u6a21\u5757\u3002\u867d\u7136\u5b83\u5de5\u4f5c\u5f97\u5f88\u597d\uff0c\u800c\u4e14\u6211\u786e\u4fe1\u4f7f\u7528\u5b83\u4f1a\u6709\u597d\u5904\uff0c\u4f46\u6211\u8ba4\u4e3a\u5728\u6211\u4eec\u7684\u60c5\u51b5\u4e0b\uff0c\u5e76\u6ca1\u6709\u771f\u6b63\u9700\u8981Drupal\u672c\u8eab\u6765\u63d0\u4f9b\u5bfc\u51fa\u3002\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5f00\u6e90\u5de5\u5177\uff0c\u5b83\u4eec\u5df2\u7ecf\u5b58\u5728\u597d\u51e0\u5e74\u4e86\u3002\n\u7136\u540e\u5f00\u59cb\u4e86\u4e00\u573a\u6bd4\u9884\u671f\u66f4\u957f\u7684\u8bd5\u9a8c\uff0c\u5e76\u5bf9HTTrack\u548cwget\u8fdb\u884c\u4e86\u6bd4\u8f83\u3002\u867d\u7136\u6211\u4eec\u6700\u7ec8\u8fd8\u662f\u6ca1\u6709\u53bb\uff0c\u4f46\u5206\u4eab\u4e00\u4e9b\u6211\u4eec\u7684\u7ecf\u9a8c\u662f\u503c\u5f97\u7684\u3002\u9996\u5148\uff0c\u6211\u4eec\u5c1d\u8bd5\u4e86HTTrack\uff0c\u6211\u4eec\u5df2\u7ecf\u7528\u5b83\u6765\u5e2e\u52a9\u6211\u4eec\u5c06\u4e00\u4e9b\u8001\u7f51\u7ad9\u79fb\u5230\u9759\u6001\u72b6\u6001\uff0c\u5b83\u505a\u5f97\u5f88\u597d\u3002\u4ee4\u4eba\u60ca\u53f9\u7684\u51ef\u4f26\u00b7\u53f2\u8482\u6587\u68ee(Karen Stevenson)\u4e5f\u5c31\u6b64\u5199\u4e86\u4e00\u7bc7\u5f88\u68d2\u7684\u5e16\u5b50\uff0c\u5185\u5bb9\u66f4\u8be6\u7ec6\u3002HTTrack\u7ed9\u6211\u7684\u5370\u8c61\u662f\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u62e5\u6709\u770b\u8d77\u6765\u50cf\u770b\u8d77\u6765\u4e00\u6837\u8fc7\u65f6\u7684Asite\u7684\u5de5\u5177\u6765\u8bf4\uff0c\u5b83\u5de5\u4f5c\u5f97\u51fa\u5947\u5730\u597d\u3002..\u3002\n\u6211\u4eec\u4ece\u4e00\u5f00\u59cb\u5c31\u505a\u4e86\u4e00\u4ef6\u91cd\u8981\u7684\u4e8b\u60c5\uff0c\u90a3\u5c31\u662f\u4ee5realclient\u7ad9\u70b9\u4e3a\u4f8b\u3002\u8fd9\u7acb\u5373\u4f53\u73b0\u4e86\u6700\u5927\u7684\u6311\u6218-\u5feb\u901f\u51fa\u53e3\u4e0d\u7a33\u5b9a\u7684\u7f51\u7ad9\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5f53\u5b58\u6863\u4e00\u4e9b\u7ad9\u70b9\u65f6\uff0c\u5bfc\u51fa\u751a\u81f3\u9700\u8981\u4e00\u4e2a\u5c0f\u65f6\u4e5f\u662f\u5b8c\u5168\u53ef\u4ee5\u7684\u3002\u4f46\u5982\u679c\u6211\u4eec\u8003\u8651\u7684\u662f\u4e00\u4e2a\u5b9e\u65f6\u7f51\u7ad9\uff0c\u5b83\u4f1a\u968f\u7740\u540e\u53f0\u5185\u5bb9\u7684\u6539\u53d8\u800c\u5b9a\u671f\u66f4\u65b0--\u5fc5\u987b\u7b49\u5f85\u8fd9\u4e48\u957f\u7684\u65f6\u95f4\u662f\u6709\u95ee\u9898\u7684\u3002\n\u8fd9\u5c31\u662f\u6211\u4eec\u5728HTTrack\u548cwget\u4e4b\u95f4\u6765\u56de\u8df3\u8dc3\u7684\u5730\u65b9\u3002\u8ba9\u6211\u4eec\u6765\u770b\u770b\u6211\u4eec\u5f97\u5230\u7684\u7ed3\u679c\u3002\u6211\u5c06\u9690\u85cf\u771f\u5b9e\u7684URL\uff0c\u8fd9\u6837\u60a8\u5c31\u4e0d\u4f1a\u50cf\u6211\u4eec\u90a3\u6837\u6ee5\u7528\u6211\u4eec\u5ba2\u6237\u7684\u7f51\u7ad9\uff01\uff1a)\u3002\n37\u5206\u949f\u53ef\u4fdd\u5b58\u7ea6450 MB\u7684\u5185\u5bb9(HTML\u4ee5\u53ca\u6240\u6709\u8d44\u4ea7\u3001\u56fe\u50cf\u548c\u6587\u4ef6)\u3002\n\u90a3\u6b21\u5c1d\u8bd5\u662f\u5728\u6211\u672c\u5730\u7684\u7535\u8111\u4e0a\u8fdb\u884c\u7684\u3002\u6240\u4ee5\u6211\u4eec\u65cb\u8f6c\u4e86\u4e00\u4e2aGoogle Cloud\u5b9e\u4f8b\uff0c\u770b\u770b\u4ece\u4e00\u4e2a\u6709\u66f4\u5f3a\u5927\u7684\u4e92\u8054\u7f51\u8fde\u63a5\u7684\u670d\u52a1\u5668\u6267\u884c\u8fd9\u4e2a\u5b9e\u4f8b\u662f\u5426\u4f1a\u5feb\u5f97\u591a--\u4f46\u5b83\u4e0d\u662f\u3002\n\u56e0\u6b64\uff0c\u6211\u4eec\u51b3\u5b9a\u6392\u9664\u6240\u6709\u7528\u6237\u751f\u6210\u7684\u6587\u4ef6(\u56fe\u50cf\u3001PDF\u7b49)\u3002\u5176\u60f3\u6cd5\u662f\uff0c\u6587\u4ef6\u5c06\u88ab\u4e0a\u4f20\u5230\u67d0\u4e9b\u5b58\u50a8\u670d\u52a1\uff0c\u5982AWS\u6216Google Cloud\uff0c\u5e76\u4ece\u90a3\u91cc\u63d0\u4f9b\u670d\u52a1\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u5185\u5bb9\u7f16\u8f91\u5668\u5728Drupal\u4e2d\u4e0a\u4f20\u65b0\u6587\u4ef6\u65f6\uff0c\u5b83\u5c06\u201c\u8fdc\u7a0b\u201d\u4fdd\u5b58\uff0c\u800c\u4e0d\u662f\u5c06\u5176\u4fdd\u5b58\u5728\u670d\u52a1\u5668\u4e0a\u3002\n\u8fd9\u6837\u505a\u8282\u7701\u4e86\u76f8\u5f53\u591a\u7684\u65f6\u95f4\uff0c\u4f7f\u6211\u4eec\u7684120MB\u5185\u5b58\u51cf\u5c11\u5230\u4e8620\u5206\u949f\u3002\n\u7136\u540e\u6211\u4eec\u68c0\u67e5\u662f\u5426\u53ef\u4ee5\u589e\u52a0\u5e76\u53d1\u8fde\u63a5\u7684\u6570\u91cf\u3002HTTrack\u6709\u51e0\u4e2a\u9009\u9879\uff0c\u7279\u522b\u662f\u540d\u79f0\u53ef\u6015\u7684--\u7981\u7528-\u5b89\u5168\u9650\u5236\uff0c\u5b83\u5e94\u8be5\u5141\u8bb8\u6211\u4eec\u8f7b\u677e\u5730\u5bf9\u6211\u4eec\u81ea\u5df1\u7684\u7ad9\u70b9\u8fdb\u884cDDOS\uff0c\u6216\u8005\u901a\u8fc7\u8bbe\u7f6econne\u7684\u7279\u5b9a\u8ba1\u6570\u6765\u5b9e\u73b0", "note_en": "Static sites are the best. They are the most secure and fastest of sites. Theyare perfect for anonymous users, where you would want content editors tohave a secure and hidden backend where they can administer the content - buthave the content served elsewhere.\n Having search on top of that can be a bit more challenging. There are differentsolutions for having a local search like lunr.js (and aDrupal  module to integrate with it), butit\u2019s quite limited. That is, it will create a local index where you could havesome JS to look into it, but that is no match to full-blown search engines suchas Elasticsearch.\n In this blog post I will share a demo website we\u2019ve built as a proof of conceptfor a much larger site. I\u2019m not going to dwell on the advantages of staticsites, instead I\u2019m going to share the high-level concepts that guided us, alongwith some technical tips. While the specific details have nothing to do withDrupal - our client\u2019s site is in Drupal, so it was convenient to build itaround it. But you can really do it with any language.\n    With static sites, deploying and reverting deploys is easy. It\u2019s not much morethan  git push or  git revertif something went wrong. But what about search?As we \u2019ve mentioned, we want to keep using Elasticsearch for things likeaggregations (a.k.a. facets), spell checks, etc. But how can we support, forexample, a rollback in the deploy - making sure that search is always searchingonly through the content that exists in the deployed static site. Thankfully,Elasticsearch supports index cloning, so we  ...\n The  default index is the one that Drupal will connect to, and it will be aread and write. That is, you can think of it as a \u201cmaster\u201d index, from which asnapshot will be taken.\n When we want to create a new static site, we would also create a clone of thedefault index. That will be a read-only index.\n Our JS app that will be in charge of calling Elasticsearch should know aboutthe name of the read-only index. So if we rollback a deploy to previousversions, the JS code will connect to the right index.\n A word about the Elasticsearch instance and its exposure to the outside. In asimilar way to how we place Drupal in the backend, away from the public eye,we could do the same with Elasticsearch. For example, when we hostElasticsearch instance(s) on Google Cloud, we can use a  loadbalancerto provide a public-facing,SSLed, URL - which, in turn, will call the Elasticsearch with any kind firewallrules needed, such as preventing any admin-type requests from hitting theinstance, or prevent any request  ...\n  We actually started our research looking into Tome, a Drupal module that allowsexporting a Drupal site into a static site. While it did work nicely, and I\u2019msure there could be benefits to using it, I\u2019ve thought that there wasn\u2019t reallyany specific need in our case for Drupal itself to provide the export. We mayas-well use other open source tools, which have been around for quite a fewyears.\n Then started a longer than anticipated trial and comparisons between HTTrack and wget. While we did eventually go withwget it\u2019s worth sharing some of our experience. First we\u2019ve tried HTTrack.We have already used it to help us move some old sites to be static, and it didthe job well. The amazing Karen Stevenson also wrote a  greatpostabout it that goes into more details. My impression from HTTrack is that it works surprisingly well for a tool that has asite that looks as outdated as it looks.  ...\n One important thing we\u2019ve done from the get go was take as example a realclient site. This immediately manifested the biggest challenge - exporting astatic site quickly. Normally, when archiving some site, it\u2019s totally fine forthe export to take even an hour. But if we\u2019re thinking of a live site, thatregularly updates as content in the backend is changed - having to wait so longis problematic.\n This is where we were jumping back and forth between HTTrack and wget. Lets seesome of the results we got. I\u2019m going to hide the real URL, so you won\u2019t abuseour client\u2019s site as much as we did! :)\n   37 minutes for about 450 MB of saved content (HTML along with all the assets,images, and files).\n That attempt was on my local computer. So we spinned a Google Cloud instance,to see if executing this from a server with a more powerful internet connectionwould be much faster - but it wasn\u2019t.\n So we decided to exclude all user-generated files (images, PDFs, etc). The ideawould be that files would be uploaded to some storage service like AWS orGoogle Cloud and be served from there. That is, when a content editor willupload a new file in Drupal, instead of saving it on the server, it will besaved \u201cremotely.\u201d\n  Doing so shaved quite a lot, and got us down to 20 minutes with 120 MB.\n Then we checked if we could increase the number of concurrent connections.HTTrack has a few options, notably the scarily-named  --disable-security-limitsthat should allow us to lightly DDOS our own site, or by setting a specificcount of connections (e.g.  -c16). However, we didn\u2019t seem to see a change inthe number of connections.\n Then we tried to update an existing static site by executing  httrack --update. This one was already considerably faster, and got us down to 4.5minutes, and this time we also saw multiple active connections.\n  After that I started looking into wget, running  wget --recursive --page-requisites --adjust-extension --span-hosts --convert-links --restrict-file-names=windows --domains example.com --no-parent --reject jpg,jpeg,png,zip,pdf,svg https://example.com/ (see gistfor explanation on each option).\n  After spending many hours digging in different forums and StackOverflow, I\u2019vedecided to go with wget, but I do think HTTrack should be considered if yougo with a similar solution. I believe it\u2019s a \u201cyour mileage may vary\u201dsituation.\n One shortcoming I found with wget, was that unlike HTTrack I couldn\u2019t tell itunder what name to save the HTML file. Instead of  /content/foo/index.html Igot the file as  /content/foo.html. Do you know how I solved it? With a hackequally nice as it\u2019s ugly. On Drupal I\u2019ve changed the path aliases pattern tobe  /content/[node:title]/index.html. I hope maybe someone will point me to a way ofgetting wget to do it for us.\n   My personal belief is that technical posts should put in the hands of theirreaders the means to get their hands dirty, experiment, and collaborate. So hereyou go, and here\u2019s the recipe for the demo repo:\n It was scaffolded out of our  Drupal 8 &amp; 9Starter and as such you can easilydownload and try yourself as ddev is the only requirement. All commands areexecuted from inside the ddev container - so no special installation isrequired.\n Follow the installationsteps, and it should result with a Drupal site, and dummy content. Installationshould give you an admin link, but you can always grab a new one with  ddev . drush uli.\n Next, let\u2019s create a static site with  ddev robo snapshot:create. The  Robocommandis responsible for clearing Drupal\u2019s cache, wget-ing the site and massaging ita bit, cloning the Elasticsearch index, and is even nice enough to ask you ifyou\u2019d like to run a local HTTP server to see your new static site. Notice howthe search is still working, but if you look inside the network panel, you\u2019dsee it calls a specific index. That\u2019s our \u201csnapshot\u201d read-only index.\n  Go ahead and make some changes to your site. Add/ delete content, or evenswitch the theme to Bartik.  ddev robo snapshot:create once more. Note that youmight need to hard refresh the page in the browser to see the changes.\n   I\u2019ve written the JS application for the search in Elm. We fetchdata from the correct index URL, and then we showthem in a paginated list. Like any app we\u2019ve written in Elm, It Simply Works\u2122.\n As Elm is already bundledwith the ddev container, we have a simple  Robo command to watchfor changes and compile them to the right place inside Drupal.\n Two important things we do when create a static site, is find &amp; replace a  JSvariablewhich determines if Elm is operating in Drupal context, or static site context.With this knowledge we could have different functionality. For example, in theDrupal context, we could have shown an Edit link next to each result. At thissame time, we also change the URL of the index, to the cloned one, so our JS appalways calls the right URL.\n  I believe we have been successful with our attempts, and the requirements wehad were well answered. Going with a static site provides considerablesecurity, performance and stability gains. Having JS to communicate with asnapshot-specific Elasticsearch index wasn\u2019t too hard and it\u2019s working nicely.Naturally, in the demo repo the app is quite basic, but it lays the foundationfor fancier features.\n The biggest challenge of exporting the static site in a speedy manner boilsdown to excluding any user generated assets or pages. But still, some exporttime is always to be expected. Finally having Robo commands executed insideddev is a convenient way to automate and share with other devs on the team.", "posttime": "2020-05-03 03:12:30", "tags": "elasticsearch,sites,\u5185\u5bb9,site", "title": "\u4f7f\u7528Elasticsearch\u7684\u9759\u6001\u7ad9\u70b9", "title_en": "Static Sites with Elasticsearch", "transed": 1, "url": "https://www.gizra.com/content/drupal-static-elasticsearch/", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["sites", "\u5185\u5bb9", "site"]}, {"category": "", "categoryclass": "", "imagename": "394b52164dcab22052e41dca0334b63d.png", "infoid": 1000395, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u60a8\u6709\u6ca1\u6709\u60f3\u8fc7\u7f16\u5199\u81ea\u5df1\u7684\u7f16\u8bd1\u5668\uff1f\u2026\u3002\u4ec0\u4e48\u4e8b\uff1f\u2026\u3002\u4f60\u5f53\u7136\u6709\uff01\u6211\u4e00\u76f4\u60f3\u5c1d\u8bd5\u7f16\u5199\u7f16\u8bd1\u5668\uff0c\u968f\u7740WebAssembly\u6700\u8fd1\u7684\u53d1\u5e03\uff0c\u6211\u6709\u4e86\u4e00\u4e2a\u5b8c\u7f8e\u7684\u7406\u7531\u6765\u5c1d\u8bd5\u4e00\u4e0b\u3002\n\u6211\u6700\u521d\u7684\u8ba1\u5212\u662f\u53d1\u660e\u6211\u81ea\u5df1\u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u521b\u5efa\u4e00\u4e2a\u9762\u5411WebAssembly\u7684\u7f16\u8bd1\u5668\uff0c\u5e76\u5728FullStackNYC\u5206\u4eab\u6211\u7684\u7ecf\u9a8c\u3002\u7b2c\u4e00\u90e8\u5206\u8fdb\u884c\u4e86\u8ba1\u5212\uff0c\u6211\u82b1\u4e86\u5f88\u591a\u65f6\u95f4\u6765\u6784\u5efa\u3001\u4fee\u8865\u548c\u6539\u8fdb\u6211\u7684\u7f16\u8bd1\u5668\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u6211\u8ba1\u5212\u7684\u6700\u540e\u4e00\u90e8\u5206\u8fdb\u884c\u5f97\u4e0d\u592a\u987a\u5229\u3002\u957f\u65f6\u95f4\u7684\u5ef6\u8bef\u548c\u6700\u7ec8\u7684\u53d6\u6d88\u610f\u5473\u7740\u6211\u7ec8\u7a76\u4e0d\u80fd\u53bb\u7ebd\u7ea6\u4e86\u3002\ud83d\ude14\ud83d\ude22\ud83d\ude2d\u3002\n\u56e0\u6b64\uff0c\u4e0e\u5176\u6d6a\u8d39\u6240\u6709\u7684\u5de5\u4f5c-\u6211\u60f3\u6211\u5e94\u8be5\u628a\u6211\u7684\u6f14\u8bb2\u5199\u6210\u535a\u5ba2\u5e16\u5b50-\u6240\u4ee5\u8fd9\u7bc7\u6587\u7ae0\u7684\u9605\u8bfb\u65f6\u95f4\u5c31\u662f\u201819\u5206\u949f\u2019\u3002\u6240\u4ee5\u8bf7\u5750\uff0c\u8bf7\u81ea\u4fbf\uff0c\u6211\u4eec\u8981\u5f00\u59cb\u2026\u4e86\u3002\n\u5982\u679c\u4f60\u4ee5\u524d\u6ca1\u6709\u542c\u8bf4\u8fc7WebAssembly\uff0c\u5e76\u4e14\u60f3\u8981\u4e00\u4e2a\u771f\u6b63\u8be6\u7ec6\u7684\u4ecb\u7ecd\uff0c\u6211\u4f1a\u5411\u4f60\u5f7b\u5e95\u63a8\u8350\u6797\u514b\u62c9\u514b\u7684\u5361\u901a\u6307\u5357\u3002\n\u5728\u8fd9\u7bc7\u535a\u5ba2\u6587\u7ae0\u4e2d\uff0c\u60a8\u5c06\u4e86\u89e3WebAssembly\u7684\u201c\u662f\u4ec0\u4e48\u201d\uff0c\u4f46\u6211\u786e\u5b9e\u60f3\u7b80\u8981\u4ecb\u7ecd\u4e00\u4e0b\u201c\u4e3a\u4ec0\u4e48\u201d\u3002\n\u4e0a\u56fe\u663e\u793a\u4e86\u5728\u6d4f\u89c8\u5668\u4e2d\u6267\u884c\u67d0\u4e9bJavaScript\u4ee3\u7801\u7684\u7b80\u5316\u65f6\u95f4\u7ebf\u3002\u4ece\u5de6\u5230\u53f3\uff0c\u4ee3\u7801(\u901a\u5e38\u662f\u4ee5\u6700\u5c0f\u7684\u4e71\u4e03\u516b\u7cdf\u7684\u5f62\u5f0f\u4ea4\u4ed8\u7684\uff01)\u3002\u88ab\u89e3\u6790\u6210AST\uff0c\u6700\u521d\u5728\u89e3\u91ca\u5668\u4e2d\u6267\u884c\uff0c\u7136\u540e\u9010\u6b65\u4f18\u5316/\u91cd\u65b0\u4f18\u5316\uff0c\u76f4\u5230\u5b83\u6700\u7ec8\u8fd0\u884c\u5f97\u975e\u5e38\u5feb\u3002\u73b0\u5728JavaScript\u901f\u5ea6\u5f88\u5feb--\u53ea\u9700\u8981\u4e00\u6bb5\u65f6\u95f4\u5c31\u80fd\u8ddf\u4e0a\u901f\u5ea6\u3002\n\u5e95\u90e8\u7684\u5173\u7cfb\u56fe\u76f8\u5f53\u4e8eWebAssembly\u3002\u7528\u591a\u79cd\u8bed\u8a00(RUST\u3001C\u3001C#\u7b49\u2026)\u7f16\u5199\u7684\u4ee3\u7801\u3002\u7f16\u8bd1\u4e3a\u4ee5\u4e8c\u8fdb\u5236\u683c\u5f0f\u4ea4\u4ed8\u7684WebAssembly\u3002\u8fd9\u975e\u5e38\u5bb9\u6613\u89e3\u7801\u3001\u7f16\u8bd1\u548c\u6267\u884c-\u63d0\u4f9b\u5feb\u901f\u548c\u53ef\u9884\u6d4b\u7684\u6027\u80fd\u3002\nWebAssembly\u5728\u8fc7\u53bb\u7684\u4e00\u5e74\u91cc\u5f15\u8d77\u4e86\u4e0d\u5c0f\u7684\u8f70\u52a8\u3002\u5982\u6b64\u4e4b\u591a\uff0c\u4ee5\u81f3\u4e8e\u5728Stack Overflow\u7684\u5f00\u53d1\u8005\u6d1e\u5bdf\u529b\u8c03\u67e5\u4e2d\uff0c\u5b83\u88ab\u8bc4\u4e3a\u7b2c\u4e94\u79cd\u201c\u6700\u53d7\u6b22\u8fce\u201d\u7684\u8bed\u8a00\u3002\n\u8003\u8651\u5230\u5bf9\u4e8e\u5927\u591a\u6570\u4eba\u6765\u8bf4\uff0cWebAssembly\u662f\u4e00\u4e2a\u7f16\u8bd1\u76ee\u6807\uff0c\u800c\u4e0d\u662f\u4ed6\u4eec\u5c06\u76f4\u63a5\u4f7f\u7528\u7684\u8bed\u8a00\uff0c\u8fd9\u662f\u4e00\u4e2a\u6709\u8da3\u7684\u7ed3\u679c\u3002\n\u8fd9\u662f\u6211\u6700\u521d\u63d0\u51faFullStackNYC\u6f14\u8bb2\u7684\u90e8\u5206\u52a8\u673a\u3002WebAssembly\u7684\u6280\u672f\u65b9\u9762\u771f\u7684\u5f88\u5438\u5f15\u4eba(\u8ba9\u6211\u60f3\u8d77\u51e0\u5341\u5e74\u524d\u76848\u4f4d\u8ba1\u7b97\u673a)\uff0c\u7136\u800c\u5927\u591a\u6570\u4eba\u6c38\u8fdc\u6ca1\u6709\u673a\u4f1a\u6d89\u8db3WebAssembly\u672c\u8eab-\u5b83\u53ea\u662f\u4e00\u4e2a\u4ed6\u4eec\u7f16\u8bd1\u5230\u7684\u9ed1\u5323\u5b50\u3002\n\u7f16\u5199\u7f16\u8bd1\u5668\u771f\u7684\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u673a\u4f1a\uff0c\u53ef\u4ee5\u6df1\u5165\u7814\u7a76WebAssembly\u7684\u7ec6\u8282\uff0c\u627e\u51fa\u5b83\u662f\u4ec0\u4e48\u4ee5\u53ca\u5b83\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002\u800c\u4e14\u8fd9\u4e5f\u5f88\u6709\u8da3\uff01\n\u6700\u540e\u4e00\u70b9\uff0c\u6211\u7684\u76ee\u6807\u4ece\u6765\u4e0d\u662f\u521b\u5efa\u4e00\u79cd\u529f\u80fd\u9f50\u5168\u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u4e5f\u4e0d\u662f\u4e00\u79cd\u771f\u6b63\u597d\u7684\u7f16\u7a0b\u8bed\u8a00\u3002\u6211\u7684\u76ee\u6807\u662f\u521b\u5efa\u4e00\u79cd\u201c\u8db3\u591f\u7684\u201d\u8bed\u8a00\uff0c\u4f7f\u6211\u80fd\u591f\u7f16\u5199\u4e00\u4e2a\u7a0b\u5e8f\u6765\u5448\u73b0\u66fc\u5fb7\u5e03\u7f57\u7279\u96c6(Mandelbrot Set)\u3002\u8be5\u8bed\u8a00\u662f\u4f7f\u7528\u6211\u7684\u7f16\u8bd1\u5668\u7f16\u8bd1\u6210WebAssembly\u7684\uff0c\u8be5\u7f16\u8bd1\u5668\u662f\u7528\u6253\u5b57\u811a\u672c\u7f16\u5199\u7684\uff0c\u5e76\u5728\u6d4f\u89c8\u5668\u4e2d\u8fd0\u884c\u3002\n\u6211\u6700\u540e\u7ed9\u8bed\u8a00\u9e3f\u6c9f\u6253\u4e86\u4e2a\u7535\u8bdd\uff0c\u5982\u679c\u4f60\u613f\u610f\uff0c\u4f60\u53ef\u4ee5\u5728\u7f51\u4e0a\u73a9\u3002\n\u5728\u5904\u7406\u7f16\u8bd1\u5668\u4e4b\u524d\uff0c\u6211\u4eec\u5c06\u4ece\u66f4\u7b80\u5355\u7684\u4e1c\u897f\u5f00\u59cb\uff0c\u521b\u5efa\u4e00\u4e2a\u6700\u5c0f\u7684WebAssembly\u6a21\u5757\u3002\n\u4e0b\u9762\u662f\u4e00\u4e2a\u53d1\u5c04\u5668(\u8be5\u672f\u8bed\u7528\u4e8e\u63cf\u8ff0\u4e3a\u76ee\u6807\u7cfb\u7edf\u8f93\u51fa\u6307\u4ee4\u7684\u7f16\u8bd1\u5668\u90e8\u5206)\uff0c\u5b83\u521b\u5efa\u6700\u5c0f\u7684\u6709\u6548WebAssembly\u6a21\u5757\uff1a\n\u5e38\u91cfmagicModuleHeader=[0x00\uff0c0x61\uff0c0x73\uff0c0x6d]\uff1b\u5e38\u91cf\u6a21\u5757\u7248\u672c=[0x01\uff0c0x00\uff0c0x00\uff0c0x00]\uff1b\u5bfc\u51fa\u5e38\u91cf\u53d1\u5c04\u5668\uff1a\u53d1\u5c04\u5668=()=&gt\uff1bUint8Array\u3002\u4ece([.\u3002MagicModuleHeader\uff0c.\u3002ModeVersion])\uff1b\n\u5b83\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff0c\u201cMagic\u201d\u5934(\u5373ASCII\u5b57\u7b26\u4e32\\0asm)\u548c\u7248\u672c\u53f7\u3002\u8fd9\u516b\u4e2a\u5b57\u8282\u5f62\u6210\u6709\u6548\u7684WebAssembly(\u6216wasm)\u6a21\u5757\u3002\u66f4\u5178\u578b\u7684\u60c5\u51b5\u662f\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5c06\u4f5c\u4e3a.wasm\u6587\u4ef6\u4f20\u9001\u5230\u6d4f\u89c8\u5668\u3002\n\u5982\u679c\u8fd0\u884c\u4e0a\u9762\u7684\u547d\u4ee4\uff0c\u60a8\u4f1a\u53d1\u73b0\u8be5\u5b9e\u4f8b\u5b9e\u9645\u4e0a\u5e76\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\uff0c\u56e0\u4e3a\u6211\u4eec\u7684wasm\u6a21\u5757\u4e0d\u5305\u542b\u4efb\u4f55\u6307\u4ee4\uff01\n\u5982\u679c\u60a8\u6709\u5174\u8da3\u4eb2\u81ea\u5c1d\u8bd5\u8fd9\u6bb5\u4ee3\u7801\uff0c\u53ef\u4ee5\u5728GitHub\u4e0a\u627e\u5230--\u6bcf\u4e00\u6b65\u90fd\u6709\u4e00\u4e2a\u63d0\u4ea4\u3002\n\u8ba9\u6211\u4eec\u901a\u8fc7\u5b9e\u73b0\u4e00\u4e2a\u5c06\u4e24\u4e2a\u6d6e\u70b9\u6570\u76f8\u52a0\u7684\u51fd\u6570\u6765\u4f7fwasm\u6a21\u5757\u505a\u4e00\u4e9b\u66f4\u6709\u7528\u7684\u4e8b\u60c5\u3002\nWebAssembly\u662f\u4e00\u79cd\u4e8c\u8fdb\u5236\u683c\u5f0f\uff0c\u53ef\u8bfb\u6027\u4e0d\u662f\u5f88\u597d(\u81f3\u5c11\u5bf9\u4eba\u7c7b\u800c\u8a00)\uff0c\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u60a8\u901a\u5e38\u4f1a\u770b\u5230\u5b83\u662f\u4ee5WebAssembly\u6587\u672c\u683c\u5f0f(WAT)\u7f16\u5199\u7684\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u4ee5WAT\u683c\u5f0f\u5448\u73b0\u7684\u6a21\u5757\uff0c\u5b83\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3a$add\u7684\u5bfc\u51fa\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u63a5\u53d7\u4e24\u4e2a\u6d6e\u70b9\u53c2\u6570\uff0c\u7136\u540e\u5c06\u5b83\u4eec\u76f8\u52a0\u5e76\u8fd4\u56de\uff1a\n(MODULE(func$add(Param F32)(Param F32)(Result F32)GET_LOCAL 0 GET_LOCAL 1 f32.add)(export&#34\uff1badd&#34\uff1b(Func 0)\u3002\n\u5982\u679c\u60a8\u53ea\u60f3\u4f53\u9a8c\u4e00\u4e0bWat\uff0c\u53ef\u4ee5\u4f7f\u7528WebAssembly\u4e8c\u8fdb\u5236\u5de5\u5177\u5305\u4e2d\u7684wat2wasm\u5de5\u5177\u5c06WAT\u6587\u4ef6\u7f16\u8bd1\u6210wasm\u6a21\u5757\u3002\nWebAssembly\u662f\u4e00\u79cd\u4f4e\u7ea7\u8bed\u8a00\uff0c\u53ea\u6709\u4e00\u5c0f\u90e8\u5206(\u5927\u7ea660\u6761)\u6307\u4ee4\u96c6\uff0c\u5176\u4e2d\u8bb8\u591a\u6307\u4ee4\u4e0eCPU\u6307\u4ee4\u7684\u6620\u5c04\u975e\u5e38\u7d27\u5bc6\u3002\u8fd9\u4f7f\u5f97\u5c06wasm\u6a21\u5757\u7f16\u8bd1\u6210\u7279\u5b9a\u4e8eCPU\u7684\u673a\u5668\u7801\u53d8\u5f97\u5f88\u5bb9\u6613\u3002\n\u5b83\u6ca1\u6709\u5185\u7f6e\u7684", "note_en": "Have you ever wanted to write your own compiler? \u2026 yes? \u2026 of course you have! I\u2019ve always wanted to have a go at writing a compiler, and with the recent release of WebAssembly, I had the perfect excuse to have a go.\n My original plan was to  invent my own programming language, create a compiler that targets WebAssembly, and share my experiences at  FullStackNYC. The first part went to plan, I spent many-an-evening building, tinkering and refining my compiler. Unfortunately the last part of my plan didn\u2019t go quite so well. Long delays, and an  eventual cancellation, meant that I wasn\u2019t going to make it to New York after all. \ud83d\ude14\ud83d\ude22\ud83d\ude2d\n So, rather than waste all that work - I thought I\u2019d write up my talk as a blog post instead - hence the \u201819 min\u2019 reading time for this article. So sit back, make yourself comfortable, and we\u2019ll begin \u2026\n  If you haven\u2019t heard of WebAssembly before, and want a really detailed introduction, I\u2019d thoroughly recommend  Lin Clark\u2019s Cartoon Guide.\n You\u2019ll learn the \u2018what\u2019 of WebAssembly throughout this blog post, but I do want to briefly touch on the \u2018why\u2019.\n   The top diagram shows a simplified timeline for the execution of some JavaScript code within the browser. From left-to-right, the code (typically delivered as a minified mess!) is parsed into an AST, initially executed in an interpreter, then progressively optimised / re-optimised until it eventually runs really quite quickly. These days JavaScript is fast - it just takes a while to get up to speed.\n The bottom diagram is the WebAssembly equivalent. Code written in a wide variety of languages (Rust, C, C#, etc \u2026) is compiled to WebAssembly that is delivered in a binary format. This is very easily decoded, compiled and executed - giving fast and predictable performance.\n  WebAssembly has been causing quite a stir over the last year. So much so, that it was voted the fifth \u2018most loved\u2019 language in  Stack Overflow\u2019s developer insights survey.\n  An interesting result, considering that for most people WebAssembly is a compilation target, rather than a language they will use directly.\n This was part of my motivation for proposing the FullStackNYC talk in the first place. The technical aspects of WebAssembly are really fascinating (and remind me of 8-bit computers from a few decades back), yet most people will never get the chance to dabble with WebAssembly itself - it will just be a black box that they compile to.\n Writing a compiler is a really good opportunity to delve into the details of WebAssembly to find it what it is and how it works. And it\u2019s fun too!\n One final point, it was never my aim to create a fully-featured programming language, or one that is actually any good. My goal was to create \u2018enough\u2019 of a language to allow me to write a program that renders a mandelbrot set. This language is compiled to WebAssembly using my compiler, which is written in TypeScript and runs in the browser.\n   I ended up calling the language  chasm and you can  play with it online if you like.\n   Before tackling the compiler, we\u2019ll start with something simpler, creating a minimal WebAssembly module.\n Here is an emitter (the term used for the part of a compiler that outputs instructions for the target system), that creates the smallest valid WebAssembly module:\n const  magicModuleHeader  =  [ 0x00 ,  0x61 ,  0x73 ,  0x6d ]; const  moduleVersion  =  [ 0x01 ,  0x00 ,  0x00 ,  0x00 ]; export  const  emitter :  Emitter  =  ()  =&gt;  Uint8Array . from ([  ... magicModuleHeader ,  ... moduleVersion  ]);\n It is comprised of two parts, the \u2018magic\u2019 header, which is the ASCII string  \\0asm, and a version number. These eight bytes form valid WebAssembly (or wasm) module. More typically these would be delivered to the browser as a  .wasm file.\n   If you run the above you\u2019ll find that  instance doesn\u2019t actually do anything because our wasm module doesn\u2019t contain any instructions!\n If you\u2019re interested in trying out this code for yourself, it is all on GitHub -  with a commit for each step.\n  Let\u2019s make the wasm module do something more useful, by implementing a function that adds a couple of floating point numbers together.\n WebAssembly is a binary format, which isn\u2019t terribly readable (to humans at least), which is why you\u2019ll more typically see it written in WebAssembly Text Format (WAT). Here\u2019s a module, presented in WAT format, that defines an exported function named  $add that takes two floating point parameters, adds them together and returns them:\n (module (func $add (param f32) (param f32) (result f32) get_local 0 get_local 1 f32.add) (export &#34;add&#34; (func 0)))\n If you just want to experiment with WAT you can use the  wat2wasm tool from the  WebAssembly Binary Toolkit to compile WAT files into wasm modules.\n  WebAssembly is a low-level language, with a small (approx 60) instruction set, where many of the instructions map quite closely to CPU instructions. This makes it easy to compile wasm modules to CPU-specific machine code.\n  It has no built in I/O. There are no instructions for writing to the terminal, screen or network. In order to wasm modules to interact with the outside world they need to do so via their host environment, which in the case of the browser is JavaScript.\n  WebAssembly is a stack machine, in the above example  get_local 0 gets the local variable (in this case the function param) at the zeroth index and pushes it onto the stack, as does the subsequent instruction. The  f3.add instruction pops two values form the stack, adds them together than pushes the value back on the stack.\n  WebAssembly has just four numeric types, two integer, two floats. More on this later \u2026\n Let\u2019s update the emitter to output this \u2018hard coded\u2019 WebAssembly module.\n WebAssembly modules are composed of a pre-defined set of optional sections, each prefixed with a numeric identifier. These include a type section, which encode type signatures, and function section, which indicates the type of each function. I\u2019ll not cover how these are constructed here - they are quite dull. If you\u2019re interested,  look at the next commit in the project.\n The interesting part is the code section. Here is how the above  add function is created in binary:\n const  code  =  [  Opcodes . get_local  /** 0x20 */ ,  ... unsignedLEB128 ( 0 ),  Opcodes . get_local  /** 0x20 */ ,  ... unsignedLEB128 ( 1 ),  Opcodes . f32_add  /** 0x92 */ ]; const  functionBody  =  encodeVector ([  ... encodeVector ([])  /** locals */ ,  ... code ,  Opcodes . end  /** 0x0b */ ]); const  codeSection  =  createSection ( Section . code  /** 0x0a */ ,  encodeVector ([ functionBody ]));\n I\u2019ve defined an  Opcodes enum (I\u2019m using TypeScript), which contains all of the wasm instructions. The  unsignedLEB128 function is a standard  variable length encoding which is used for encoding instruction parameters.\n The instructions for a function are combined with the function\u2019s local variables (of which there are none in this case), and an  end opcode that signals the end of a function. Finally all the functions are encoded into a section. The  encodeVector function simply prefixes a collection of byte arrays with the total length.\n And there you have it, the complete module, which is about 30 bytes in total.\n   Interestingly if you inspect the exported  add function with the Chrome Dev Tools it identifier it as a \u2018native function\u2019.\n   Now that you\u2019ve seen how to dynamically create wasm modules, it\u2019s time to turn our attention to the task of creating a compiler. We\u2019ll start with a bit of terminology.\n Here\u2019s some  chasm code annotated to show the key components of a language:\n  Rather than give a \u2018textbook definition\u2019 of each, you\u2019ll become familiar with them as the compiler evolves.\n The compiler itself will be formed of three parts, the  tokenizer which breaks up the input program (which is a string), into discrete tokens, the  parser that takes these tokens and converts them into an Abstract Syntax Tree (AST), and finally the  emitter which converts the AST into wasm binary module.\n   Rather than dive into a complete implementation, we\u2019ll tackle a small subset of the problem. The goal is to create a compiler for a language that just supports print statements which print simple numeric literals \u2026\n   The tokenizer works by advancing through the input string, one character at a time, matching patterns that represent specific token types. The following code creates three matches ( number,  keyword, and  whitespace), using simple regular expressions:\n const  keywords  =  [ &#34; print &#34; ];  // returns a token if the given regex matches at the current index const  regexMatcher  =  ( regex :  string ,  type :  TokenType ):  Matcher  =&gt;  ( input :  string ,  index :  number )  =&gt;  {  const  match  =  input . substring ( index ). match ( regex );  return  (  match  &amp;&amp;  {  type ,  value :  match [ 0 ]  }  );  }; const  matchers  =  [  regexMatcher ( &#34; ^[.0-9]+ &#34; ,  &#34; number &#34; ),  regexMatcher ( `^( ${ keywords . join ( &#34; | &#34; )} )` ,  &#34; keyword &#34; ),  ...\n  The  Matcher interface defines a function that given an input string and an index returns a token if a match occurs.\n The main body of the parser iterates over the characters of the string, finding the first match, adding the provided token to the output array:\n export  const  tokenize :  Tokenizer  =  input  =&gt;  {  const  tokens :  Token []  =  [];  let  index  =  0 ;  while  ( index  &lt;  input . length )  {  const  matches  =  matchers . map ( m  =&gt;  m ( input ,  index )). filter ( f  =&gt;  f )  const  match  =  matches [ 0 ];  if  ( match . type  !==  &#34; whitespace &#34; )  {  tokens . push ( match );  }  index  +=  match . value . length ;  }  return  tokens ; };\n  [   {   &#34;type&#34; :   &#34;keyword&#34; ,   &#34;value&#34; :   &#34;print&#34; ,   &#34;index&#34; :   1   },   {   &#34;type&#34; :   &#34;number&#34; ,   &#34;value&#34; :   &#34;23.1&#34; ,   &#34;index&#34; :   7   }  ]\n As you can see from the above input, the tokeniser removes whitespace as it has no meaning (for this specific language), it also ensures that everything in the input string is a valid token. However, it doesn\u2019t make any guarantees about the input being well-formed, for example the tokeniser will happily handle  &#34;print print&#34;, which is clearly incorrect.\n   The goal of the parser is the creation of an Abstract Syntax Tree (AST), a tree structure that encodes the relationship between these tokens, resulting in a form that could potentially be sent to an interpreter for direct execution.\n  export  const  parse :  Parser  =  tokens  =&gt;  {  const  iterator  =  tokens [ Symbol . iterator ]();  let  currentToken  =  iterator . next (). value ;  const  eatToken  =  ()  =&gt;  ( currentToken  =  iterator . next (). value );  [...]  const  nodes :  StatementNode []  =  [];  while  ( index  &lt;  tokens . length )  {  nodes . push ( parseStatement ());  }  return  nodes ; };\n (I\u2019ve no idea where the concept of eating tokens comes from, it appears to be standard parser terminology, they are clearly hungry beasts!)\n The goal of the above parser is to turn the token array into an array of statements, which are the core building blocks of this language. It expects the given tokens to conform to this pattern, and will throw an error (not shown above) if it does not.\n The  parseStatement function expects each statement to start with a keyword - switching on its value:\n const  parseStatement  =  ()  =&gt;  {  if  ( currentToken . type  ===  &#34; keyword &#34; )  {  switch  ( currentToken . value )  {  case  &#34; print &#34; :  eatToken ();  return  {  type :  &#34; printStatement &#34; ,  expression :  parseExpression ()  };  }  } };\n Currently the only supported keyword is  print, in this case it returns an AST node of type  printStatement parsing the associated expression.\n  const  parseExpression  =  ()  =&gt;  {  let  node :  ExpressionNode ;  switch  ( currentToken . type )  {  case  &#34; number &#34; :  node  =  {  type :  &#34; numberLiteral &#34; ,  value :  Number ( currentToken . value )  };  eatToken ();  return  node ;  } };\n In its present form the language only accepts expressions which are composed of a single number - i.e. a numeric literal. Therefore the above expression parser expects the next token to be a number, and when this matches, it returns a node of type  numberLiteral.\n Continuing the simple example of the program  &#34;print 23.1&#34;, the parser outputs the following AST:\n  As you can see the AST for this language is an array of statement nodes. Parsing guarantees that the input program is syntactically correct, i.e. it is properly constructed, but it doesn\u2019t of course guarantee that it will execute successfully, runtime errors might still be present (although for this simple language they are not possible!).\n   Currently the emitter outputs a hard-coded add function. It now needs to take this AST and emit the appropriate instructions, as follows:\n const  codeFromAst  =  ast  =&gt;  {  const  code  =  [];  const  emitExpression  =  node  =&gt;  {  switch  ( node . type )  {  case  &#34; numberLiteral &#34; :  code . push ( Opcodes . f32_const );  code . push (... ieee754 ( node . value ));  break ;  }  };  ast . forEach ( statement  =&gt;  {  switch  ( statement . type )  {  case  &#34; printStatement &#34; :  emitExpression ( statement . expression );  code . push ( Opcodes . call );  code . push (... unsignedLEB128 ( 0 ));  break ;  }  });  return  code ; };\n The emitter iterates over the statements that form the \u2018root\u2019 of the AST, matching our only statement type - print. Notice that the first thing it does is emit the instructions for the statement expressions, recall that WebAssembly is a stack machine, hence the expression instructions must be processed first leaving the result on the stack.\n The print function is implemented via a  call operation, which invokes the function at index zero.\n Previously we\u2019ve seen how wasm modules can export functions (as per the add example above), they can also import functions, which are supplied when you instantiate the module. Here we provide an  env.print function that logs to the console:\n   You can see the complete code for the  compiler at this point on GitHub - you can also have a play with this example via the  online chasm compiler playground.\n   So far we\u2019ve put quite a lot of structure in place, but not really felt the benefit. A separate tokenizer, parser and emitter is overkill for a language that only prints simple numerics. However, as the language complexity grows, this structure really starts to pay dividends.\n  Next up, we\u2019ll look at implementing binary expressions, allowing the language to perform simple mathematics, for example  print ((42 + 10) / 2).\n For the tokeniser the changes are quite trivial, involving adding a couple of additional regex matchers for parentheses and operators. I\u2019ll not reproduce them here - instead, just show the resultant output:\n [   {   &#34;type&#34; :   &#34;keyword&#34; ,   &#34;value&#34; :   &#34;print&#34;   },   {   &#34;type&#34; :   &#34;parens&#34; ,   &#34;value&#34; :   &#34;(&#34;   },   {   &#34;type&#34; :   &#34;parens&#34; ,   &#34;value&#34; :   &#34;(&#34;   },   {   &#34;type&#34; :   &#34;number&#34; ,   &#34;value&#34; :   &#34;42&#34;   },   {   &#34;type&#34; :   &#34;operator&#34; ,   &#34;value&#34; :   &#34;+&#34;   },   {   &#34;type&#34; :   &#34;number&#34; ,   &#34;value&#34; :   &#34;10&#34;   },   {   &#34;type&#34;\n Next up, we\u2019ll look at the changes to the parser - where the expression parser can encounter either  number of  parens tokens:\n const  parseExpression  =  ()  =&gt;  {  let  node :  ExpressionNode ;  switch  ( currentToken . type )  {  case  &#34; number &#34; :  [...]  case  &#34; parens &#34; :  eatToken ();  const  left  =  parseExpression ();  const  operator  =  currentToken . value ;  eatToken ();  const  right  =  parseExpression ();  eatToken ();  return  {  type :  &#34; binaryExpression &#34; ,  left ,  right ,  operator  };  } };\n Notice that parsing of  parens expressions is recursive, with the nodes for the left and right invoking the  parseExpression function once again.\n  [{   type:   &#34;printStatement&#34; ,   expression:   {   type:   &#34;binaryExpression&#34; ,   left:   {   type:   &#34;binaryExpression&#34; ,   left:   {   type:   &#34;numberLiteral&#34; ,   value:   42   },   right:   {   type:   &#34;numberLiteral&#34; ,   value:   10   },   operator:   &#34;+&#34;   },   right:   {   type:   &#34;numberLiteral&#34; ,   value:   2   },   operator:   &#34;/&#34;   }  }] ;\n  Finally, the emitter needs to be updated in order to handle the  binaryExpression node type, as follows:\n const  emitExpression  =  ( node )  =&gt;  traverse ( node ,  ( node )  =&gt;  {  switch  ( node . type )  {  case  &#34; numberLiteral &#34; :  code . push ( Opcodes . f32_const );  code . push (... ieee754 ( node . value ));  break ;  case  &#34; binaryExpression &#34; :  code . push ( binaryOpcode [ node . operator ]);  break ;  } });\n The  traverse function in the above code traverses tree structures invoking the given visitor for each node. While linear structures only have one logical way to traverse them (i.e. in order), trees can be  traversed in a number of different ways. The traversal method used by the emitter is a depth-first post-order traversal, in other words as it encounters each node it visits left, right, then root - this order ensures that  ...\n And that\u2019s it, all the changes that are required to support expressions. Give it a  go online.\n     Variables are declared using the  var keyword, and can be used in expressions as identifiers.\n We\u2019ll not look at the changes to the tokeniser, it\u2019s just yet more regex! The main loop of the parser, which reads successive statements from the token array, determines the statement type based on the keyword it encounters:\n const  parseVariableDeclarationStatement  =  ()  =&gt;  {  eatToken ();  // var  const  name  =  currentToken . value ;  eatToken ();  eatToken ();  // =  return  {  type :  &#34; variableDeclaration &#34; ,  name ,  initializer :  parseExpression ()  }; }; const  parseStatement :  ParserStep &lt; StatementNode &gt;  =  ()  =&gt;  {  if  ( currentToken . type  ===  &#34; keyword &#34; )  {  switch  ( currentToken . value )  {  case  &#34; print &#34; :  return  parsePrintStatement ();  case  ...\n Variable declaration parsing is quite straight-forwards - notice that the  parseVariableDeclarationStatement function also makes use of the expression parser, which ensures that variables can be declared and assigned an initial value from an expression, e.g.  var f = (1 + 4).\n Next up, the emitter. WebAssembly functions can have local variables, these are declared at the beginning of the function definition, and are accessed via the  get_local and  set_local functions that also retrieve function parameters.\n The variables in our AST are referenced via their identifier name, whereas wasm identifies locals by their index. The emitter needs to maintain this information in a symbol table, which is a simple map from the symbol name to index:\n const  symbols  =  new  Map &lt; string ,  number &gt; (); const  localIndexForSymbol  =  ( name :  string )  =&gt;  {  if  ( ! symbols . has ( name ))  {  symbols . set ( name ,  symbols . size );  }  return  symbols . get ( name ); };\n Within the node traversal, when a variable declaration is encountered, the expression is emitted, them  set_local used to assign the value to the respective local variable.\n  Within expressions, when identifiers are found, the  get_local operation is used to retrieve the value:\n  Also, the function encoding we saw right back at the beginning is updated to add the locals for the function that the emitter builds. The  chasm language has a single variable type, everything is a float.\n   One of the final language constructs we need in order to achieve the goal of rendering a mandelbrot set is some kind of loop. For  chasm I opted for a while loop, as show in this simple program that prints the numbers 0 to 9:\n  WebAssembly has various control flow instructions (branch, if, else, loop, block). The following WAT show how a while loop can be constructed:\n  Branching within WebAssembly is based on stack depth. The outer  block and  loop instructions push entries onto the control-flow stack. The  br_if 1 instruction performs a conditional branch to a stack depth of one, and  br 0 an unconditional branch to a depth of zero, repeating the  loop.\n  case  &#34; whileStatement &#34; :  // outer block  code . push ( Opcodes . block );  code . push ( Blocktype . void );  // inner loop  code . push ( Opcodes . loop );  code . push ( Blocktype . void );  // compute the while expression  emitExpression ( statement . expression );  code . push ( Opcodes . i32_eqz );  // br_if $label0  code . push ( Opcodes . br_if );  code . push (... signedLEB128 ( 1 ));  // the nested logic  emitStatements ( statement . statements );  // br $label1  ...\n   We\u2019re nearly there - up to the very last step now! Currently the only way we\u2019ve been able to see output from our  chasm programs is via the  print statement, which is wired to the console via a function imported by the WebAssembly module. For the mandelbrot set we somehow need to render graphics to the screen.\n To achieve this we\u2019ll make use of another very important component of WebAssembly modules, linear memory:\n  As I mentioned previously, WebAssembly only has 4 numeric data types. You might be wondering how languages with richer type systems (string, structs, arrays) can compile to WebAssembly?\n WebAssembly modules can optionally define (or import) a block of linear memory, this is a contiguous block of memory that is shared by the wasm module and its host - in other words both can read and write to this memory. Therefore, if you want to pass a string to your WebAssembly module, you do this by  writing it to linear memory.\n For  chasm we just want some sort of display, so will use linear memory as a form of  Video RAM.\n The  chasm languages supports a simple set-pixel command which takes three expressions, the x location, y location and colour. For example, the following program fill the screen with a horizontal gradient:\n var y = 0while (y &lt; 100) var x = 0 while (x &lt; 100) setpixel x y (x * 2) x = (x + 1) endwhile y = (y + 1)endwhile\n  The  setpixel command is implemented using the wasm  store instruction that writes to linear memory. On the JavaScript \u2018hosting\u2019 side, this same linear memory is read and copied to a HTML canvas. I\u2019ll not reproduce the changes to the code here, you can  see them on GitHub\n And with that - the  chasm language is complete, and able to render the mandelbrot set:\n    I hope you enjoyed this journey and have either learnt a bit more about WebAssembly or how compilers work? For me, this project was a lot of fun - I\u2019ve never written a compiler before, but have always wanted to.\n As you can probably imagine, I\u2019ve not stopped there, the temptation was too great to keep going - I\u2019ve already implemented if / else, and functions / procedures are in the pipeline. I\u2019d also really like to explore some of the more involved topics like memory management, for example introduce string, arrays and a memory allocator for storage within linear memory.\n  I am Technology Director at Scott Logic and am a prolific technical author, blogger and speaker on a range of technologies.\n My blog includes posts on a wide range of topics, including WebAssembly, HTML5 / JavaScript and data visualisation with D3 and  d3fc. You&#39;ll also find a whole host of posts about previous technology interests including iOS, Swift, WPF and Silverlight.\n I&#39;m board member of  FINOS, which is encouraging open source collaboration in the financial sector. I&#39;m also  very active on GitHub, contributing to a number of different projects.", "posttime": "2020-05-03 03:12:26", "tags": "\u7f16\u8bd1,webassembly", "title": "\u6784\u5efa\u60a8\u81ea\u5df1\u7684WebAssembly\u7f16\u8bd1\u5668", "title_en": "Build your own WebAssembly Compiler", "transed": 1, "url": "https://blog.scottlogic.com/2019/05/17/webassembly-compiler.html", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u7f16\u8bd1"]}, {"category": "", "categoryclass": "", "imagename": "", "infoid": 1000394, "ip": "", "isanchordig": 1, "ischecked": 1, "isdelete": 0, "isneo": 1, "mark": "", "name": "", "note": "\u4ecd\u5728\u52a0\u8f7d\u2026\u3002*\u5982\u679c\u6b64\u95ee\u9898\u4ecd\u7136\u5b58\u5728\uff0c\u8bf7\u91cd\u65b0\u52a0\u8f7d\u6216\u901a\u8fc7quipsupport.com\u8054\u7cfb\u6211\u4eec\u3002", "note_en": "Still loading\u2026 \u00a0 \u00a0Please reload or contact us via  quipsupport.com if this issue persists.", "posttime": "2020-05-03 03:12:22", "tags": "\u9762\u8bd5,sql,hard,\u52a0\u8f7d,contact", "title": "\u4e2d\u786cSQL\u9762\u8bd5\u95ee\u9898", "title_en": "Medium-hard SQL interview questions", "transed": 1, "url": "https://gstudent.quip.com/2gwZArKuWk7W", "via": "", "source_name": "Hacker News", "source_domain": "news.ycombinator.com", "real_tags": ["\u9762\u8bd5", "sql", "hard", "\u52a0\u8f7d", "contact"]}]